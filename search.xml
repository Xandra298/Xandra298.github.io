<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>éŸ³ä¹æ’­æ”¾</title>
    <url>/posts/802d9159/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>
    <div id="aplayer-HqXeyFWY" class="aplayer aplayer-tag-marker meting-tag-marker" data-id="8182851368" data-server="netease" data-type="playlist" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86"></div>
<p>ãƒ¾(â‰§â–½â‰¦*)o</p>
<blockquote>
<p> music  by  @fortunato</p>
</blockquote>
<hr>
<span id="more"></span>
<h4 id="å®ç°è®°å½•"><a href="#å®ç°è®°å½•" class="headerlink" title="å®ç°è®°å½•"></a>å®ç°è®°å½•</h4><ul>
<li><p>æŠ€æœ¯</p>
<p> <a href="https://github.com/MoePlayer/hexo-tag-aplayer">GitHub - MoePlayer/hexo-tag-aplayer: Embed aplayer in Hexo posts/pages</a></p>
</li>
<li><p>æ­¥éª¤ï¼š</p>
<ol>
<li><p>å®‰è£…æ’ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-tag-aplayer</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨_config.ymlä¸­è¨­ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aplayer:</span><br><span class="line">  meting: true</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼štrueä¹‹å‰ç©ºæ ¼</p>
</li>
<li><p>postçš„markdownä¸­æ·»åŠ 
    <div id="aplayer-lMWBFaZe" class="aplayer aplayer-tag-marker meting-tag-marker" data-id="..." data-server="undefined" data-type="undefined" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86"></div></p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- Simple example (id, server, type)  --&gt;</span><br><span class="line">&#123;% meting &quot;60198&quot; &quot;netease&quot; &quot;playlist&quot; %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- Advanced example --&gt;</span><br><span class="line">&#123;% meting &quot;60198&quot; &quot;netease&quot; &quot;playlist&quot; &quot;autoplay&quot; &quot;mutex:false&quot; &quot;listmaxheight:340px&quot; &quot;preload:none&quot; &quot;theme:#ad7a86&quot;%&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<p>â€‹                æ³¨ï¼šneteaseæ˜¯ç½‘æ˜“äº‘</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Option</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td><strong>required</strong></td>
<td>song id / playlist id / album id / search keyword</td>
</tr>
<tr>
<td>server</td>
<td><strong>required</strong></td>
<td>Music platform: <code>netease</code>, <code>tencent</code>, <code>kugou</code>, <code>xiami</code>, <code>baidu</code></td>
</tr>
<tr>
<td>type</td>
<td><strong>required</strong></td>
<td><code>song</code>, <code>playlist</code>, <code>album</code>, <code>search</code>, <code>artist</code></td>
</tr>
</tbody>
</table>
</div>
]]></content>
  </entry>
  <entry>
    <title>Towards Open Vocabulary Learning</title>
    <url>/posts/ec20f0da/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>paper: <strong><a href="https://ieeexplore.ieee.org/document/10420487">Towards Open Vocabulary Learning: A Survey(TPAMI 2024)</a></strong></p>
<p>code: <a href="https://github.com/jianzongwu/Awesome-Open-Vocabulary">https://github.com/jianzongwu/Awesome-Open-Vocabulary</a></p>
<span id="more"></span>
<h2 id="Concept-of-Open-vocabulary"><a href="#Concept-of-Open-vocabulary" class="headerlink" title="Concept of Open vocabulary"></a>Concept of Open vocabulary</h2><hr>
<p><img src="/posts/ec20f0da/image-20240315194250086.png" alt="difference"></p>
<p>æ ·æœ¬åˆ†ä¸ºï¼šbase class $C_B$ å’Œ novel class $C_N$(or out-of-distribution examples)</p>
<p>base classè¿›è¡Œtrainingï¼Œè€Œnovel classæ²¡æœ‰</p>
<p>open-set, open world, and OOD tasks  åœ¨testing é˜¶æ®µï¼Œæ¨¡å‹åªéœ€è¦è¯†åˆ«novel ç±»ï¼Œå¹¶æ ‡è®°ä¸º<em>unknown</em>ï¼Œä¸éœ€è¦è¯†åˆ«ç‰¹å®šçš„ç±»åˆ«ã€‚</p>
<p>zero-shot è¿›ä¸€æ­¥çš„å°†novel classåˆ†ç±»ã€‚å› æ­¤ï¼Œæ›´å…·æŒ‘æˆ˜æ€§ã€‚</p>
<p>ç”±äºå¯¹novelç±»å®é™…è¯†åˆ«æ€§èƒ½è¾ƒä½ï¼Œä¸”image-text pairå®¹æ˜“è·å¾—ï¼Œè¿‘æ¥å·¥ä½œï¼ˆ21,22ï¼‰æå‡ºopen vocabularyï¼Œä»–å…è®¸ä½¿ç”¨æœ‰æ›´å¤§çš„è¯­è¨€è¯æ±‡ï¼ˆlanguage vocabularies $C_L$ï¼‰çš„ é¢å¤–çš„ä½æˆæœ¬è®­ç»ƒæ•°æ®æˆ–è€…é¢„è®­ç»ƒè§†è§‰è¯­è¨€æ¨¡å‹ï¼Œå¦‚clipã€‚</p>
<p>$C_L$å¯èƒ½åŒ…å«$C_B$ å’Œ $C_N$çš„æ¦‚å¿µï¼Œä»¥åœ¨novelç±»ä¸­å…·æœ‰æ³›åŒ–æ€§ã€‚å¹¶ä¸ä¸¥æ ¼è¦æ±‚åŒ…å«ã€‚ä»–å¯èƒ½æœ‰åœ¨é¢„å®šä¹‰çš„novelç±»ä¹‹å¤–çš„è¯æ±‡ï¼Œå› æ­¤è¿›ä¸€æ­¥æ‰©å±•æ³›åŒ–æ€§ã€‚</p>
<ul>
<li>Open-Set / Open World / OODï¼Œè¿™ä¸‰ä¸ªä»»åŠ¡åªéœ€è¦æ¨¡å‹ä»åˆ†ç±»ä¸­è¯†åˆ«å’Œæ‹’ç»æœªçŸ¥å¯¹è±¡ã€‚è¯¥æ¨¡å‹åªéœ€è¦æ‰¾åˆ°æœªçŸ¥çš„ç±»æˆ–å®ä¾‹ï¼Œè€Œä¸éœ€è¦å°†å®ƒä»¬åˆ’åˆ†åˆ°ä¸åŒçš„ç±»ä¸­ã€‚</li>
<li>zero-shot learningã€‚è¯¥æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹CNè¿›è¡Œäº†ä¸¥æ ¼çš„è®­ç»ƒï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­CBç±»ä¸å¯ç”¨ã€‚è¯¥æ¨¡å‹éœ€è¦é¢„æµ‹æ–°å¯¹è±¡çš„å…·ä½“ç±»åˆ«ã€‚</li>
<li>å¼€æ”¾å¼è¯æ±‡å­¦ä¹ ã€‚åŸºäºé›¶æ ·æœ¬å­¦ä¹ è®¾ç½®ï¼Œå¯ä»¥è·å¾—é¢å¤–çš„ä½æˆæœ¬è®­ç»ƒæºæˆ–çŸ¥è¯†CLï¼Œå³å¤§è§„æ¨¡è¯­è¨€è¯æ±‡ã€‚ä¾‹å¦‚ï¼Œimage captionæ˜¯æœ€å¸¸ç”¨çš„è¯­è¨€æ•°æ®ï¼Œå¯ä»¥å¸®åŠ©æ‰©å±•å¼€æ”¾è¯æ±‡æ¨¡å‹çš„è¯­ä¹‰ç©ºé—´ã€‚äººä»¬è¿˜å¯ä»¥ä½¿ç”¨é¢„è®­ç»ƒçš„è§†è§‰è¯­è¨€æ¨¡å‹ï¼Œå°†å…¶ç”¨äºæ–°é¢–çš„ç±»åˆ«åˆ†ç±»ã€‚</li>
</ul>
<blockquote>
<p><strong>Open Vocabulary Learning</strong> Based on the zero-shot learning setting, one can acquire an additional low-cost training source or knowledge CL, large-scale language vocabulary. For example, image captions are the most commonly used language data to help extend the semantic space of an open vocabulary model. One can also use the pre-trained vision language models by adapting them for novel class classification.</p>
<p>$C_L$ may contain the concepts of both$C_B$ and$C_N$, which enables model to generalize across novel classes. Note that$C_L$  is not strictly required to contain $C_B$ or$C_N$ , as the language vocabulary may not cover all the class names in the vision data. On the contrary, $C_L$may also have words out of the pre-defined novel categories, which can further extend modelsâ€™ generalizability.</p>
</blockquote>
<ul>
<li><p>close-set</p>
<p>èƒ½è¯†åˆ«è®­ç»ƒé›†ä¸­å­˜åœ¨çš„é¢„å®šä¹‰ç±»åˆ«</p>
</li>
<li><p>zero-shot learning</p>
<p>ä½¿å…¶ä»å·²æ³¨é‡Š(å·²è§)çš„å¯¹è±¡ç±»æ³›åŒ–åˆ°å…¶ä»–(æœªè§)çš„ç±»åˆ«ã€‚</p>
<p>â€œMost approaches adopt word embedding projection to constitute the classifier for unseen class classificationâ€ (Wu ç­‰, 2023, p. 1) (pdf) ğŸ”¤å¤§å¤šæ•°æ–¹æ³•é‡‡ç”¨è¯åµŒå…¥æŠ•å½±æ¥æ„æˆåˆ†ç±»å™¨ï¼Œç”¨äºæœªçŸ¥ç±»åˆ«çš„åˆ†ç±»ğŸ”¤</p>
<p>â€œAs a result, during inference, the model identifies novel classes solely based on their pre-defined word embeddings [9], [10], [11], thereby limiting exploration of the visual information and relationships of those unseen classes.â€ (Wu ç­‰, 2023, p. 1) (pdf) ğŸ”¤å› æ­¤ï¼Œåœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œè¯¥æ¨¡å‹ä»…æ ¹æ®é¢„å…ˆå®šä¹‰çš„è¯åµŒå…¥æ¥è¯†åˆ«æ–°çš„ç±»ï¼Œä»è€Œé™åˆ¶äº†å¯¹é‚£äº›æœªè§çš„ç±»çš„è§†è§‰ä¿¡æ¯å’Œå…³ç³»çš„æ¢ç´¢ã€‚ğŸ”¤ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆZSLæ–¹æ³•å·²ç»è¢«è¯æ˜åœ¨æ–°çš„ç±»ä¸­äº§ç”Ÿä¸ä»¤äººæ»¡æ„çš„ç»“æœã€‚</p>
</li>
<li><p>open vocabulary</p>
<p>â€œthe model trains on base classes and inferences on both base and novel classesâ€ (Wu ç­‰, 2023, p. 1) (pdf) ğŸ”¤æ¨¡å‹åœ¨baseç±»ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨åŸºç±»å’Œæ–°ç±»ä¸Šè¿›è¡Œæ¨ç†ğŸ”¤</p>
</li>
<li><p>zero-shot vs open vocabulary</p>
<p>é›¶æ ·æœ¬å­¦ä¹ ä¸å¼€æ”¾è¯æ±‡çš„å…³é”®åŒºåˆ«åœ¨äºå¯ä»¥ä½¿ç”¨ä¸è§†è§‰ç›¸å…³çš„è¯­è¨€è¯æ±‡æ•°æ®ï¼Œå¦‚å›¾åƒæ ‡é¢˜ä½œä¸ºè¾…åŠ©ç›‘ç£ã€‚</p>
</li>
<li><p>ä½¿ç”¨è¯­è¨€æ•°æ®ä½œä¸ºè¾…åŠ©ç›‘ç£çš„åŠ¨æœºæ˜¯</p>
<ul>
<li>è¯­è¨€æ•°æ®ï¼ˆæ–‡æœ¬ï¼‰æ ‡æ³¨æˆæœ¬æ›´ä½</li>
<li>è¯­è¨€æ•°æ®æä¾›äº†æ›´å¹¿æ³›çš„è¯æ±‡é‡ï¼Œå› æ­¤æ›´å…·æœ‰æ‰©å±•æ€§å’Œæ³›åŒ–æ€§</li>
</ul>
</li>
<li><p>open vocabulary methods å¤§å¤šé€šè¿‡åˆ©ç”¨VLMsï¼ˆvisual language modelsï¼‰å­¦ä¹ åˆ°çš„å¯¹é½ï¼Œæ¶ˆé™¤close-setå’Œopen-setåœºæ™¯è¾¹ç•Œã€‚</p>
</li>
<li><p>timeline</p>
<p><img src="/posts/ec20f0da/image-20240315194630309.png" alt="timeline"></p>
</li>
</ul>
<h2 id="Open-Vocabulary-Video-Understanding"><a href="#Open-Vocabulary-Video-Understanding" class="headerlink" title="Open Vocabulary Video Understanding"></a>Open Vocabulary Video Understanding</h2><hr>
<h3 id="åŠ¨ä½œè¯†åˆ«ä»»åŠ¡"><a href="#åŠ¨ä½œè¯†åˆ«ä»»åŠ¡" class="headerlink" title="åŠ¨ä½œè¯†åˆ«ä»»åŠ¡"></a><strong>åŠ¨ä½œè¯†åˆ«ä»»åŠ¡</strong></h3><p><img src="/posts/ec20f0da/Untitled 2.png" style="zoom:80%;"></p>
<p><img src="/posts/ec20f0da/Untitled 3.png" style="zoom:80%;"></p>
<p>kinetics 400 è®­ç»ƒï¼Œå…¶ä»–æµ‹è¯•</p>
<p><img src="/posts/ec20f0da/Untitled 4.png" alt></p>
<ul>
<li><p><a href="https://arxiv.org/abs/2109.08472">ActionCLIP: A New Paradigm for Video Action Recognition</a> 2021 arxiv</p>
<p>ä½¿ç”¨åŸºäºå›¾åƒçš„è§†è§‰-è¯­è¨€é¢„è®­ç»ƒçš„çŸ¥è¯†ã€‚å®ƒä¸ºè§†é¢‘è¡Œä¸ºè¯†åˆ«ä¸­çš„é›¶æ ·æœ¬èƒ½åŠ›å¢åŠ äº†ä¸€ä¸ªæ—¶é—´èåˆå±‚ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2112.04478">Prompting Visual-Language Models for Efficient Video Understanding</a> ï¼ˆECCV 2022)</p>
<p>é€šè¿‡åœ¨ä¸€ä¸ªå†»ç»“çš„CLIPå›¾åƒç¼–ç å™¨é¡¶éƒ¨è®­ç»ƒtransformerå±‚ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ç±»ä¼¼çš„èŒƒå¼ï¼Œå¹¶ä¸”å…·æœ‰å¾ˆå¼ºçš„é›¶æ ·æœ¬èƒ½åŠ›ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2208.03550">Frozen CLIP Models are Efficient Video Learners</a> ï¼ˆECCV2022ï¼‰</p>
<p>ä½¿ç”¨å†»ç»“çš„CLIPè¿›è¡Œæœ‰æ•ˆçš„è§†é¢‘è¡Œä¸ºè¯†åˆ«</p>
</li>
<li><p>XCLIP:  <a href="https://arxiv.org/abs/2208.02816">**Expanding Language-Image Pretrained Models for General Video Recognition</a> (ECCV 2022)**</p>
<p>ä½¿ç”¨è§†é¢‘ç¼–ç å™¨ï¼Œåˆ©ç”¨ç¼–ç å™¨ä¸­çš„æ—¶é—´ä¿¡æ¯è¿›è¡Œè§†é¢‘è¯†åˆ«ã€‚å®ƒå°†æ¥è‡ªè§†é¢‘ç¼–ç å™¨çš„ç‰¹å¾ä¸åœ¨åŸºäºå›¾åƒçš„è§†è§‰è¯­è¨€å¯¹(ä¾‹å¦‚, CLIP)ä¸Šé¢„è®­ç»ƒçš„æ–‡æœ¬ç¼–ç å™¨è¿›è¡Œå¯¹é½ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2207.01297">Revisiting Classifier: Transferring Vision-Language Models for Video Recognition</a> (AAAI 2023)</p>
<p>å…³æ³¨äºåˆ†ç±»å™¨ï¼Œæå‡ºä½¿ç”¨CLIPæ–‡æœ¬ç¼–ç å™¨ä½œä¸ºè¯­ä¹‰ç›®æ ‡è¿›è¡Œè§†é¢‘åˆ†ç±»ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2302.00624">**Open-VCLIP: Transforming CLIP to an Open-vocabulary Video Model via Interpolated Weight Optimization</a> (ICML 2023)**</p>
<p>Open VCLIP å°†CLIPåˆ°è§†é¢‘çš„çŸ¥è¯†è½¬ç§»å»ºæ¨¡ä¸ºä¸€ä¸ªè¿ç»­å­¦ä¹ é—®é¢˜ï¼Œå¹¶æå‡ºæ’å€¼æƒé‡ä¼˜åŒ–æ¥è§£å†³è¯¥é—®é¢˜ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2302.03024">AIM: Adapting Image Models for Efficient Video Action Recognition</a> (ICLR 2023)</p>
<p>AIM tackles the open vocabulary video classification problem by adding adapt layers on top of the CLIP image encoder.</p>
</li>
<li><p>ViFi-CLIP <a href="https://arxiv.org/abs/2212.03640">**Fine-tuned CLIP Models are Efficient Video Learners</a>** (CVPR 2023)</p>
<p>ViFi-CLIP æ­ç¤ºäº†ä¸€ä¸ªç®€å•çš„å¾®è°ƒbaseline(åŸºäºCLIPè§†è§‰ç¼–ç å™¨å’Œæ—¶åŸŸæ± åŒ–çš„å›¾åƒçº§ç‰¹å¾æå–)è€Œä¸æ˜¯æ”¹è¿›çš„èåˆå±‚ å¯ä»¥æœ‰å¾ˆå¼ºçš„æ€§èƒ½ï¼Œå¹¶è¿›ä¸€æ­¥ç ”ç©¶äº†prompt tuningçš„å½±å“ã€‚</p>
</li>
</ul>
<p>æœ€è¿‘å¼€æ”¾è¯æ±‡è§†é¢‘åˆ†ç±»çš„è¿›å±•å°†æ³¨æ„åŠ›è½¬å‘äº†VLMå»ºæ¨¡ä¸­çš„è¯­è¨€éƒ¨åˆ†</p>
<ul>
<li><p><a href="https://arxiv.org/abs/2304.02560">VicTR: Video-conditioned Text Representations for Activity Recognition</a> (arxiv 2023)</p>
<p>VicTRå¼•å…¥äº†è§†é¢‘æ¡ä»¶æ–‡æœ¬è¡¨ç¤ºæ¥è”åˆä¼˜åŒ–è§†è§‰å’Œæ–‡æœ¬ä¿¡æ¯ã€‚</p>
</li>
<li><p><a href="https://arxiv.org/abs/2303.08914">MAtch, eXpand and Improve: Unsupervised Finetuning for Zero-Shot Action Recognition with Language Knowledge</a> (arxiv 2023) MAXIåˆ©ç”¨LLMsé€šè¿‡æ–‡æœ¬æ‰©å±•ä¸ºè§†é¢‘æ„å»ºä¸€ä¸ªæ— æ ‡æ³¨çš„æ–‡æœ¬åŒ…ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>è®ºæ–‡é˜…è¯»</category>
      </categories>
      <tags>
        <tag>è§†é¢‘ç†è§£</tag>
        <tag>Open vocabulary</tag>
      </tags>
  </entry>
  <entry>
    <title>Survey</title>
    <url>/posts/aaf39eca/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
  </entry>
  <entry>
    <title>latexå›¾è¡¨å…¬å¼æ±‡æ€»</title>
    <url>/posts/b33a9282/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h2><h3 id="æ ‡å‡†ä¸‰çº¿è¡¨"><a href="#æ ‡å‡†ä¸‰çº¿è¡¨" class="headerlink" title="æ ‡å‡†ä¸‰çº¿è¡¨"></a>æ ‡å‡†ä¸‰çº¿è¡¨</h3><span id="more"></span>
<p><code>\caption</code> ä¸ºæ ‡é¢˜ï¼›</p>
<p><code>\label</code>ä¸ºæ ‡ç­¾ï¼Œç”¨äºå¼•ç”¨</p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[!htbp]</span><br><span class="line">   <span class="keyword">\caption</span>&#123;æ ‡å‡†ä¸‰çº¿è¡¨æ ¼&#125;<span class="keyword">\label</span>&#123;tab:001&#125; <span class="keyword">\centering</span></span><br><span class="line">   <span class="keyword">\begin</span>&#123;tabular&#125;&#123;ccccc&#125;</span><br><span class="line">       <span class="keyword">\toprule</span><span class="comment">%[1.5pt]</span></span><br><span class="line">       <span class="built_in">$</span>D<span class="built_in">$</span>(in) <span class="built_in">&amp;</span> <span class="built_in">$</span>P<span class="built_in">_</span>u<span class="built_in">$</span>(lbs) <span class="built_in">&amp;</span> <span class="built_in">$</span>u<span class="built_in">_</span>u<span class="built_in">$</span>(in) <span class="built_in">&amp;</span> <span class="built_in">$</span><span class="keyword">\beta</span><span class="built_in">$</span> <span class="built_in">&amp;</span> <span class="built_in">$</span>G<span class="built_in">_</span>f<span class="built_in">$</span>(psi.in)<span class="keyword">\\</span></span><br><span class="line">       <span class="keyword">\midrule</span><span class="comment">%[1pt]</span></span><br><span class="line">       5 <span class="built_in">&amp;</span> 269.8 <span class="built_in">&amp;</span> 0.000674 <span class="built_in">&amp;</span> 1.79 <span class="built_in">&amp;</span> 0.04089<span class="keyword">\\</span></span><br><span class="line">       10 <span class="built_in">&amp;</span> 421.0 <span class="built_in">&amp;</span> 0.001035 <span class="built_in">&amp;</span> 3.59 <span class="built_in">&amp;</span> 0.04089<span class="keyword">\\</span></span><br><span class="line">       20 <span class="built_in">&amp;</span> 640.2 <span class="built_in">&amp;</span> 0.001565 <span class="built_in">&amp;</span> 7.18 <span class="built_in">&amp;</span> 0.04089<span class="keyword">\\</span></span><br><span class="line">       <span class="keyword">\bottomrule</span><span class="comment">%[1.5pt]</span></span><br><span class="line">   <span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è¡¨æ ¼çš„å¼•ç”¨"><a href="#è¡¨æ ¼çš„å¼•ç”¨" class="headerlink" title="è¡¨æ ¼çš„å¼•ç”¨"></a>è¡¨æ ¼çš„å¼•ç”¨</h3><p>å¼•ç”¨å‰é¢é‚£ä¸ªè¡¨ã€‚</p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">ä¸‰çº¿è¡¨å¦‚è¡¨<span class="keyword">\cref</span>&#123;tab:001&#125;æ‰€ç¤ºã€‚</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š</p>
<p>ä¸‰çº¿è¡¨å¦‚è¡¨5.1æ‰€ç¤ºã€‚</p>
<p>æ¶‰åŠå®åŒ…ï¼š<code>hyperref</code>ã€<code>cleveref</code></p>
<h3 id="æ™®é€šè¡¨"><a href="#æ™®é€šè¡¨" class="headerlink" title="æ™®é€šè¡¨"></a>æ™®é€šè¡¨</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[htbp]</span><br><span class="line">	<span class="keyword">\centering</span>  <span class="comment">% æ˜¾ç¤ºä½ç½®ä¸ºä¸­é—´</span></span><br><span class="line">	<span class="keyword">\caption</span>&#123;ä¸‰ç±»ææ–™ç”Ÿäº§æˆæœ¬å¯¹æ¯”&#125;  <span class="comment">% è¡¨æ ¼æ ‡é¢˜</span></span><br><span class="line">	<span class="keyword">\label</span>&#123;table:table1&#125;  <span class="comment">% ç”¨äºç´¢å¼•è¡¨æ ¼çš„æ ‡ç­¾</span></span><br><span class="line">	<span class="comment">%å­—æ¯çš„ä¸ªæ•°å¯¹åº”åˆ—æ•°ï¼Œ|ä»£è¡¨åˆ†å‰²çº¿</span></span><br><span class="line">	<span class="comment">% lä»£è¡¨å·¦å¯¹é½ï¼Œcä»£è¡¨å±…ä¸­ï¼Œrä»£è¡¨å³å¯¹é½</span></span><br><span class="line">	<span class="keyword">\begin</span>&#123;tabular&#125;&#123;|c|c|c|c|&#125;  </span><br><span class="line">		<span class="keyword">\hline</span>  <span class="comment">% è¡¨æ ¼çš„æ¨ªçº¿</span></span><br><span class="line">		<span class="comment">%å¯ä»¥é¿å…æ–‡å­—åä¸Šæ¥è°ƒæ•´æ–‡å­—ä¸ä¸Šè¾¹ç•Œçš„è·ç¦»</span></span><br><span class="line">		 <span class="built_in">&amp;</span>A<span class="built_in">&amp;</span>B<span class="built_in">&amp;</span>C <span class="keyword">\\</span>  <span class="comment">% è¡¨æ ¼ä¸­çš„å†…å®¹ï¼Œç”¨&amp;åˆ†å¼€ï¼Œ\\è¡¨ç¤ºä¸‹ä¸€è¡Œ</span></span><br><span class="line">		<span class="keyword">\hline</span></span><br><span class="line">		 <span class="comment">%å¯ä»¥é¿å…æ–‡å­—åä¸Š </span></span><br><span class="line">		å•ä»·<span class="built_in">&amp;</span>1.2<span class="built_in">&amp;</span>1.1<span class="built_in">&amp;</span>1 <span class="keyword">\\</span></span><br><span class="line">		<span class="keyword">\hline</span></span><br><span class="line">		ç”Ÿäº§æ‰€éœ€<span class="built_in">&amp;</span>0.6<span class="built_in">&amp;</span>0.66<span class="built_in">&amp;</span>0.72 <span class="keyword">\\</span></span><br><span class="line">		<span class="keyword">\hline</span></span><br><span class="line">		ç”Ÿäº§æˆæœ¬<span class="built_in">&amp;</span>0.72<span class="built_in">&amp;</span>0.726<span class="built_in">&amp;</span>0.72 <span class="keyword">\\</span></span><br><span class="line">		<span class="keyword">\hline</span></span><br><span class="line">	<span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åˆå¹¶è¡Œåˆ—"><a href="#åˆå¹¶è¡Œåˆ—" class="headerlink" title="åˆå¹¶è¡Œåˆ—"></a>åˆå¹¶è¡Œåˆ—</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[!htp]</span><br><span class="line"><span class="keyword">\renewcommand</span><span class="keyword">\arraystretch</span>&#123;1.0&#125; <span class="comment">%å®šä¹‰è¡¨æ ¼é«˜åº¦</span></span><br><span class="line"><span class="keyword">\newcolumntype</span>&#123;L&#125;&#123;X&#125;</span><br><span class="line"><span class="keyword">\newcolumntype</span>&#123;C&#125;&#123;&gt;&#123;<span class="keyword">\centering</span> <span class="keyword">\arraybackslash</span>&#125;X&#125;</span><br><span class="line"><span class="keyword">\newcolumntype</span>&#123;R&#125;&#123;&gt;&#123;<span class="keyword">\raggedright</span> <span class="keyword">\arraybackslash</span>&#125;X&#125;</span><br><span class="line"><span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\caption</span>&#123;æŸæ ¡å­¦ç”Ÿå‡é«˜ä½“é‡æ ·æœ¬&#125;</span><br><span class="line"><span class="keyword">\label</span>&#123;tab2:heightweight&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabularx&#125;&#123;0.9<span class="keyword">\textwidth</span>&#125;&#123;|C|C|C|C|&#125;</span><br><span class="line">   <span class="keyword">\Xhline</span>&#123;2<span class="keyword">\arrayrulewidth</span>&#125;</span><br><span class="line">	<span class="keyword">\multicolumn</span>&#123;2&#125;&#123;|c|&#125;&#123;Numbers&#125;  <span class="built_in">&amp;</span>èº«é«˜<span class="built_in">&amp;</span>ä½“é‡<span class="keyword">\\</span></span><br><span class="line">	<span class="keyword">\Xhline</span>&#123;2<span class="keyword">\arrayrulewidth</span>&#125;</span><br><span class="line">	<span class="keyword">\multirow</span>&#123;2&#125;&#123;*&#125;&#123;Item&#125; <span class="built_in">&amp;</span>14<span class="built_in">&amp;</span>156<span class="built_in">&amp;</span>42<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\cline</span>&#123;2-4&#125;</span><br><span class="line">	  <span class="built_in">&amp;</span>16<span class="built_in">&amp;</span>158<span class="built_in">&amp;</span>45<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\hline</span></span><br><span class="line">	3<span class="built_in">&amp;</span>14<span class="built_in">&amp;</span>162<span class="built_in">&amp;</span>48<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\hline</span></span><br><span class="line">	4<span class="built_in">&amp;</span>15<span class="built_in">&amp;</span>163<span class="built_in">&amp;</span>50<span class="keyword">\\</span></span><br><span class="line">    <span class="comment">%\cmidrule&#123;2-4&#125;</span></span><br><span class="line">	å¹³å‡<span class="built_in">&amp;</span>15<span class="built_in">&amp;</span>159.75<span class="built_in">&amp;</span>46.25<span class="keyword">\\</span></span><br><span class="line">	<span class="keyword">\Xhline</span>&#123;2<span class="keyword">\arrayrulewidth</span>&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;tabularx&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æµ®åŠ¨"><a href="#æµ®åŠ¨" class="headerlink" title="æµ®åŠ¨"></a>æµ®åŠ¨</h3><p>hï¼šhereï¼Œè¡¨ç¤ºæ”¾ç½®åœ¨å½“å‰ä½ç½®<br>tï¼štopï¼Œè¡¨ç¤ºæ”¾ç½®åœ¨æŸé¡µé¡¶éƒ¨<br>bï¼šbottomï¼Œè¡¨ç¤ºæ”¾ç½®åœ¨æŸé¡µåº•éƒ¨<br>pï¼špageï¼Œè¡¨ç¤ºç‹¬å ä¸€é¡µ</p>
<p>[!h] ä¸­çš„ h æ˜¯ here çš„æ„æ€ï¼Œ! è¡¨ç¤ºå¿½ç•¥ä¸€äº›æµ®åŠ¨ä½“çš„ä¸¥æ ¼è§„åˆ™ã€‚å¦å¤–é‡Œé¢è¿˜å¯ä»¥åŠ ä¸Š btp é€‰é¡¹ï¼Œåªè¦è¿™å‡ ä¸ªå‚æ•°åœ¨èŠ±æ‹¬å·é‡Œé¢ï¼Œä½œç”¨æ˜¯ä¸åˆ†å…ˆåé¡ºåºã€‚å¼ºåˆ¶åœ¨å½“å‰ä½ç½®æœ‰æ—¶!hæˆ–è€…hå¹¶ä¸æ˜¯å¾ˆæœ‰æ•ˆï¼Œå¯ä»¥ç»„åˆä½¿ç”¨</p>
<h2 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h2><h3 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[htp!]</span><br><span class="line"><span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\includegraphics</span>[width=.55<span class="keyword">\textwidth</span>]&#123;figures/fig.png&#125;  <span class="comment">%[å¤§å°][å›¾ç‰‡è·¯å¾„]</span></span><br><span class="line"><span class="keyword">\caption</span>&#123;ç®—æ³•æµç¨‹å›¾&#125;</span><br><span class="line"> <span class="keyword">\label</span>&#123;fig:circuit-diagram&#125; <span class="comment">%å¼•ç”¨æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¤šå›¾å¹¶æ’"><a href="#å¤šå›¾å¹¶æ’" class="headerlink" title="å¤šå›¾å¹¶æ’"></a>å¤šå›¾å¹¶æ’</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">\begin</span>&#123;figure&#125;[htp!]</span><br><span class="line">    <span class="keyword">\begin</span>&#123;minipage&#125;[t]&#123;0.48<span class="keyword">\linewidth</span>&#125;</span><br><span class="line">    <span class="keyword">\centering</span></span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=0.9<span class="keyword">\textwidth</span>]&#123;figures/fig.png&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;fig1&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;fig:a&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;minipage&#125;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;minipage&#125;[t]&#123;0.48<span class="keyword">\linewidth</span>&#125;</span><br><span class="line">    <span class="keyword">\centering</span></span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=0.9<span class="keyword">\textwidth</span>]&#123;figures/fig.png&#125;  <span class="comment">% 2.2in</span></span><br><span class="line">    <span class="keyword">\caption</span>&#123;fig2&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;fig:b&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;minipage&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å­å›¾å¼•ç”¨"><a href="#å­å›¾å¼•ç”¨" class="headerlink" title="å­å›¾å¼•ç”¨"></a>å­å›¾å¼•ç”¨</h4><p>è¿™ç›¸å½“äºæ•´ä½“æ˜¯ä¸€å¼ å¤§å›¾ç‰‡ï¼Œå¤§å›¾ç‰‡å¼•ç”¨æ˜¯<code>\cref&#123;fig:sample-figure&#125;</code>ï¼Œå­å›¾å¼•ç”¨åˆ«åˆ†æ˜¯<code>\cref&#123;fig:sample-figure-a&#125;</code>ã€<code>\cref&#123;fig:sample-figure-b&#125;</code>ã€<code>\cref&#123;fig:sample-figure-c&#125;</code>ã€‚</p>
<h4 id="å­å›¾ç­‰é«˜"><a href="#å­å›¾ç­‰é«˜" class="headerlink" title="å­å›¾ç­‰é«˜"></a>å­å›¾ç­‰é«˜</h4><p>å¦‚æœåŸæœ¬ä¸¤å¼ å›¾ç‰‡çš„é«˜åº¦ä¸åŒï¼Œä½†æ˜¯å¸Œæœ›å®ƒä»¬ç¼©æ”¾å<strong>ç­‰é«˜</strong>çš„æ’åœ¨åŒä¸€è¡Œï¼Œå‚è€ƒè¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[!h]</span><br><span class="line">    <span class="keyword">\centering</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;minipage&#125;[c]&#123;0.48<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">        <span class="keyword">\centering</span></span><br><span class="line">        <span class="keyword">\includegraphics</span>[height=0.2<span class="keyword">\textheight</span>]&#123;cat&#125;</span><br><span class="line">        <span class="keyword">\subcaption</span>&#123;ä¸€åªçŒ«&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;minipage&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;minipage&#125;[c]&#123;0.48<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">        <span class="keyword">\centering</span></span><br><span class="line">        <span class="keyword">\includegraphics</span>[height=0.2<span class="keyword">\textheight</span>]&#123;smokeblk&#125; <span class="comment">%é«˜åº¦</span></span><br><span class="line">        <span class="keyword">\subcaption</span>&#123;ç”µè·¯å›¾&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;minipage&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;å¤šå›¾å¹¶æ’ç¤ºä¾‹&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¤šå­å›¾å¹¶æ’2"><a href="#å¤šå­å›¾å¹¶æ’2" class="headerlink" title="å¤šå­å›¾å¹¶æ’2"></a>å¤šå­å›¾å¹¶æ’2</h4><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[!htp]</span><br><span class="line">	<span class="keyword">\centering</span></span><br><span class="line">	<span class="keyword">\subfloat</span>[å·¦1]&#123;<span class="keyword">\includegraphics</span>[width=0.4<span class="keyword">\textwidth</span>]&#123;figures/img1.png&#125;&#125;<span class="keyword">\qquad</span></span><br><span class="line">	<span class="keyword">\subfloat</span>[å³1]&#123;<span class="keyword">\includegraphics</span>[width=0.4<span class="keyword">\textwidth</span>]&#123;figures/img2.png&#125;&#125; <span class="keyword">\\</span></span><br><span class="line">	<span class="keyword">\subfloat</span>[ä¸‹1]&#123;<span class="keyword">\includegraphics</span>[width=0.4<span class="keyword">\textwidth</span>]&#123;figures/img2.png&#125;&#125;<span class="keyword">\qquad</span></span><br><span class="line">	<span class="keyword">\subfloat</span>[ä¸‹2]&#123;<span class="keyword">\includegraphics</span>[width=0.4<span class="keyword">\textwidth</span>]&#123;figures/img1.png&#125;&#125;</span><br><span class="line">	<span class="keyword">\caption</span>&#123;å¤šå›¾ç¤ºä¾‹&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å…¬å¼"><a href="#å…¬å¼" class="headerlink" title="å…¬å¼"></a>å…¬å¼</h2><h3 id="è¡Œå†…å…¬å¼"><a href="#è¡Œå†…å…¬å¼" class="headerlink" title="è¡Œå†…å…¬å¼"></a>è¡Œå†…å…¬å¼</h3><p>è¡Œå†…å…¬å¼ä½¿ç”¨ <script type="math/tex"> </script>åŒ…è£¹ã€‚</p>
<p>è¡Œé—´å…¬å¼ä¸éœ€è¦ç¼–å·çš„å¯ä»¥ä½¿ç”¨ <code>\[ \]</code> åŒ…è£¹</p>
<h3 id="å¸¦ç¼–å·çš„å…¬å¼"><a href="#å¸¦ç¼–å·çš„å…¬å¼" class="headerlink" title="å¸¦ç¼–å·çš„å…¬å¼"></a>å¸¦ç¼–å·çš„å…¬å¼</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation&#125;</span><br><span class="line">E=mc<span class="built_in">^</span>2</span><br><span class="line"><span class="keyword">\label</span>&#123;eq:energy&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¸¸è§"><a href="#å¸¸è§" class="headerlink" title="å¸¸è§"></a>å¸¸è§</h3><h4 id="ç‰¹å®šä½ç½®å¯¹é½"><a href="#ç‰¹å®šä½ç½®å¯¹é½" class="headerlink" title="ç‰¹å®šä½ç½®å¯¹é½"></a>ç‰¹å®šä½ç½®å¯¹é½</h4><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align&#125;</span><br><span class="line">P <span class="built_in">&amp;</span> = UI <span class="keyword">\\</span></span><br><span class="line"><span class="built_in">&amp;</span> = I<span class="built_in">^</span>2R</span><br><span class="line"><span class="keyword">\end</span>&#123;align&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125; <span class="comment">%è¿™æ ·å°±ä¸æ˜¾ç¤ºä¸”ä¸å‚ä¸ç¼–å·</span></span><br><span class="line">    P <span class="built_in">&amp;</span> = UI <span class="keyword">\\</span></span><br><span class="line">    <span class="built_in">&amp;</span> = I<span class="built_in">^</span>2R</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ†æ®µå‡½æ•°"><a href="#åˆ†æ®µå‡½æ•°" class="headerlink" title="åˆ†æ®µå‡½æ•°"></a>åˆ†æ®µå‡½æ•°</h4><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\[</span></span><br><span class="line">f(x) =</span><br><span class="line">    <span class="keyword">\begin</span>&#123;cases&#125;</span><br><span class="line">        0 <span class="built_in">&amp;</span>  x <span class="keyword">\text</span>&#123;ä¸ºæ— ç†æ•°&#125; ,<span class="keyword">\\</span></span><br><span class="line">        1 <span class="built_in">&amp;</span>  x <span class="keyword">\text</span>&#123;ä¸ºæœ‰ç†æ•°&#125; .</span><br><span class="line">    <span class="keyword">\end</span>&#123;cases&#125;</span><br><span class="line"><span class="keyword">\]</span></span><br></pre></td></tr></table></figure>
<h4 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h4><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\[</span></span><br><span class="line"><span class="keyword">\mathbf</span>&#123;X&#125; = <span class="keyword">\left</span>(</span><br><span class="line">    <span class="keyword">\begin</span>&#123;array&#125;&#123;cccc&#125;</span><br><span class="line">    x<span class="built_in">_</span>&#123;11&#125; <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;12&#125; <span class="built_in">&amp;</span> <span class="keyword">\ldots</span> <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;1n&#125;<span class="keyword">\\</span></span><br><span class="line">    x<span class="built_in">_</span>&#123;21&#125; <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;22&#125; <span class="built_in">&amp;</span> <span class="keyword">\ldots</span> <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;2n&#125;<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\vdots</span> <span class="built_in">&amp;</span> <span class="keyword">\vdots</span> <span class="built_in">&amp;</span> <span class="keyword">\ddots</span> <span class="built_in">&amp;</span> <span class="keyword">\vdots</span><span class="keyword">\\</span></span><br><span class="line">    x<span class="built_in">_</span>&#123;n1&#125; <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;n2&#125; <span class="built_in">&amp;</span> <span class="keyword">\ldots</span> <span class="built_in">&amp;</span> x<span class="built_in">_</span>&#123;nn&#125;<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;array&#125; <span class="keyword">\right</span>)</span><br><span class="line"><span class="keyword">\]</span></span><br></pre></td></tr></table></figure>
<h3 id="å…¬å¼å¼•ç”¨"><a href="#å…¬å¼å¼•ç”¨" class="headerlink" title="å…¬å¼å¼•ç”¨"></a>å…¬å¼å¼•ç”¨</h3><ol>
<li><p>è®¾ç½®label</p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation&#125;</span><br><span class="line">E=mc<span class="built_in">^</span>2</span><br><span class="line"><span class="keyword">\label</span>&#123;eq:energy&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>\cref&#123;eq:energy&#125;</code>    </p>
</li>
</ol>
<h3 id="å…¬å¼åœ¨çº¿è¯†åˆ«"><a href="#å…¬å¼åœ¨çº¿è¯†åˆ«" class="headerlink" title="å…¬å¼åœ¨çº¿è¯†åˆ«"></a>å…¬å¼åœ¨çº¿è¯†åˆ«</h3><p><a href="https://www.simpletex.cn/ai/latex_ocr">å…¬å¼è¯†åˆ« (simpletex.cn)</a></p>
]]></content>
      <categories>
        <category>latex</category>
      </categories>
      <tags>
        <tag>æ•°æ¨¡</tag>
      </tags>
  </entry>
  <entry>
    <title>å†™ä½œæ¨¡æ¿</title>
    <url>/posts/4c8b4541/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h3><h4 id="è®ºæ–‡æ ‡é¢˜"><a href="#è®ºæ–‡æ ‡é¢˜" class="headerlink" title="è®ºæ–‡æ ‡é¢˜"></a><strong>è®ºæ–‡æ ‡é¢˜</strong></h4><span id="more"></span>
<ul>
<li>åŸºäºæ‰€ä½¿ç”¨çš„ä¸»è¦æ¨¡å‹æˆ–æ–¹æ³•ä½œä¸ºæ ‡é¢˜</li>
</ul>
<h4 id="æ‘˜è¦-ï¼š"><a href="#æ‘˜è¦-ï¼š" class="headerlink" title="æ‘˜è¦ ï¼š"></a><strong>æ‘˜è¦ </strong>ï¼š</h4><ul>
<li>å¯ä»¥æœ€åæ¥å†™ 1000å­—å·¦å³</li>
<li><strong>æ ¼å¼</strong><ul>
<li><img src="/posts/4c8b4541/image-20210904124259870.png" alt></li>
</ul>
</li>
<li><strong>å¼€å¤´æ®µï¼ˆå¿…è¦ï¼‰</strong><ul>
<li>ç®€å•äº¤ä»£ä¸€ä¸‹èƒŒæ™¯å®é™…æ„ä¹‰ï¼ˆå¯é€‰ï¼‰</li>
<li>äº¤ä»£ä¸€ä¸‹æ‰€åšçš„äº‹æƒ…</li>
</ul>
</li>
<li>ä¸­é—´æ®µï¼šåˆ†åˆ«é’ˆå¯¹ä¸‰ä¸ªé—®é¢˜<ul>
<li>è§£å†³äº†ä»€ä¹ˆé—®é¢˜ </li>
<li>åº”ç”¨äº†ä»€ä¹ˆæ–¹æ³• ï¼šå¯¹åº”è¿™ä¸ªé—®é¢˜çš„æ±‚è§£æ€è·¯ï¼Œè¯´æ˜åº”ç”¨çš„æ¨¡å‹</li>
<li>å¾—åˆ°äº†ä»€ä¹ˆç»“æœï¼šå¿…è¦æ•°å€¼å¯ä»¥å‘ˆç°</li>
</ul>
</li>
<li>ç»“å°¾æ®µï¼ˆå¯é€‰ï¼‰<ul>
<li>æ€»ç»“ å¯¹ç±»ä¼¼é—®é¢˜åšé€‚å½“çš„æ¨å¹¿</li>
</ul>
</li>
<li>åºŸè¯<ul>
<li><img src="/posts/4c8b4541/image-20210904124756585.png" alt></li>
</ul>
</li>
</ul>
<h4 id="å…³é”®è¯"><a href="#å…³é”®è¯" class="headerlink" title="å…³é”®è¯"></a><strong>å…³é”®è¯</strong></h4><ul>
<li>4-6</li>
<li>ä¸»è¦æ¨¡å‹  å‡ºç°æ¬¡æ•°å¤šçš„ä½“ç°ä¸»è¦å†…å®¹ï¼ˆ1-2ä¸ªï¼‰</li>
</ul>
<h4 id="ä¸€ã€é—®é¢˜é‡è¿°"><a href="#ä¸€ã€é—®é¢˜é‡è¿°" class="headerlink" title="ä¸€ã€é—®é¢˜é‡è¿°"></a><strong>ä¸€ã€é—®é¢˜é‡è¿°</strong></h4><ul>
<li>æ ¼å¼<ul>
<li><strong>1.1é—®é¢˜èƒŒæ™¯</strong></li>
<li><strong>1.2é—®é¢˜æå‡º</strong></li>
</ul>
</li>
<li>æ–¹å¼ï¼š<ul>
<li>1.åœ¨åŸé¢˜ä¸Šæ”¹ï¼šè¿™éƒ¨åˆ†ä¸æ˜¯é‡ç‚¹éƒ¨åˆ†ï¼Œæ—¶é—´æ¥ä¸åŠå¯ä»¥é€‰è¿™ä¸ªæ–¹æ³•</li>
<li>ä¸°å¯Œä¸€ä¸‹</li>
</ul>
</li>
</ul>
<h4 id="äºŒã€é—®é¢˜åˆ†æ"><a href="#äºŒã€é—®é¢˜åˆ†æ" class="headerlink" title="äºŒã€é—®é¢˜åˆ†æ"></a><strong>äºŒã€é—®é¢˜åˆ†æ</strong></h4><ul>
<li>é¢˜ç›®ä¸­åŒ…å«çš„ä¿¡æ¯æ¡ä»¶ï¼Œåˆ©ç”¨ä¿¡æ¯å’Œæ¡ä»¶å¯¹é¢˜ç›®åšæ•´ä½“åˆ†æï¼Œç¡®å®šç”¨ä»€ä¹ˆæ–¹æ³•å»ºæ¨¡ï¼Œæ¯ä¸ªé—®é¢˜å•ç‹¬æ”¾ä¸€æ®µï¼Œåˆ†æè¿‡ç¨‹ç®€æ˜æ‰¼è¦ï¼Œä¸éœ€è¦æ”¾ç»“è®º</li>
<li>ä¸€èˆ¬ä¸è¶…è¿‡ä¸€é¡µï¼Œé—®é¢˜è¾ƒå¤šæ—¶ä¸è¶…è¿‡ä¸¤é¡µ</li>
<li>å›¾</li>
<li>æ ¼å¼<ul>
<li><strong>å¯é€‰ï¼šæ€»çš„</strong></li>
<li><strong>2.1å¯¹é—®é¢˜ä¸€çš„åˆ†æ</strong></li>
<li><strong>2.2å¯¹é—®é¢˜äºŒçš„åˆ†æ</strong></li>
<li><strong>2.3å¯¹é—®é¢˜ä¸‰çš„åˆ†æ</strong></li>
</ul>
</li>
</ul>
<h4 id="ä¸‰ã€æ¨¡å‹å‡è®¾"><a href="#ä¸‰ã€æ¨¡å‹å‡è®¾" class="headerlink" title="ä¸‰ã€æ¨¡å‹å‡è®¾"></a>ä¸‰ã€æ¨¡å‹å‡è®¾</h4><ul>
<li><strong>1ã€‚ 2ã€‚ 3.ã€‚ã€‚</strong></li>
<li>é¢˜ç›®ä¸­æ˜ç¡®ç»™å‡ºçš„å‡è®¾æ¡ä»¶</li>
<li>æ’é™¤ç”Ÿæ´»ä¸­çš„å°æ¦‚ç‡äº‹ä»¶</li>
<li>ä»…è€ƒè™‘é—®é¢˜ä¸­çš„æ ¸å¿ƒå› ç´ ï¼Œä¸è€ƒè™‘æ¬¡è¦å› ç´ <ul>
<li>ä¸è¦è¿‡äºç®€åŒ–</li>
</ul>
</li>
<li><img src="/posts/4c8b4541/image-20210904133357130.png" alt></li>
</ul>
<h4 id="å››ã€ç¬¦å·è¯´æ˜"><a href="#å››ã€ç¬¦å·è¯´æ˜" class="headerlink" title="å››ã€ç¬¦å·è¯´æ˜"></a>å››ã€ç¬¦å·è¯´æ˜</h4><p><strong>ä¸‰çº¿è¡¨</strong></p>
<ul>
<li>ä¸´æ—¶å˜é‡å¯ä»¥ä¸æ”¾</li>
<li>ä¸‹æ–‡ä¸­é¦–æ¬¡å‡ºç°è¿™äº›å˜é‡æ—¶ä¹Ÿè¦è§£é‡Š</li>
<li>å¯ä»¥åŠ ä¸€ä¸‹å•ä½</li>
</ul>
<h4 id="äº”ã€æ¨¡å‹å»ºç«‹ä¸æ±‚è§£"><a href="#äº”ã€æ¨¡å‹å»ºç«‹ä¸æ±‚è§£" class="headerlink" title="äº”ã€æ¨¡å‹å»ºç«‹ä¸æ±‚è§£"></a>äº”ã€æ¨¡å‹å»ºç«‹ä¸æ±‚è§£</h4><ul>
<li><strong>5.1 é—®é¢˜ä¸€æ¨¡å‹å»ºç«‹ä¸æ±‚è§£</strong></li>
<li><strong>5.2é—®é¢˜äºŒæ¨¡å‹å»ºç«‹ä¸æ±‚è§£</strong></li>
<li>â€¦..</li>
</ul>
<h4 id="å…­ã€æ¨¡å‹çš„åˆ†æä¸æ£€éªŒï¼ˆOption"><a href="#å…­ã€æ¨¡å‹çš„åˆ†æä¸æ£€éªŒï¼ˆOption" class="headerlink" title="å…­ã€æ¨¡å‹çš„åˆ†æä¸æ£€éªŒï¼ˆOption)"></a>å…­ã€æ¨¡å‹çš„åˆ†æä¸æ£€éªŒï¼ˆOption)</h4><ul>
<li><p>åˆ†æ</p>
<ul>
<li>å¸¸è§ä¸¤ç§ï¼š1.çµæ•åº¦åˆ†æ<ul>
<li>æ§åˆ¶å…¶ä»–å‚æ•°ä¸å˜ï¼Œæ”¹å˜æŸä¸ªé‡è¦å‚æ•°çš„å€¼ï¼Œè§‚å¯Ÿæ¨¡å‹å˜åŒ–</li>
<li><img src="/posts/4c8b4541/image-20210904135644870.png" alt></li>
</ul>
</li>
<li>è¯¯å·®åˆ†æ<ul>
<li>é¢„æµ‹é—®é¢˜æˆ–æ•°å€¼è®¡ç®—é—®é¢˜</li>
</ul>
</li>
</ul>
</li>
<li><p>æ£€éªŒ</p>
<ul>
<li>æœ€å¸¸è§çš„æ˜¯ç¨³å®šæ€§æ£€éªŒ</li>
<li><img src="/posts/4c8b4541/image-20210904140719365.png" alt></li>
</ul>
</li>
</ul>
<h4 id="ä¸ƒã€æ¨¡å‹çš„è¯„ä»·"><a href="#ä¸ƒã€æ¨¡å‹çš„è¯„ä»·" class="headerlink" title="ä¸ƒã€æ¨¡å‹çš„è¯„ä»·"></a><strong>ä¸ƒã€æ¨¡å‹çš„è¯„ä»·</strong></h4><ul>
<li><strong>7.1 æ¨¡å‹çš„è¯„ä»·</strong>ï¼š<ul>
<li>ä¼˜ç‚¹</li>
<li>ç¼ºç‚¹</li>
</ul>
</li>
<li><strong>7.2 æ¨¡å‹çš„æ”¹è¿›</strong>ï¼šé’ˆå¯¹æ¨¡å‹ä¸­çš„ç¼ºç‚¹å¯ä»¥æ”¹è¿›çš„åœ°æ–¹</li>
<li><strong>7.3 æ¨¡å‹çš„æ¨å¹¿</strong> å¯é€‰</li>
</ul>
<h4 id="å…«ã€å‚è€ƒæ–‡çŒ®"><a href="#å…«ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="å…«ã€å‚è€ƒæ–‡çŒ®"></a>å…«ã€å‚è€ƒæ–‡çŒ®</h4><ul>
<li>ä¸è¦å»å¼•ç”¨åšå®¢ å’Œ ä»¥å¾€çš„è®ºæ–‡</li>
</ul>
<h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a><strong>é™„å½•</strong></h4><h3 id="ç¼–è¾‘å¥½çš„è®ºæ–‡æ¨¡æ¿"><a href="#ç¼–è¾‘å¥½çš„è®ºæ–‡æ¨¡æ¿" class="headerlink" title="ç¼–è¾‘å¥½çš„è®ºæ–‡æ¨¡æ¿"></a>ç¼–è¾‘å¥½çš„è®ºæ–‡æ¨¡æ¿</h3><p><a href="https://github.com/Xandra298/For_GMCM">Xandra298/For_GMCM (github.com)</a></p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>æ•°æ¨¡</tag>
      </tags>
  </entry>
  <entry>
    <title>miketex+vscode</title>
    <url>/posts/75b83972/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="miketexå®‰è£…é…ç½®"><a href="#miketexå®‰è£…é…ç½®" class="headerlink" title="miketexå®‰è£…é…ç½®"></a>miketexå®‰è£…é…ç½®</h2><span id="more"></span>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/DrGuCoding/article/details/123523407">https://blog.csdn.net/DrGuCoding/article/details/123523407</a></p>
<p>å…¶ä¸­ï¼Œperlå®‰è£…æˆ‘ä½¿ç”¨äº†strawberryçš„ã€‚</p>
<h2 id="VSCODE"><a href="#VSCODE" class="headerlink" title="VSCODE"></a>VSCODE</h2><ol>
<li><p>å®‰è£… LaTeX Workshop æ’ä»¶</p>
<p>æ’ä»¶å¸‚åœºæœç´¢å®‰è£…</p>
</li>
<li><p>é…ç½® LaTeX Workshop</p>
</li>
</ol>
<p>â€‹        ã€è®¾ç½®ã€‘ä¸­æ‰¾åˆ°setting.jsonæ–‡ä»¶ï¼Œæ·»åŠ ç›¸å…³é…ç½®</p>
<p>â€‹        ç›®å‰ä½¿ç”¨çš„ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;latex-workshop.showContextMenu&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">//å³é”®èœå•  </span></span><br><span class="line"><span class="attr">&quot;latex-workshop.intellisense.package.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">//æ ¹æ®åŠ è½½çš„åŒ…ï¼Œè‡ªåŠ¨å®Œæˆå‘½ä»¤æˆ–åŒ…  </span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.autoBuild.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;never&quot;</span><span class="punctuation">,</span> <span class="comment">//ç¦æ­¢ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨build </span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.recipes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex -&gt; bibtex -&gt; xelatex*2&quot;</span><span class="punctuation">,</span> <span class="comment">//æ”¾åœ¨ç¬¬ä¸€ä¸ªçš„ä¸ºé»˜è®¤æ–¹æ¡ˆ</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PDFLaTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PDFLaTeX with Shell Escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;pdflatex-with-shell-escape&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XeLaTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XeLaTeX with Shell Escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;xelatex-with-shell-escape&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex -&gt; bibtex -&gt; pdflatex*2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  </span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LaTeXmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;latexmk&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BibTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;bibtex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-outdir=%OUTDIR%&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex-with-shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex-with-shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>å„ç§å‘½ä»¤ç‚¹å‡»å³å¯æ“ä½œ</p>
<p><img src="/posts/75b83972/image-20230918172742533.png" alt></p>
</li>
</ol>
<p>â€‹    å¿«æ·é”®ï¼šå·¦ä¾§ctrl+alt+J å®šä½åˆ°pdfä½ç½®</p>
<p>â€‹        pdfä½ç½® ctrl+é¼ æ ‡ç‚¹å‡» å®šä½åˆ°texä½ç½®</p>
<ul>
<li><p>ç»ˆç«¯ä½¿ç”¨miketexç¼–è¯‘ï¼š xelatex file.tex ç­‰</p>
<p><a href="https://zhuanlan.zhihu.com/p/256370737">xelatex ä»¥åŠ latexmk å‘½ä»¤è¡Œç¼–è¯‘ - çŸ¥ä¹ (zhihu.com)</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>latex</category>
      </categories>
      <tags>
        <tag>é…ç½®</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨wandbå¯è§†åŒ–å‚æ•°é€‰å–</title>
    <url>/posts/bad385cb/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Sweep"><a href="#Sweep" class="headerlink" title="Sweep"></a>Sweep</h2><blockquote>
<p>åœ¨é«˜ç»´è¶…å‚æ•°ç©ºé—´ä¸­æœç´¢ï¼Œä»¥æ‰¾åˆ°æ€§èƒ½æœ€å¥½çš„æ¨¡å‹ï¼Œä¼šå¾ˆä¸æ–¹ä¾¿ã€‚è¶…å‚æ•°sweepæä¾›äº†ä¸€ç§æœ‰ç»„ç»‡çš„ã€æœ‰æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œæ¨¡å‹çš„å¤§å†³æˆ˜ï¼Œå¹¶æŒ‘é€‰å‡ºæœ€å‡†ç¡®çš„æ¨¡å‹ã€‚å®ƒä»¬é€šè¿‡è‡ªåŠ¨æœç´¢è¶…å‚æ•°å€¼çš„ç»„åˆï¼ˆå¦‚å­¦ä¹ ç‡ã€æ‰¹é‡å¤§å°ã€éšè—å±‚æ•°é‡ã€ä¼˜åŒ–å™¨ç±»å‹ï¼‰æ¥æ‰¾åˆ°æœ€ä¼˜åŒ–çš„å€¼ã€‚</p>
</blockquote>
<span id="more"></span>
<p>å®˜æ–¹æ•™ç¨‹colab:</p>
<p><a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/pytorch/Organizing_Hyperparameter_Sweeps_in_PyTorch_with_W%26B.ipynb#scrollTo=T_lZSMgX4DLg">Organizing_Hyperparameter_Sweeps_in_PyTorch_with_W&amp;B.ipynb - Colaboratory (google.com)</a></p>
<h2 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h2><h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><p>å¯å‚è§å‰ä¸€ç¯‡æ–‡ç« ã€‚</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pip install wandb -Uq</span><br></pre></td></tr></table></figure>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">wandb.login()</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¼€å§‹æ­£å¼çš„æ¥ä½¿ç”¨sweep!</p>
<p><strong><u>æ³¨ï¼šåç»­ä»£ç éƒ½æ˜¯pythonä»£ç ï¼Œ1-3éƒ½åœ¨main.pyä¸­å†™å³å¯ã€‚</u></strong></p>
<h3 id="1-Define-the-sweep"><a href="#1-Define-the-sweep" class="headerlink" title="1. Define the sweep"></a>1. Define the sweep</h3><h4 id="1-1-é€‰æ‹©æœç´¢æ–¹æ³•"><a href="#1-1-é€‰æ‹©æœç´¢æ–¹æ³•" class="headerlink" title="1.1 é€‰æ‹©æœç´¢æ–¹æ³•"></a>1.1 é€‰æ‹©æœç´¢æ–¹æ³•</h4><blockquote>
<p> We provide the following search <code>methods</code>:</p>
<ul>
<li><p><strong><code>grid</code> Search</strong> â€“ Iterate over every combination of hyperparameter values. Very effective, but can be <strong>computationally costly</strong>.</p>
</li>
<li><p><strong><code>random</code> Search</strong> â€“ Select each new combination at random according to provided <code>distribution</code>s. Surprisingly effective!</p>
</li>
<li><p><strong><code>bayes</code>ian Search</strong> â€“ Create a probabilistic model of metric score as a function of the hyperparameters, and choose parameters with high probability of improving the metric. Works well for small numbers of continuous parameters but scales poorly.</p>
</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sweep_config = &#123;</span><br><span class="line">    <span class="string">&#x27;method&#x27;</span>: <span class="string">&#x27;random&#x27;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®ç›®æ ‡: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">metric = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;loss&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;goal&#x27;</span>: <span class="string">&#x27;minimize&#x27;</span>   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">sweep_config[<span class="string">&#x27;metric&#x27;</span>] = metric</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯accï¼Œé‚£ä¹ˆå°±æ˜¯<code>maximize</code></p>
<h4 id="1-2-å‘½åè¶…å‚æ•°"><a href="#1-2-å‘½åè¶…å‚æ•°" class="headerlink" title="1.2 å‘½åè¶…å‚æ•°"></a>1.2 å‘½åè¶…å‚æ•°</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parameters_dict = &#123;</span><br><span class="line">    <span class="string">&#x27;optimizer&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;values&#x27;</span>: [<span class="string">&#x27;adam&#x27;</span>, <span class="string">&#x27;sgd&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">    <span class="string">&#x27;fc_layer_size&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;values&#x27;</span>: [<span class="number">128</span>, <span class="number">256</span>, <span class="number">512</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">    <span class="string">&#x27;dropout&#x27;</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;values&#x27;</span>: [<span class="number">0.3</span>, <span class="number">0.4</span>, <span class="number">0.5</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">sweep_config[<span class="string">&#x27;parameters&#x27;</span>] = parameters_dict</span><br></pre></td></tr></table></figure>
<p>ä¸æƒ³å˜åŒ–çš„è¶…å‚æ•°, å€¼è®¾ä¸€ä¸ªï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parameters_dict.update(&#123;</span><br><span class="line">    <span class="string">&#x27;epochs&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;value&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç»™å‡ºåˆ†å¸ƒï¼š<a href="https://docs.wandb.com/sweeps/configuration#distributions">è®¾ç½®åˆ†å¸ƒ</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parameters_dict.update(&#123;</span><br><span class="line">    <span class="string">&#x27;learning_rate&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment"># a flat distribution between 0 and 0.1</span></span><br><span class="line">        <span class="string">&#x27;distribution&#x27;</span>: <span class="string">&#x27;uniform&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;min&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;max&#x27;</span>: <span class="number">0.1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    <span class="string">&#x27;batch_size&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment"># integers between 32 and 256</span></span><br><span class="line">        <span class="comment"># with evenly-distributed logarithms </span></span><br><span class="line">        <span class="string">&#x27;distribution&#x27;</span>: <span class="string">&#x27;q_log_uniform_values&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;q&#x27;</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="string">&#x27;min&#x27;</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="string">&#x27;max&#x27;</span>: <span class="number">256</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>çœ‹çœ‹ç°åœ¨çš„<code>sweep_config</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">pprint.pprint(sweep_config)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;method&#x27;: &#x27;random&#x27;,</span><br><span class="line"> &#x27;metric&#x27;: &#123;&#x27;goal&#x27;: &#x27;minimize&#x27;, &#x27;name&#x27;: &#x27;loss&#x27;&#125;,</span><br><span class="line"> &#x27;parameters&#x27;: &#123;&#x27;batch_size&#x27;: &#123;&#x27;distribution&#x27;: &#x27;q_log_uniform_values&#x27;,</span><br><span class="line">                               &#x27;max&#x27;: 256,</span><br><span class="line">                               &#x27;min&#x27;: 32,</span><br><span class="line">                               &#x27;q&#x27;: 8&#125;,</span><br><span class="line">                &#x27;dropout&#x27;: &#123;&#x27;values&#x27;: [0.3, 0.4, 0.5]&#125;,</span><br><span class="line">                &#x27;epochs&#x27;: &#123;&#x27;value&#x27;: 1&#125;,</span><br><span class="line">                &#x27;fc_layer_size&#x27;: &#123;&#x27;values&#x27;: [128, 256, 512]&#125;,</span><br><span class="line">                &#x27;learning_rate&#x27;: &#123;&#x27;distribution&#x27;: &#x27;uniform&#x27;,</span><br><span class="line">                                  &#x27;max&#x27;: 0.1,</span><br><span class="line">                                  &#x27;min&#x27;: 0&#125;,</span><br><span class="line">                &#x27;optimizer&#x27;: &#123;&#x27;values&#x27;: [&#x27;adam&#x27;, &#x27;sgd&#x27;]&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ—©åœåŠå…¶ä»–è®¾ç½®ç­‰ï¼š</li>
</ul>
<p><a href="https://docs.wandb.com/sweeps/configuration#stopping-criteria">https://docs.wandb.com/sweeps/configuration#stopping-criteria</a></p>
<h3 id="2-initialize-the-Sweep"><a href="#2-initialize-the-Sweep" class="headerlink" title="2. initialize the Sweep"></a>2. initialize the Sweep</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sweep_id = wandb.sweep(sweep_config, project=<span class="string">&quot;pytorch-sweeps-demo&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="3-run-the-Sweep-agent"><a href="#3-run-the-Sweep-agent" class="headerlink" title="3. run the Sweep agent"></a>3. run the Sweep agent</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">config=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="comment"># Initialize a new wandb run</span></span><br><span class="line">    <span class="keyword">with</span> wandb.init(config=config):</span><br><span class="line">        <span class="comment"># If called by wandb.agent, as below,</span></span><br><span class="line">        <span class="comment"># this config will be set by Sweep Controller</span></span><br><span class="line">        config = wandb.config</span><br><span class="line"></span><br><span class="line">        loader = build_dataset(config.batch_size)</span><br><span class="line">        network = build_network(config.fc_layer_size, config.dropout)</span><br><span class="line">        optimizer = build_optimizer(network, config.optimizer, config.learning_rate)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(config.epochs):</span><br><span class="line">            avg_loss = train_epoch(network, loader, optimizer)</span><br><span class="line">            wandb.log(&#123;<span class="string">&quot;loss&quot;</span>: avg_loss, <span class="string">&quot;epoch&quot;</span>: epoch&#125;)           </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">build_dataset</span>(<span class="params">batch_size</span>):</span><br><span class="line">   </span><br><span class="line">    transform = transforms.Compose(</span><br><span class="line">        [transforms.ToTensor(),</span><br><span class="line">         transforms.Normalize((<span class="number">0.1307</span>,), (<span class="number">0.3081</span>,))])</span><br><span class="line">    <span class="comment"># download MNIST training dataset</span></span><br><span class="line">    dataset = datasets.MNIST(<span class="string">&quot;.&quot;</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>,</span><br><span class="line">                             transform=transform)</span><br><span class="line">    sub_dataset = torch.utils.data.Subset(</span><br><span class="line">        dataset, indices=<span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dataset), <span class="number">5</span>))</span><br><span class="line">    loader = torch.utils.data.DataLoader(sub_dataset, batch_size=batch_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> loader</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_network</span>(<span class="params">fc_layer_size, dropout</span>):</span><br><span class="line">    network = nn.Sequential(  <span class="comment"># fully-connected, single hidden layer</span></span><br><span class="line">        nn.Flatten(),</span><br><span class="line">        nn.Linear(<span class="number">784</span>, fc_layer_size), nn.ReLU(),</span><br><span class="line">        nn.Dropout(dropout),</span><br><span class="line">        nn.Linear(fc_layer_size, <span class="number">10</span>),</span><br><span class="line">        nn.LogSoftmax(dim=<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> network.to(device)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_optimizer</span>(<span class="params">network, optimizer, learning_rate</span>):</span><br><span class="line">    <span class="keyword">if</span> optimizer == <span class="string">&quot;sgd&quot;</span>:</span><br><span class="line">        optimizer = optim.SGD(network.parameters(),</span><br><span class="line">                              lr=learning_rate, momentum=<span class="number">0.9</span>)</span><br><span class="line">    <span class="keyword">elif</span> optimizer == <span class="string">&quot;adam&quot;</span>:</span><br><span class="line">        optimizer = optim.Adam(network.parameters(),</span><br><span class="line">                               lr=learning_rate)</span><br><span class="line">    <span class="keyword">return</span> optimizer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_epoch</span>(<span class="params">network, loader, optimizer</span>):</span><br><span class="line">    cumu_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(loader):</span><br><span class="line">        data, target = data.to(device), target.to(device)</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># â¡ Forward pass</span></span><br><span class="line">        loss = F.nll_loss(network(data), target)</span><br><span class="line">        cumu_loss += loss.item()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># â¬… Backward pass + weight update</span></span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        wandb.log(&#123;<span class="string">&quot;batch loss&quot;</span>: loss.item()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cumu_loss / <span class="built_in">len</span>(loader)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wandb.agent(sweep_id, train, count=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<h3 id="å¯è§†åŒ–ç»“æœ"><a href="#å¯è§†åŒ–ç»“æœ" class="headerlink" title="å¯è§†åŒ–ç»“æœ"></a>å¯è§†åŒ–ç»“æœ</h3><p>å»urlæŸ¥çœ‹å³å¯</p>
<h4 id="Parallel-Coordinates-Plot"><a href="#Parallel-Coordinates-Plot" class="headerlink" title="Parallel Coordinates Plot"></a>Parallel Coordinates Plot</h4><p>â€‹        å°†è¶…å‚æ•°å€¼æ˜ å°„åˆ°æ¨¡å‹åº¦é‡ã€‚</p>
<p>â€‹        é¢æ¿å·¦ä¾§å¯ä»¥é€‰æ‹©å¯¹æŸäº›runè¿›è¡Œéšè—ï¼Œéšè—ä¹‹åï¼Œã€å¹¶è¡Œå…³è”plotã€‘å’Œåé¢è¯´åˆ°çš„ã€å‚æ•°é‡è¦æ€§plotã€‘ä¸­éƒ½ä¼šéšè—å’Œæ’é™¤é‚£äº›runã€‚</p>
<p>â€‹        <img src="/posts/bad385cb/image-20230321163057544.png" style="zoom:67%;"></p>
<h4 id="è¶…å‚æ•°é‡è¦æ€§"><a href="#è¶…å‚æ•°é‡è¦æ€§" class="headerlink" title="è¶…å‚æ•°é‡è¦æ€§"></a>è¶…å‚æ•°é‡è¦æ€§</h4><p>Hyperparameter Importance Plot</p>
<p>â€‹    è¶…å‚æ•°çš„é‡è¦æ€§å›¾æµ®ç°äº†å“ªäº›è¶…å‚æ•°æ˜¯ä½ çš„æŒ‡æ ‡çš„æœ€ä½³é¢„æµ‹å› ç´ ã€‚æŠ¥å‘Šç‰¹å¾é‡è¦æ€§ï¼ˆæ¥è‡ªéšæœºæ£®æ—æ¨¡å‹ï¼‰å’Œç›¸å…³æ€§ï¼ˆéšå«çº¿æ€§æ¨¡å‹ï¼‰ã€‚</p>
<p>â€‹    <a href="https://docs.wandb.ai/guides/app/features/panels/parameter-importance?_gl=1*1fibtjr*_ga*MTA4ODY1MjM2Ni4xNjc5MjgyNTkw*_ga_JH1SJHJQXJ*MTY3OTQ3NTQ0OS4xNi4xLjE2Nzk0NzYwMTguNTIuMC4w">Parameter Importance | Weights &amp; Biases Documentation (wandb.ai)</a></p>
<p><img src="/posts/bad385cb/image-20230322171329626.png" alt></p>
<blockquote>
<p>é‡è¦æ€§åˆ—</p>
<p><u>æ˜¾ç¤ºäº†æ¯ä¸ªé«˜å‚æ•°åœ¨é¢„æµ‹æ‰€é€‰åº¦é‡æ–¹é¢æœ‰ç”¨çš„ç¨‹åº¦ã€‚</u>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ç§åœºæ™¯ï¼Œé¦–å…ˆè¦è°ƒæ•´å¤§é‡çš„è¶…å‚æ•°ï¼Œå¹¶åˆ©ç”¨è¿™ç§æƒ…èŠ‚æ¥ç£¨ç»ƒå“ªäº›<strong>å€¼å¾—è¿›ä¸€æ­¥çš„æ¢ç´¢</strong>ã€‚ç„¶åï¼Œ<strong>éšåçš„æ‰«æå¯èƒ½ä»…é™äºæœ€é‡è¦çš„è¶…å‚æ•°</strong>ï¼Œä»è€Œæ›´å¿«ï¼Œæ›´ä¾¿å®œã€‚</p>
<p>æ³¨æ„ï¼šæˆ‘ä»¬ä½¿ç”¨åŸºäºæ ‘çš„æ¨¡å‹è€Œä¸æ˜¯çº¿æ€§æ¨¡å‹æ¥è®¡ç®—è¿™äº›é‡è¦æ€§ï¼Œå› ä¸ºå‰è€…å¯¹åˆ†ç±»æ•°æ®å’Œä¸å½’ä¸€åŒ–çš„æ•°æ®æ›´æœ‰å®½å®¹åº¦ã€‚</p>
<p>åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†æ¬¡æ‰«è¡æ¢ç´¢è¿™äº›è¶…å‚æ•°çš„æ›´å¤šç»†ç²’åº¦å€¼ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå°½ç®¡Learning_rateå’Œbatch_sizeå¾ˆé‡è¦ï¼Œä½†å®ƒä»¬ä¸è¾“å‡ºçš„ç›¸å…³æ€§å¹¶ä¸å¾ˆå¥½ã€‚è¿™å°±å¼•å…¥åˆ°æˆ‘ä»¬è¯´çš„ã€ç›¸å…³æ€§ã€‘ã€‚</p>
<p>ç›¸å…³æ€§</p>
<p><u>æ•è·å•ä¸ªè¶…å‚æ•°å’Œåº¦é‡å€¼ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚</u>ä»–ä»¬å›ç­”äº†è¿™ä¸ªé—®é¢˜ : ä½¿ç”¨è¶…å‚æ•°ï¼ˆä¾‹å¦‚SGD Optimizerï¼‰å’Œæˆ‘çš„Val_lossï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹çš„ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼‰ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾ç€å…³ç³»ã€‚ç›¸å…³å€¼èŒƒå›´ä¸º-1åˆ°1ï¼Œå…¶ä¸­<strong>æ­£å€¼ä»£è¡¨æ­£çº¿æ€§ç›¸å…³ï¼Œè´Ÿå€¼ä»£è¡¨è´Ÿçº¿æ€§ç›¸å…³ï¼Œå€¼ä¸º0è¡¨ç¤ºæ— ç›¸å…³ã€‚é€šå¸¸ï¼Œåœ¨ä»»ä¸€æ–¹å‘ä¸Šå¤§äº0.7çš„å€¼è¡¨ç¤ºå¼ºç›¸å…³ã€‚</strong></p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨æ­¤å›¾æ¥è¿›ä¸€æ­¥æ¢ç´¢ä¸æˆ‘ä»¬çš„åº¦é‡ç›¸å…³æ€§è¾ƒé«˜ç›¸å…³çš„å€¼ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©éšæœºæ¢¯åº¦ä¸‹é™ï¼Œæˆ–è€…åœ¨RMSPROPæˆ–NADAMä¸Šé€‰æ‹©ADAMï¼‰æˆ–è®­ç»ƒæ›´å¤šæ—¶ä»£ã€‚</p>
<p>å…³äºè§£é‡Šç›¸å…³æ€§éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ul>
<li><p>ç›¸å…³æ€§æ˜¾ç¤ºäº†å…³è”çš„è¯æ®ï¼Œä¸ä¸€å®šæ˜¯å› æœå…³ç³»ã€‚</p>
</li>
<li><p>ç›¸å…³æ€§å¯¹ç¦»ç¾¤å€¼æ•æ„Ÿï¼Œç¦»ç¾¤å€¼å¯èƒ½ä¼šå°†ç‰¢å›ºçš„å…³ç³»è½¬åŒ–ä¸ºä¸­ç­‰çš„å…³ç³»ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå°è¯•çš„è¶…å‚æ•°çš„æ ·æœ¬é‡å¾ˆå°ï¼Œåˆ™å¯èƒ½ä¼šå°†å…¶å˜ä¸ºä¸­é—´çš„å¼‚å¸¸å€¼ã€‚</p>
</li>
<li><p>æœ€åï¼Œç›¸å…³ä»…æ•è·è¶…å‚æ•°å’ŒæŒ‡æ ‡ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚å¦‚æœå­˜åœ¨ç‰¢å›ºçš„å¤šé¡¹å¼å…³ç³»ï¼Œåˆ™ä¸ä¼šè¢«ç›¸å…³æ€§æ•è·ã€‚</p>
</li>
</ul>
<p>é‡è¦æ€§ä¸ç›¸å…³æ€§ä¹‹é—´çš„å·®å¼‚æ˜¯ç”±äº<u>é‡è¦æ€§è§£é‡Šäº†è¶…å‚æ•°ä¹‹é—´çš„ç›¸äº’ä½œç”¨</u>ï¼Œè€Œ<u>ç›¸å…³æ€§ä»…æµ‹é‡å•ä¸ªè¶…å‚æ•°å¯¹åº¦é‡å€¼çš„å½±å“</u>ã€‚å…¶æ¬¡ï¼Œ<strong>ç›¸å…³ä»…æ•è·çº¿æ€§å…³ç³»ï¼Œè€Œé‡è¦æ€§å¯ä»¥æ•è·æ›´å¤æ‚çš„å…³ç³»ã€‚</strong></p>
<p>å¦‚æ‚¨æ‰€è§ï¼Œé‡è¦æ€§å’Œç›¸å…³æ€§æ˜¯äº†è§£è¶…å‚æ•°å¦‚ä½•å½±å“æ¨¡å‹æ€§èƒ½çš„å¼ºå¤§å·¥å…·ã€‚</p>
</blockquote>
<h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h2><ol>
<li>configå¯é€‰é¡¹ï¼ŒåŒ…æ‹¬early stop ,schedulerç­‰</li>
<li><code>bayesian Search</code></li>
</ol>
<h2 id="bugè®°å½•"><a href="#bugè®°å½•" class="headerlink" title="bugè®°å½•"></a>bugè®°å½•</h2><ul>
<li><p>è¿è¡Œæœ‰æ—¶å€™è¿˜æ˜¯ä¼šå‡ºç°process communicating errorï¼Œè§£å†³æ–¹æ¡ˆå‚è§å‰ä¸€ç¯‡æ–‡ç« ã€‚å…·ä½“ä¿®æ”¹<code>with wandb.init():</code></p>
</li>
<li><p>è‡ªå·±çš„é”™è¯¯ï¼šç”±äºè‡ªå·±è®­ç»ƒæ¨¡å‹çš„æ—¶å€™æœ‰<code>import train from train</code> (è‡ªå®šä¹‰çš„æ–¹æ³•)ï¼Œè€Œæ­¤æ¬¡ä½¿ç”¨sweepåˆdef äº†ä¸€ä¸ªtrainï¼ˆï¼‰ï¼Œä¸trainåŒåï¼Œäº§ç”Ÿé”™è¯¯ã€‚</p>
</li>
<li><p>network error</p>
<p>å³ä½¿æˆ‘forkäº†ä¹‹åï¼Œsweepè¿‡ç¨‹ä¸­ï¼Œæ€»æ˜¯æœ‰å‡ æ¬¡ä¼šnetwork errorï¼ŒéšåæŠ¥é”™process communicating failedã€‚è™½ç„¶å…¶ä¼šç»§ç»­ä¸‹ä¸€æ¬¡çš„å®éªŒï¼Œä½†æ˜¯è¿™æ ·å¾ˆå½±å“ã€‚</p>
<p><a href="https://blog.csdn.net/weixin_41978699/article/details/122794205">wandb: Network error (ConnectionError), entering retry loop._harry_teaçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è§£å†³æ–¹å¼1ï¼šoffline éƒ¨ç½²</p>
</li>
</ul>
<h3 id="offlineéƒ¨ç½²"><a href="#offlineéƒ¨ç½²" class="headerlink" title="offlineéƒ¨ç½²"></a>offlineéƒ¨ç½²</h3><ol>
<li>åœ¨æ–‡ä»¶å¼€å¤´åŠ ä¸Š</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">os.environ[<span class="string">&quot;WANDB_API_KEY&quot;</span>] = YOUR_KEY_HERE</span><br><span class="line">os.environ[<span class="string">&quot;WANDB_MODE&quot;</span>] = <span class="string">&quot;offline&quot;</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>æœ€åè®­ç»ƒå®Œåä¼šå‡ºç°<code>wandb sync wandb/xxx</code>ï¼ŒæŒ‰ç…§æç¤ºåŒæ­¥å³å¯</p>
<p>shellå‘½ä»¤æ‰§è¡Œ</p>
</li>
</ol>
<p><a href="https://docs.wandb.ai/ref/cli/wandb-sync">wandb sync | Weights &amp; Biases Documentation</a></p>
<ul>
<li><p>æˆ‘offlineè·‘sweep,ç„¶åæŠŠæ‰€æœ‰çš„run wandb syncï¼Œå‘ç°é”™è¯¯ã€‚sweepä¸æ­£å¸¸</p>
<ol>
<li><p>metricæœªå’Œlogé‡Œçš„åç§°å¯¹åº”ï¼Œæ³¨æ„ï¼Œå¯¹åº”çš„æ˜¯nameä¹‹é—´çš„å¯¹åº”ï¼Œè€Œä¸æ˜¯valueçš„å˜é‡åï¼</p>
</li>
<li><p>offlineçš„æƒ…å†µä¸‹å‡ºç°å…¶ä»–é—®é¢˜ï¼ˆsyncä¹‹ååªèƒ½æ‰¾åˆ°4/10ä¸ªrun)</p>
</li>
</ol>
</li>
<li><p>æ­¤å¤–ï¼Œåœ¨offline syncè¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°network errorï¼Œè¿‡ä¸€ä¼šå°±èƒ½èµ°äº†ï¼ˆretry loop)</p>
</li>
</ul>
<h3 id="online-è®°å½•"><a href="#online-è®°å½•" class="headerlink" title="online è®°å½•"></a>online è®°å½•</h3><ul>
<li>onlineè·‘ï¼Œwandb.init() <code>reinit=True</code>è¿™ä¸€å‚æ•°æ²¡æœ‰è®¾ç½®ï¼Œå¹¶ä¸”è®¾ç½®<code>setting=wandb.Settings(start_method=(&quot;thread&quot;))</code>ï¼ŒæˆåŠŸè¿è¡Œä¸­</li>
</ul>
]]></content>
      <categories>
        <category>å¯è§†åŒ–</category>
      </categories>
      <tags>
        <tag>wandb</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨wandbå¯è§†åŒ–</title>
    <url>/posts/aa8baae/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="wandb"><a href="#wandb" class="headerlink" title="wandb"></a>wandb</h2><blockquote>
<p> wandbæ˜¯ <strong>Weights &amp; Biases</strong> çš„ç¼©å†™ï¼Œè¿™æ¬¾å·¥å…·èƒ½å¤Ÿå¸®åŠ©è·Ÿè¸ªä½ çš„æœºå™¨å­¦ä¹ é¡¹ç›®ã€‚ å®ƒèƒ½å¤Ÿè‡ªåŠ¨è®°å½•æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¶…å‚æ•°å’Œè¾“å‡ºæŒ‡æ ‡ï¼Œç„¶åå¯è§†åŒ–å’Œæ¯”è¾ƒç»“æœï¼Œå¹¶å¿«é€Ÿä¸åŒäº‹å…±äº«ç»“æœã€‚</p>
</blockquote>
<p>å®˜ç½‘æ–‡æ¡£ï¼š<a href="https://docs.wandb.ai/">What is Weights &amp; Biases? | Weights &amp; Biases Documentation (wandb.ai)</a></p>
<h2 id="ç®€å•ä½¿ç”¨æ“ä½œ"><a href="#ç®€å•ä½¿ç”¨æ“ä½œ" class="headerlink" title="ç®€å•ä½¿ç”¨æ“ä½œ"></a>ç®€å•ä½¿ç”¨æ“ä½œ</h2><span id="more"></span>
<h3 id="0-æ³¨å†Œwandbè´¦å·ï¼Œå¹¶è·å–api-key"><a href="#0-æ³¨å†Œwandbè´¦å·ï¼Œå¹¶è·å–api-key" class="headerlink" title="0. æ³¨å†Œwandbè´¦å·ï¼Œå¹¶è·å–api key"></a>0. æ³¨å†Œwandbè´¦å·ï¼Œå¹¶è·å–api key</h3><ul>
<li>åœ¨å®˜ç½‘æ³¨å†Œè´¦å·ï¼š<a href="https://wandb.ai/">Weights &amp; Biases (wandb.ai)</a> ï¼ˆgithubè´¦å·å³å¯æ³¨å†Œï¼‰</li>
<li>è·å–api keyï¼ˆæŒ‰ç…§å®˜ç½‘å¼•å¯¼å³å¯ï¼‰<ul>
<li>api keyåç»­è¦ç”¨åˆ°</li>
</ul>
</li>
</ul>
<h3 id="1-set-up"><a href="#1-set-up" class="headerlink" title="1. set up"></a>1. set up</h3><ul>
<li><p>pipå®‰è£…</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pip install wandb</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç™»å½•wandb</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">wandb login</span><br></pre></td></tr></table></figure>
<p>ä¼šæç¤ºè¾“å…¥api keyã€‚å¦‚æœå·²ç»ç™»å½•è¿‡äº†ï¼Œæƒ³è¦é‡æ–°ç™»å½•ï¼Œåˆ™ä½¿ç”¨relogin</p>
</li>
</ul>
<h3 id="2-åœ¨ä»£ç ä¸­é…ç½®"><a href="#2-åœ¨ä»£ç ä¸­é…ç½®" class="headerlink" title="2. åœ¨ä»£ç ä¸­é…ç½®"></a>2. åœ¨ä»£ç ä¸­é…ç½®</h3><ul>
<li><p>å¯¼å…¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> wandb</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆå§‹åŒ–æ–°çš„ W&amp;B è¿è¡Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> wandb</span><br><span class="line">config = &#123;&#125; <span class="comment">#å®éªŒè®¾ç½®ï¼Œå¦‚lrç­‰ã€‚wandb.initä¼ å…¥conifg,å®é™…ä¸Šåªæ˜¯ç”¨äºæ˜¾ç¤ºæ ‡è¯†è‡ªå·±è®¾ç½®çš„å‚æ•°ã€‚</span></span><br><span class="line">wandb.init(project=<span class="string">&quot;project_name&quot;</span>ï¼Œconfig= config)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·Ÿè¸ªæŒ‡æ ‡</p>
<p>train_accä¸ºä»£ç epochä¸­å®é™…çš„å˜é‡ã€‚é€šè¿‡è¯¥å‘½ä»¤ï¼Œå¯ä»¥ç»˜åˆ¶å‡ºæŒ‡æ ‡å˜åŒ–å›¾åƒã€‚ä¹Ÿå¯ä»¥è®°å½•è‡ªå·±æƒ³è¦çš„å‚æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wandb.log(&#123;<span class="string">&#x27;accuracy&#x27;</span>: train_acc, <span class="string">&#x27;loss&#x27;</span>: train_loss&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å…³äºæƒé‡æ¢¯åº¦ç­‰çš„æ˜¾ç¤º</strong></p>
</li>
</ul>
<p>â€‹        ä¸€è¡Œç®€å•çš„å‘½ä»¤å³å¯ï¼š    </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wandb.watch(model, log=&#x27;all&#x27;)</span><br></pre></td></tr></table></figure>
<p>â€‹        åŠ è½½æ¨¡å‹å®šä¹‰å®Œä¹‹åã€‚</p>
<ul>
<li><p>æœ€å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wandb.finish()</span><br></pre></td></tr></table></figure>
<p>jupyter bookå¿…é¡»åŠ ï¼Œå…¶ä»–å¯é€‰ã€‚</p>
</li>
</ul>
<h3 id="3-è¿è¡Œä»£ç "><a href="#3-è¿è¡Œä»£ç " class="headerlink" title="3.è¿è¡Œä»£ç "></a>3.è¿è¡Œä»£ç </h3><ul>
<li><p>è¿è¡Œè‡ªå·±çš„ä»£ç </p>
</li>
<li><p>æ§åˆ¶å°ä¼šæ˜¾ç¤ºç»“æœå¯è§†åŒ–åœ¨äº‘ç«¯çš„å“ªä¸ªé“¾æ¥ã€‚æ¯æ¬¡runéƒ½ä¼šä¿ç•™ä¸€ä¸ªlogåœ¨æœ¬åœ°ã€‚</p>
</li>
</ul>
<p><img src="/posts/aa8baae/image-20230321151113119.png" alt style="zoom:67%;"></p>
<h3 id="4-å¯è§†åŒ–ç»“æœå±•ç¤º"><a href="#4-å¯è§†åŒ–ç»“æœå±•ç¤º" class="headerlink" title="4. å¯è§†åŒ–ç»“æœå±•ç¤º"></a>4. å¯è§†åŒ–ç»“æœå±•ç¤º</h3><p>è¿›å…¥projectä¸‹å¯¹åº”runçš„é“¾æ¥</p>
<ul>
<li>chartsä¸ºå‰é¢é€šè¿‡logå‘½ä»¤è·Ÿè¸ªçš„æŒ‡æ ‡</li>
</ul>
<p><img src="/posts/aa8baae/image-20230321150645567.png" alt style="zoom: 67%;"></p>
<ul>
<li><p>é€šè¿‡watchæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¢¯åº¦å’Œæƒé‡ï¼</p>
<p><img src="/posts/aa8baae/image-20230321150827903.png" alt style="zoom:67%;"></p>
</li>
</ul>
<p><img src="/posts/aa8baae/image-20230321150911169.png" alt style="zoom:67%;"></p>
<h2 id="å®Œæ•´ä»£ç ç¤ºä¾‹"><a href="#å®Œæ•´ä»£ç ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ä»£ç ç¤ºä¾‹"></a>å®Œæ•´ä»£ç ç¤ºä¾‹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># !usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># @Author:</span></span><br><span class="line"><span class="comment"># @File:wandb_gra.py</span></span><br><span class="line"><span class="comment"># @Time:2023-03-20 13:51</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> æ–‡ä»¶è¯´æ˜ï¼š</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"><span class="keyword">import</span> wandb</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> model <span class="keyword">import</span> CNN_Net</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">model, device, train_loader, optimizer, epoch</span>):</span><br><span class="line"> model.train()</span><br><span class="line"></span><br><span class="line"> n_ex = <span class="built_in">len</span>(train_loader)</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> tqdm(<span class="built_in">enumerate</span>(train_loader), total=n_ex):</span><br><span class="line">  data, target = data.to(device), target.to(device)</span><br><span class="line">  optimizer.zero_grad()</span><br><span class="line">  output = model(data)</span><br><span class="line">  loss = F.nll_loss(output, target)</span><br><span class="line">  loss.backward()</span><br><span class="line">  optimizer.step()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">model, device, test_loader</span>):</span><br><span class="line"> model.<span class="built_in">eval</span>()</span><br><span class="line"> test_loss = <span class="number">0</span></span><br><span class="line"> correct = <span class="number">0</span></span><br><span class="line"> <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">  <span class="keyword">for</span> data, target <span class="keyword">in</span> test_loader:</span><br><span class="line">   data, target = data.to(device), target.to(device)</span><br><span class="line">   output = model(data)</span><br><span class="line">   test_loss += F.nll_loss(output, target, reduction=<span class="string">&#x27;sum&#x27;</span>).item()</span><br><span class="line">   pred = output.argmax(dim=<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">   correct += pred.eq(target.view_as(pred)).<span class="built_in">sum</span>().item()</span><br><span class="line"></span><br><span class="line"> test_loss /= <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line"></span><br><span class="line"> tqdm.write(<span class="string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy: &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%)\n&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">  test_loss, correct, <span class="built_in">len</span>(test_loader.dataset),</span><br><span class="line">  <span class="number">100.</span> * correct / <span class="built_in">len</span>(test_loader.dataset)))</span><br><span class="line"></span><br><span class="line"><span class="comment">##æ³¨æ„</span></span><br><span class="line"> wandb.log(&#123;<span class="string">&#x27;test_loss&#x27;</span>: test_loss,</span><br><span class="line">             <span class="string">&#x27;accuracy&#x27;</span>: correct / <span class="built_in">len</span>(test_loader.dataset)&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line"> config = &#123;</span><br><span class="line">  <span class="string">&#x27;BATCH_SIZE&#x27;</span>: <span class="number">64</span>,</span><br><span class="line">  <span class="string">&#x27;TEST_BATCH_SIZE&#x27;</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="string">&#x27;EPOCHS&#x27;</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="string">&#x27;LR&#x27;</span>: <span class="number">0.01</span>,</span><br><span class="line">  <span class="string">&#x27;MOMENTUM&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&#x27;SEED&#x27;</span>: <span class="number">17</span>,</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">##æ³¨æ„</span></span><br><span class="line"> wandb.init(project=<span class="string">&#x27;explore-gradients&#x27;</span>, reinit=<span class="literal">True</span>, config=config)</span><br><span class="line"></span><br><span class="line"> use_cuda = torch.cuda.is_available()</span><br><span class="line"></span><br><span class="line"> torch.manual_seed(config[<span class="string">&#x27;SEED&#x27;</span>])</span><br><span class="line"></span><br><span class="line"> device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> use_cuda <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line"></span><br><span class="line"> kwargs = &#123;<span class="string">&#x27;num_workers&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;pin_memory&#x27;</span>: <span class="literal">True</span>&#125; <span class="keyword">if</span> use_cuda <span class="keyword">else</span> &#123;&#125;</span><br><span class="line"> train_loader = torch.utils.data.DataLoader(</span><br><span class="line">  datasets.MNIST(<span class="string">&#x27;../data&#x27;</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>,</span><br><span class="line">                 transform=transforms.Compose([</span><br><span class="line">                  transforms.ToTensor(),</span><br><span class="line">                  transforms.Normalize((<span class="number">0.1307</span>,), (<span class="number">0.3081</span>,))</span><br><span class="line">                 ])),</span><br><span class="line">  batch_size=config[<span class="string">&#x27;BATCH_SIZE&#x27;</span>], shuffle=<span class="literal">True</span>, **kwargs)</span><br><span class="line"> test_loader = torch.utils.data.DataLoader(</span><br><span class="line">  datasets.MNIST(<span class="string">&#x27;../data&#x27;</span>, train=<span class="literal">False</span>, transform=transforms.Compose([</span><br><span class="line">   transforms.ToTensor(),</span><br><span class="line">   transforms.Normalize((<span class="number">0.1307</span>,), (<span class="number">0.3081</span>,))</span><br><span class="line">  ])),</span><br><span class="line">  batch_size=config[<span class="string">&#x27;TEST_BATCH_SIZE&#x27;</span>], shuffle=<span class="literal">True</span>, **kwargs)</span><br><span class="line"></span><br><span class="line"> model = CNN_Net().to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment">##æ³¨æ„</span></span><br><span class="line"> wandb.watch(model, log=<span class="string">&#x27;all&#x27;</span>)</span><br><span class="line"></span><br><span class="line"> optimizer = optim.SGD(model.parameters(),</span><br><span class="line">                       lr=config[<span class="string">&#x27;LR&#x27;</span>],</span><br><span class="line">                       momentum=config[<span class="string">&#x27;MOMENTUM&#x27;</span>])</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, config[<span class="string">&#x27;EPOCHS&#x27;</span>] + <span class="number">1</span>):</span><br><span class="line">  train(model, device, train_loader, optimizer, epoch)</span><br><span class="line">  test(model, device, test_loader)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line"> main()</span><br></pre></td></tr></table></figure>
<h2 id="bugè®°å½•"><a href="#bugè®°å½•" class="headerlink" title="bugè®°å½•"></a>bugè®°å½•</h2><ul>
<li>å¦‚æœå‡ºç°process communicating error:</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wandb.init(project=<span class="string">&#x27;project_name&#x27;</span>, reinit=<span class="literal">True</span>, config=config,setting=wandb.Settings(start_method=(<span class="string">&quot;fork&quot;</span>)))</span><br></pre></td></tr></table></figure>
<p>ç‰¹å®šç‰ˆæœ¬ä»¥ä¸Šï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wandb.init(project=<span class="string">&#x27;explore-gradients&#x27;</span>, reinit=<span class="literal">True</span>, config=config,setting=wandb.Settings(start_method=(<span class="string">&quot;thread&quot;</span>)))</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å¯è§†åŒ–</category>
      </categories>
      <tags>
        <tag>wandb</tag>
      </tags>
  </entry>
  <entry>
    <title>CLIP-TSA:CLIP-Assisted Temporal Self-Attention</title>
    <url>/posts/d3b330ab/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><a href="https://arxiv.org/pdf/2212.05136.pdf">paper</a> (ICIP 2023)</p>
<span id="more"></span>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>è§£å†³VADé—®é¢˜ï¼šç”±äºåŠ³åŠ¨å¯†é›†å‹æ€§è´¨ï¼ˆå¸§çº§åˆ«çš„æ ‡æ³¨ï¼Ÿï¼‰ï¼Œé€šå¸¸ä»¥å¼±ç›‘ç£çš„æ–¹å¼è¡¨è¿°ä¸ºå¤šå®ä¾‹å­¦ä¹ é—®é¢˜(MILï¼‰ã€‚</p>
<ul>
<li>ç›¸æ¯”è¯¥é¢†åŸŸä¼ ç»Ÿä½¿ç”¨çš„C3Då’ŒI3Dæ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ViT-encoded visual features from CLIPï¼Œä»¥ä½¿ç”¨ä¸€ç§åˆ›æ–°çš„æ–¹å¼æ¥æœ‰æ•ˆåœ°æå–åˆ¤åˆ«è¡¨ç¤ºã€‚</li>
<li>model long- and short-range temporal dependenciesï¼Œ å¹¶ä½¿ç”¨æ—¶é—´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆTSAï¼‰æ¥æå–é‡è¦çš„ç‰‡æ®µï¼ˆsnipppets of interest)</li>
<li>è¿›è¡Œäº†æ¶ˆèå®éªŒï¼Œå®éªŒè¡¨æ˜æˆ‘ä»¬æå‡ºçš„CLIP-TSA åœ¨å¹¿æ³›ä½¿ç”¨çš„ä¸¤ä¸ªbenchmarkæ•°æ®é›†ï¼ˆ<strong>UCF-Crmieå’ŒShanghaiTec</strong>)å¤§èŒƒå›´çš„ä¼˜äºSOTA</li>
</ul>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>åˆ†åˆ«ä»‹ç»äº†æœ‰ç›‘ç£ã€æ— ç›‘ç£å’Œå¼±ç›‘ç£ï¼ˆåŸºäºMILæ¡†æ¶ï¼‰çš„VADæ–¹æ³•çš„ä¼˜ç¼ºç‚¹ã€‚</p>
<h3 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h3><ol>
<li><p>å¼±ç›‘ç£æ–¹æ³•çš„<strong>å·²æœ‰æå–è§†é¢‘ç‰¹å¾éª¨æ¶C3Dã€I3Då’Œ2Streamçš„ç¼ºé™·ï¼ˆå®ƒä»¬æ˜¯åœ¨åŠ¨ä½œè¯†åˆ«ä»»åŠ¡ä¸Šé¢„è®­ç»ƒçš„ï¼‰ï¼š</strong></p>
<p>ä¸åŠ¨ä½œè¯†åˆ«é—®é¢˜ä¸åŒï¼ŒVADä¾èµ–äºæ¸…æ™°åœ°è¡¨ç¤ºåœºæ™¯ä¸­çš„äº‹ä»¶çš„åŒºåˆ«æ€§è¡¨å¾ã€‚å› æ­¤ï¼Œç”±äºé¢†åŸŸçš„é¸¿æ²Ÿï¼ˆdomain gap)ï¼Œè¿™äº›éª¨æ¶å¹¶ä¸åˆé€‚[1])ã€‚</p>
</li>
<li><p>å·²æœ‰çš„MIL-basedå¼±ç›‘ç£VADå—é™äºåº”å¯¹ <strong>å¼‚å¸¸è§†é¢‘ä¸­åŒ…å«ä»»æ„æ•°é‡çš„å¼‚å¸¸ç‰‡æ®µ</strong></p>
</li>
</ol>
<h3 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h3><ol>
<li><p>é’ˆå¯¹æ€§æå‡ºè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨CLIPè¿›è¡Œç‰¹å¾æå–ã€‚</p>
<p><strong>CLIPçš„ä¼˜åŠ¿</strong>åŠå…¶ä¸ºä»€ä¹ˆèƒ½å¤Ÿæœ‰æ•ˆï¼š</p>
<p>æœ€è¿‘ï¼ˆ21-23ï¼‰â€vision languageâ€å·¥ä½œçš„æˆåŠŸè¯æ˜äº†é€šè¿‡CLIPï¼ˆContrastive Language-Image Pre-traning)æ¡†æ¶å­¦ä¹ åˆ°çš„ç‰¹å¾è¡¨ç¤ºçš„æœ‰æ•ˆæ€§ã€‚</p>
<p>CLIPç”±ä¸¤ä¸ªç½‘ç»œç»„æˆï¼švision encoder å’Œ text encoder ï¼Œ åœ¨äº’è”ç½‘å…¬å¼€å¯ç”¨èµ„æºæ”¶é›†åˆ°çš„400 million text-image pairsä¸Šè®­ç»ƒã€‚ç»™å®šä¸€ç»„wordså’Œä¸€å¼ å›¾ç‰‡ï¼ŒCLIPå¯ä»¥è¯„ä¼°ä»–ä»¬ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨CLIPä½œä¸ºç‰¹å¾æå–å™¨ã€‚</p>
</li>
<li><p>æå‡ºtop-k function</p>
<p>å—differentiable top-k operator[2]çš„å¯å‘ï¼Œæå‡ºtop-k function, å®ƒå®šä½äº†è§†é¢‘ä¸­æ„Ÿå…´è¶£çš„Îºä¸ªç‰‡æ®µï¼Œå¹¶åœ¨ç›¸ä¼¼çš„MIL è®¾ç½®ä¸­é‡‡ç”¨ differentiable hard attentionï¼Œä»¥è¯æ˜å…¶å¯¹ä¼ ç»Ÿçš„ã€æµè¡Œçš„è®¾ç½®çš„æœ‰æ•ˆæ€§å’Œé€‚ç”¨æ€§ã€‚</p>
</li>
<li><p>å¼•å…¥Temporal Self-attentionæœºåˆ¶ï¼ˆTSAï¼‰</p>
<p>ç›®æ ‡æ˜¯é€šè¿‡è¡¡é‡ç‰‡æ®µçš„å¼‚å¸¸ç¨‹åº¦ç”Ÿæˆé‡æ–°èµ‹æƒçš„æ³¨æ„åŠ›ç‰¹å¾ï¼ˆreweighted attention feature)</p>
</li>
</ol>
<p>æå‡ºçš„CLIP-TSAé‡‡ç”¨MILæ¡†æ¶ï¼Œç”±ä¸‰ä¸ªç»„ä»¶æ„æˆï¼š</p>
<p>ï¼ˆ1ï¼‰ ä½¿ç”¨CLIPè¿›è¡Œçš„ç‰¹å¾ç¼–ç </p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨TSAæœºåˆ¶åœ¨æ—¶é—´ç»´åº¦ä¸Šè¿›è¡Œç‰‡æ®µä¸€è‡´æ€§å»ºæ¨¡</p>
<p>ï¼ˆ3ï¼‰ ä½¿ç”¨å·®å¼‚æœ€å¤§åŒ–è®­ç»ƒå™¨å®šä½å¼‚å¸¸ç‰‡æ®µ</p>
<p>ä¸‰ä¸ªè¯„ä¼°æ•°æ®é›†ï¼šUCF-Crime, ShanghaiTecå’ŒXD-Violence</p>
<h3 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h3><ul>
<li>æå‡ºé€‚ç”¨äºå¼±ç›‘ç£VADé—®é¢˜çš„Temporal Self-Attention(TSA)æœºåˆ¶ï¼Œå¹¶è·å¾—äº†è§†é¢‘ç‰‡æ®µçš„å¼‚å¸¸ä¼¼ç„¶æ€§å¾—åˆ†ã€‚</li>
<li>æˆ‘ä»¬è¿ç”¨CLIPï¼Œå®ƒä½¿ç”¨ViTä½œä¸ºè§†è§‰ç‰¹å¾çš„ä¸»å¹²ï¼Œå¼•å…¥äº†1)CLIPç‰¹å¾çš„æ–°ç”¨æ³•ï¼Œ2)åˆ†æç”±å¼‚å¸¸åŠ¨ä½œç»„æˆçš„è§†é¢‘ä¸­çš„æ–°å‹ä¸Šä¸‹æ–‡è¡¨ç¤º</li>
<li>ç»éªŒæ€§åœ°éªŒè¯äº†æˆ‘ä»¬æå‡ºæ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœè¡¨æ˜ï¼šæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œåœ¨ä»»ä½•ç±»å‹çš„ç›‘ç£è®¾ç½®ä¸‹ï¼Œå®ƒå®ç°äº†æ¯”ç›®å‰æ‰€æœ‰ä»¥UCF-Crimeå’ŒShanghaiTecæ•°æ®é›†ä¸ºåŸºå‡†çš„SOTAæ–¹æ³•æ›´ä¼˜çš„æ€§èƒ½ã€‚å¯¹äºXD-violenceæ•°æ®é›†ï¼Œä»–æ‰“è´¥äº†ä¸èåˆå£°éŸ³ç‰¹å¾è¿›è¡Œè®­ç»ƒçš„SOTA</li>
</ul>
<h2 id="Related-Work"><a href="#Related-Work" class="headerlink" title="Related Work"></a>Related Work</h2><ul>
<li>Unsupervised VAD</li>
<li>Weakly-supervised VAD</li>
<li>Vision-Language Pre-trained Models</li>
<li>Attention Mechanism</li>
</ul>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p>pipelineå¦‚ä¸‹ï¼š</p>
<p><img src="/posts/d3b330ab/Untitled.png" alt></p>
<p>ï¼ˆ1ï¼‰ ä½¿ç”¨CLIPè¿›è¡Œçš„ç‰¹å¾ç¼–ç </p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨TSAæœºåˆ¶åœ¨æ—¶é—´ç»´åº¦ä¸Šè¿›è¡Œç‰‡æ®µä¸€è‡´æ€§å»ºæ¨¡ï¼Œå¹¶ä¸‹é€‰å–å…³è”æœ€å¤šçš„top-kä¸ª</p>
<p>ï¼ˆ3ï¼‰ ä½¿ç”¨å·®å¼‚æœ€å¤§åŒ–è®­ç»ƒå™¨å®šä½å¼‚å¸¸ç‰‡æ®µ</p>
<h3 id="feature-embedding"><a href="#feature-embedding" class="headerlink" title="feature embedding"></a>feature embedding</h3><ul>
<li><p>choose the middle frame $I_i$ that represents each snippet $s_i$</p>
</li>
<li><p>encode frame $I_i$ with the pretrained Vision Transformer to extract visual feature $I_i^f$</p>
</li>
<li><p>then project feature $I_i^f$ onto the visual projection matrix L, which was pretrained by CLIP to obtain the image embedding $f_i = L*I_i^f$</p>
</li>
<li><p>thus got the embedding feature $F_k$  of video X, which consist of  snippets    </p>
<script type="math/tex; mode=display">X = \{s_i\}|^{T_k}_{i=1}</script></li>
<li><p>finally apply the video normalization</p>
</li>
</ul>
<h3 id="Temporal-Self-Attention-TSA"><a href="#Temporal-Self-Attention-TSA" class="headerlink" title="Temporal Self-Attention (TSA)"></a><strong>Temporal Self-Attention (TSA)</strong></h3><p>ç›®æ ‡ï¼šmodel the coherency between snippets of a video and select the top-k most relevant snippets</p>
<p>ç»„æˆï¼š (i) temporal scorer networkï¼š è·å–scoreå‘é‡ã€‚å°†featureå˜æˆscoreå‘é‡ï¼ˆ$R^{T\times 1}$) ï¼Œè®ºæ–‡é‡Œç½‘ç»œä¸ºä¸‰å±‚MLP</p>
<p>(ii) top-<em>Îº</em> score nominatorï¼šæå–Kä¸ªå…³è”æ€§æœ€å¤§çš„ç‰‡æ®µã€‚å…·ä½“è§å¦‚ä¸‹ç®—æ³•äºŒã€‚æœ‰å€ŸåŠ©é«˜æ–¯å™ªå£°ã€åŸºäºåˆ†æ•°å¹…åº¦è·å–top-kä¸ªã€one-hotç¼–ç ï¼ˆThrough the soft one-hot encoding mechanism, the higher amount of attention, or weight, is placed near and at the indices of top-<em>Îº</em> scoresï¼‰</p>
<p>(iii) fusion networkï¼š combine information</p>
<p>è¾“å…¥ï¼šå‰è¿°åŸºäºCLIPæå–åˆ°çš„ç‰¹å¾</p>
<p>è¾“å‡ºï¼šreweighted attention Feature</p>
<p><img src="/posts/d3b330ab/Untitled 1.png" alt></p>
<p><img src="/posts/d3b330ab/Untitled 2.png" alt></p>
<h3 id="Difference-Maximization-Trainer-Learning"><a href="#Difference-Maximization-Trainer-Learning" class="headerlink" title="Difference Maximization Trainer Learning"></a><strong>Difference Maximization Trainer Learning</strong></h3><p>mini batchè®­ç»ƒï¼Œè¾“å…¥åˆ†æˆ2*Bï¼ˆbatchsize)ï¼Œä¸€åŠä»normal bagsä¸­åŠ è½½ï¼Œä¸€åŠä»abnormal bagsä¸­åŠ è½½ã€‚</p>
<p>åœ¨TSAé˜¶æ®µä¹‹åï¼Œåˆ†åˆ«å¾—åˆ°ä¸¤éƒ¨åˆ†çš„reweighted attention featureã€‚</p>
<p>æ¥ç€ï¼Œå°†featureé€å…¥ä¸€ä¸ªå·ç§¯ç½‘ç»œæ¨¡å—Jï¼ŒJç”±dilated convolutionså’Œnon-local blockç»„æˆï¼Œä»¥æ­¤åŸºäºé‡æ–°åŠ æƒçš„å¤§å°æ¨¡æ‹Ÿç‰‡æ®µä¹‹é—´çš„é•¿æœŸå’ŒçŸ­æœŸå…³ç³»ã€‚</p>
<p>è¾“å‡ºçš„convoluted attention featuresæ¥ç€é€å…¥ä¸€ä¸ªæµ…å±‚çš„MIL-based score classifierï¼Œè¾“å‡ºçš„åˆ†æ•°å†³å®šç‰¹å¾ç‰‡æ®µçš„äºŒå…ƒå¼‚å¸¸çŠ¶æ€ã€‚</p>
<ul>
<li><p>æ¯ä¸ªconvoluted attention featuresæ‰§è¡Œ Difference Maximization Trainer (DMT)</p>
<p>åŸºäºç‰¹å¾å¹…åº¦é€‰å–top-aä¸ªç‰¹å¾ï¼Œå®šä¹‰losså°†å¼‚å¸¸ç‰‡æ®µæ˜æ˜¾åŒºåˆ†äºæ­£å¸¸ç‰‡æ®µï¼Œå…·ä½“è¿‡ç¨‹ä¸<a href="https://arxiv.org/pdf/2101.10030.pdf">RTFM</a>è®ºæ–‡çš„ç±»ä¼¼ã€‚</p>
</li>
</ul>
<h3 id="Infer"><a href="#Infer" class="headerlink" title="Infer"></a>Infer</h3><p>æµ‹è¯•é˜¶æ®µä¸æ‰§è¡Œnormlizationã€‚</p>
<p>åˆ†ç±»å™¨æœ€åå¾—åˆ°çš„ä¸€ç»„åˆ†æ•°Uï¼Œæ¯ä¸ªåˆ†æ•°$u_i$è¡¨ç¤ºå¯¹åº”indexçš„å¼‚å¸¸ç›¸ä¼¼åº¦ï¼Œå€¼ä¸º0-1ä¹‹é—´ã€‚$u_i$è¢«å››èˆäº”å…¥å–å¾—äºŒå…ƒåˆ†æ•°ï¼Œ1ä»£è¡¨å¼‚å¸¸ï¼Œ0ä»£è¡¨æ­£å¸¸ã€‚</p>
<p>èƒ½å¤Ÿè¿›è¡Œå¸§çº§åˆ«çš„æµ‹è¯•ï¼šç‰‡æ®µçš„scoreï¼ˆå¯¹åº”ç‰‡æ®µçº§ç»“æœï¼‰ä¿ç•™åŸå§‹é¡ºåºï¼Œrepeat $\delta$æ¬¡ã€‚</p>
<h2 id="Experimental-Results"><a href="#Experimental-Results" class="headerlink" title="Experimental Results"></a><strong>Experimental Results</strong></h2><p>æ•°æ®é›†ï¼š<strong>UCF-Crime Datasetã€ShanghaiTech Campus Datasetã€XD-Violence Dataset</strong></p>
<p>æŒ‡æ ‡ï¼šAUC@ROCï¼ˆ<strong>UCF-Crimeã€ShanghaiTechï¼‰</strong>ã€AUC@PRï¼ˆ<strong>XD-Violenceï¼‰</strong></p>
<h3 id="Performance-Comparison"><a href="#Performance-Comparison" class="headerlink" title="Performance Comparison"></a><strong>Performance Comparison</strong></h3><p><img src="/posts/d3b330ab/Untitled 3.png" style="zoom:80%;"></p>
<p><img src="/posts/d3b330ab/Untitled 4.png" style="zoom: 80%;"></p>
<p><img src="/posts/d3b330ab/Untitled 5.png" style="zoom:80%;"></p>
<h3 id="Ablation-Study"><a href="#Ablation-Study" class="headerlink" title="Ablation Study"></a><strong>Ablation Study</strong></h3><ul>
<li>TSAæœºåˆ¶çš„æœ‰æ•ˆæ€§ï¼š</li>
</ul>
<p><img src="/posts/d3b330ab/Untitled 6.png" style="zoom:80%;"></p>
<ul>
<li>Kçš„å‚æ•°é€‰æ‹©</li>
</ul>
<p>å…¶ä¸­ï¼Œåˆ†æçš„æ˜¯è¶…å‚r</p>
<p><img src="/posts/d3b330ab/Untitled 7.png" alt style="zoom: 80%;"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>UCF-Crime</th>
<th>ShanghaiTec</th>
<th>XD-violence</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.7</td>
<td>[0.3,0.7]</td>
<td>0.9</td>
</tr>
</tbody>
</table>
</div>
<p>ä½œè€…é€šè¿‡åˆ†ææ•°æ®åˆ†å¸ƒï¼Œæ¥è§£é‡Šæœ€ä¼˜rå€¼åœ¨ä¸åŒæ•°æ®é›†ä¹‹é—´ä¸åŒçš„åŸå› ï¼š</p>
<p>ä¿¡æ¯ï¼š1ï¼‰data distribution of UCF-Crime (1,900 videos with 13 types of anomalies), ShanghaiTech Campus (317,398 videos with 130 anomaly events), and XD-Violence (4,754 videos with 6 types of anomalies) datasets</p>
<p>2ï¼‰frame-level <strong><em>anomaly-to-all ratio</em></strong> of their test sets, which are 0.1819, 0.4247, and 0.4977,</p>
<p><img src="/posts/d3b330ab/Untitled 8.png" alt></p>
<p>åŸºäºä¿¡æ¯ç»™åˆ°çš„åˆ†æï¼š</p>
<p>ShanghaiTecæ˜¯ä¸€ä¸ªå…·æœ‰è¾ƒå¤šå¼‚å¸¸äº‹ä»¶çš„å¤§å°ºåº¦æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬å‡è®¾è¯¥æ¨¡å‹å…·æœ‰è¶³å¤Ÿçš„æ³›åŒ–æ€§ï¼Œå› æ­¤ï¼Œå€¼è®¾ä¸º[0.3,0.7]åœ¨<strong><em>anomaly-to-all ratio</em></strong>  é™„è¿‘ã€‚</p>
<p>è€ŒUCF-Crimeå’ŒXD-Violenceå…·æœ‰ä¸å¹³è¡¡çš„ç±»åˆ†å¸ƒã€‚æ­¤å¤–ï¼Œåšè‰¯å¥½åˆ¤åˆ«çš„å†³ç­–æ‰€ä¾èµ–çš„é‡è¦ç‰¹å¾ï¼Œä¸ä»…é™äºå¼‚å¸¸ç‰‡æ®µï¼Œä¹ŸåŒ…æ‹¬äº†ä¸€äº›æ­£å¸¸ç‰‡æ®µï¼Œç‰¹åˆ«æ˜¯ä½œä¸ºæŸå¤±è®¡ç®—çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­å¼‚å¸¸topç‰‡æ®µå’Œæ­£å¸¸ç‰‡æ®µçš„å¹…åº¦éƒ½è¢«è€ƒè™‘åœ¨å†…ã€‚å› æ­¤ï¼Œè¿™ä¸¤ä¸ªæ•°æ®é›†çš„æœ€å¥½rä¸åˆ†å¸ƒåœ¨<strong><em>anomaly-to-all ratio</em></strong>é™„è¿‘ã€‚</p>
<p><img src="/posts/d3b330ab/Untitled 9.png" style="zoom:80%;"></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>æœ¬æ–‡æå‡ºäº†ä¸€ç§æœ‰æ•ˆçš„ç«¯åˆ°ç«¯å¼±ç›‘ç£VADæ¡†æ¶CLIP-TSAã€‚å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„TSAæœºåˆ¶ï¼Œå®ƒå¯ä»¥åœ¨æœ€å°é™åº¦çš„æƒ…å†µä¸‹æœ€å¤§åŒ–å¯¹ç‰¹å¾å­é›†çš„æ³¨æ„åŠ›å…³æ³¨å™ªå£°ï¼Œå¹¶æ˜¾ç¤ºäº†å…¶å¯¹å¼±ç›‘ç£VADé—®é¢˜çš„é€‚ç”¨æ€§ã€‚æˆ‘ä»¬è¿˜å°†TSAåº”ç”¨äºclipæå–çš„ç‰¹å¾ï¼Œä»¥è¯æ˜å…¶å¯¹è§†è§‰è¯­è¨€ç‰¹å¾çš„æœ‰æ•ˆæ€§ï¼Œå¹¶åœ¨å¼±ç›‘ç£çš„VADé—®é¢˜ä¸­åˆ©ç”¨è§†è§‰è¯­è¨€ç‰¹å¾ã€‚é€šè¿‡å°†æˆ‘ä»¬çš„æ•°æ®é›†ä¸sotaè¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬è¿˜é€šè¿‡ç»éªŒéªŒè¯äº†æˆ‘ä»¬çš„æ¨¡å‹åœ¨VADçš„ä¸‰ä¸ªæµè¡Œæ•°æ®é›†ä¸Šçš„å“è¶Šæ€§ã€‚</p>
<p>æœªæ¥çš„ç ”ç©¶å¯èƒ½ç€çœ¼äºæ›´å¥½çš„æŠ€æœ¯ï¼Œä»¥ç»“åˆæ—¶é—´å’Œç©ºé—´ä¿¡æ¯ï¼Œå¹¶ä»¥è¾ƒå°‘çš„æ³¨é‡Šå¤„ç†ä¸å¹³è¡¡çš„æ•°æ®ã€‚</p>
<p>åƒ Li ç­‰äºº (2022)[3]è¿™æ ·çš„æ³¨æ„åŠ›æŠ€æœ¯ å’Œè‡ªç›‘ç£å­¦ä¹  (Caron ç­‰äºº, 2021; Chen ç­‰äºº, 2020a) ä¹Ÿæ˜¯æé«˜æ€§èƒ½çš„æ½œåœ¨æ‰©å±•ã€‚</p>
<p>å¼•ç”¨ï¼š</p>
<p>[1] Kun Liu and Huadong Ma. Exploring background-bias for anomaly detection in surveillance videos. In <em>Proceedings of the 27th ACM International Conference on Multimedia</em>, pp. 1490â€“1499, 2019.</p>
<p>[2] Jean-Baptiste Cordonnier, Aravindh Mahendran, Alexey Dosovitskiy, Dirk Weissenborn, Jakob Uszkoreit, and Thomas Unterthiner. Differentiable patch selection for image recognition. In <em>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, pp. 2351â€“2360, June 2021.</p>
<p>[3] Yehao Li, Ting Yao, Yingwei Pan, and Tao Mei. Contextual transformer networks for visual recognition. <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2022.</p>
]]></content>
      <categories>
        <category>è®ºæ–‡é˜…è¯»</category>
      </categories>
      <tags>
        <tag>å¼±ç›‘ç£å­¦ä¹ </tag>
        <tag>VAD</tag>
      </tags>
  </entry>
  <entry>
    <title>How Attentive are Graph Attention Networks</title>
    <url>/posts/82187def/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><a href="https://arxiv.org/pdf/2105.14491.pdf">paperåœ°å€</a> (ICLR2022)</p>
<p><a href="https://openreview.net/forum?id=F72ximsx7C1">How Attentive are Graph Attention Networks? openreview</a></p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><span id="more"></span>
<p>GATï¼š</p>
<ul>
<li><p>åœ¨GATä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å…³æ³¨å®ƒçš„é‚»å±…ï¼Œå¹¶å°†è‡ªå·±çš„representationä½œä¸ºqueryã€‚</p>
</li>
<li><p>limitation:</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è¯æ˜äº†GATè®¡ç®—çš„æ˜¯ä¸€ç§éå¸¸æœ‰é™çš„attention: attention scoresçš„æ’åºåœ¨query nodeä¸Šæ˜¯æ— æ¡ä»¶çš„ã€‚ï¼ˆå³ï¼Œæ³¨æ„åŠ›åˆ†æ•°çš„æ’åºä¸å› query nodeè€Œå¼‚ï¼‰</p>
<ul>
<li><p>å°†ä¸Šè¿°çš„è¿™ç§æœ‰é™çš„æ³¨æ„åŠ›å®šä¹‰ä¸ºé™æ€æ³¨æ„åŠ›ï¼ˆ<strong><em>static attention</em></strong>)ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºæ›´ä¸°å¯Œçš„åŠ¨æ€æ³¨æ„åŠ›ç›¸åŒºåˆ†ã€‚</p>
</li>
<li><p>ç”±äºGATä½¿ç”¨çš„æ˜¯é™æ€æ³¨æ„åŠ›ï¼Œå› æ­¤å­˜åœ¨ä¸€äº›ä»–ä¸èƒ½è¡¨è¾¾çš„ç®€å•å›¾é—®é¢˜ï¼š</p>
<p>åœ¨ä¸€ä¸ªå—æ§çš„é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¡¨æ˜é™æ€æ³¨æ„åŠ›ç”šè‡³é˜»ç¢GATä¸è®­ç»ƒæ•°æ®æ‹Ÿåˆã€‚ï¼ˆè§4.1èŠ‚ï¼‰</p>
</li>
</ul>
</li>
</ul>
<p>æå‡ºGATv2ï¼š</p>
<ul>
<li>ä¸ºäº†è§£å†³ä¸Šè¿°å±€é™æ€§ï¼Œæˆ‘ä»¬é€šè¿‡ä¿®æ”¹æ“ä½œé¡ºåºï¼Œå¼•å…¥äº†ä¸€ä¸ªç®€å•çš„ä¿®å¤åŠæ³•ï¼Œå¹¶æå‡ºäº†GATv2ï¼šä¸€ç§ä¸¥æ ¼æ¥è¯´æ¯”GATæ›´å¯Œè¡¨è¾¾åŠ›çš„å˜ä½“ã€‚</li>
<li>è¿›è¡Œäº†å¹¿æ³›çš„è¯„ä¼°ï¼Œå¹¶è¡¨æ˜GATv2åœ¨12ä¸ªOGBå’Œå…¶ä»–åŸºå‡†æµ‹è¯•ä¸Šä¼˜äºGATï¼ŒåŒæ—¶æˆ‘ä»¬åŒ¹é…äº†å®ƒä»¬çš„å‚æ•°æˆæœ¬ã€‚</li>
<li>ä»£ç ï¼š<a href="https://github.com/tech-srl/how_attentive_are_gatsï¼›GATv2ä½œä¸ºPyTorch">https://github.com/tech-srl/how_attentive_are_gatsï¼›GATv2ä½œä¸ºPyTorch</a> Geometric libraryï¼Œthe Deep Graph Library and the TensorFlow GNN libraryçš„ä¸€éƒ¨åˆ†å¯ç”¨ã€‚</li>
</ul>
<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><ul>
<li>Velickovi Ë‡ c et al. (2018) æå‡ºGATã€‚</li>
</ul>
<p>åœ¨GATä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç”¨å®ƒè‡ªå·±çš„è¡¨ç¤ºä½œä¸ºqueryæ¥å…³æ³¨/å¤„ç†ï¼ˆattend to)å…¶é‚»å±…ä»¥æ›´æ–°è‡ªå·±çš„è¡¨ç¤ºã€‚</p>
<p>è¿™æ³›åŒ–äº†æ ‡å‡†çš„å¹³å‡æˆ–æœ€å¤§æ± åŒ–é‚»å±…ï¼ˆKipfå’ŒWellingï¼Œ2017; Hamiltonç­‰ï¼Œ2017ï¼‰â†’ é€šè¿‡å…è®¸æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—å…¶é‚»å±…çš„åŠ æƒå¹³å‡å€¼ï¼Œå¹¶ï¼ˆsoftlyï¼‰é€‰æ‹©å…¶æœ€ç›¸å…³çš„é‚»å±…ã€‚</p>
<p>Velickovi Ë‡ c et al.ä¹Ÿå°†transformerçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ä»åºåˆ—æ³›åŒ–åˆ°å›¾ã€‚</p>
<ul>
<li><p>GATæ‰§è¡Œä¸€ç§é™æ€æ³¨æ„åŠ›</p>
<p>å¯¹äºä»»ä½•æŸ¥è¯¢èŠ‚ç‚¹ï¼Œæ³¨æ„å‡½æ•°ç›¸å¯¹äºé‚»å±…ï¼ˆkeyï¼‰åˆ†æ•°æ˜¯å•è°ƒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æ³¨æ„ç³»æ•°çš„æ’åºï¼ˆç›®æ ‡æ’åºï¼‰åœ¨å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šå…±äº«ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢èŠ‚ç‚¹ä¸Šä¸å—å½±å“ï¼ˆå³ä¸å› æŸ¥è¯¢èŠ‚ç‚¹è€Œå¼‚ï¼‰ã€‚</strong></p>
<p>è¯¥äº‹å®æŸä¼¤äº†GATçš„è¡¨ç°åŠ›ã€‚</p>
</li>
</ul>
<h3 id="é™æ€æ³¨æ„åŠ›"><a href="#é™æ€æ³¨æ„åŠ›" class="headerlink" title="é™æ€æ³¨æ„åŠ›"></a>é™æ€æ³¨æ„åŠ›</h3><p>é™æ€æ³¨æ„åŠ›ï¼šå¯¹äºä»»ä½• query nodesï¼Œæ³¨æ„å‡½æ•°ç›¸å¯¹äºé‚»åŸŸï¼ˆkeyï¼‰åˆ†æ•°æ˜¯å•è°ƒçš„ã€‚å³ï¼šæ³¨æ„ç³»æ•°çš„æ’åºåœ¨å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šå…±äº«ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢èŠ‚ç‚¹ä¸Šä¸å—æ¡ä»¶çš„å½±å“ã€‚å¦‚ Figure1 æ‰€ç¤ºï¼š</p>
<p><img src="/posts/82187def/Untitled.png" style="zoom:90%;"></p>
<p>ç”±ä¸Šé¢å›¾å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€å¹…å›¾å°±æ˜¯é™æ€æ³¨æ„åŠ›ï¼Œç¬¬äºŒå¹…å›¾æ˜¯åŠ¨æ€æ³¨æ„åŠ›ã€‚</p>
<p>ç¬¬ä¸€å¹…å›¾ä¸­æ¯ä¸ªæŸ¥è¯¢èŠ‚ç‚¹qå¯¹ã€k0,k1â€¦k9ã€‘è®¡ç®—æ³¨æ„åŠ›ç³»æ•°æ—¶ï¼Œéƒ½æ˜¯k8çš„æ³¨æ„åŠ›åˆ†æ•°æœ€å¤§ï¼Œä¹Ÿå°±æ˜¯æ— è®ºqæ˜¯ä»€ä¹ˆï¼Œk8çš„è´¡çŒ®éƒ½æ˜¯ç›¸å¯¹æœ€å¤§çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…æå‡ºäº†GATv2æ¥ä½¿ç”¨åŠ¨æ€æ³¨æ„åŠ›ï¼Œå¦‚ç¬¬äºŒå¹…å›¾ï¼Œæ¯ä¸ªqueryæœ‰å¯¹äºæ‰€æœ‰keyä¸åŒçš„attentionç³»æ•°çš„æ’åº</p>
<h2 id="2-PRELIMINARIES"><a href="#2-PRELIMINARIES" class="headerlink" title="2. PRELIMINARIES"></a>2. PRELIMINARIES</h2><ul>
<li><p>GNN</p>
<script type="math/tex; mode=display">
h'_i = f_Î¸ (h_i, AGGREGATE ({h_j | j âˆˆ N_i}))</script></li>
<li><p>GAT</p>
<p>A scoring function <em>e</em> å¯¹äºæ¯ä¸€ä¸ªè¾¹ ï¼ˆj,i) è®¡ç®—socreï¼Œè¡¨ç¤ºé‚»å±…jçš„ç‰¹å¾å¯¹èŠ‚ç‚¹içš„é‡è¦æ€§ï¼š</p>
<script type="math/tex; mode=display">
e (h_i, h_j ) = LeakyReLU(a^T Â· [W h_i||W h_j ])  \quad\quad(2)</script><p>$a âˆˆ R^{2dâ€™} , W âˆˆ R^{dâ€™Ã—d}$ï¼Œä¸ºå¯å­¦ä¹ å‚æ•°ã€‚||è¡¨ç¤ºconcatenationã€‚è¿™äº›æ³¨æ„åŠ›åˆ†æ•°åœ¨æ‰€æœ‰é‚»å±…$j\in N_i$ä¹‹é—´ä½¿ç”¨softmax normalizedï¼Œå®šä¹‰å¾—åˆ°æ³¨æ„åŠ›å‡½æ•°ä¸ºï¼š</p>
<script type="math/tex; mode=display">
Î±_{ij} = softmax_j (e (h_i, h_j )) = \frac{exp (e (h_i, h_j ))
}{\sum _{j'âˆˆN_i}exp (e (h_i, h_j' ))}\quad\quad (3)</script><p>ç„¶åï¼ŒGATä½¿ç”¨å½’ä¸€åŒ–æ³¨æ„ç³»æ•°è®¡ç®—ç›¸é‚»èŠ‚ç‚¹çš„è½¬æ¢ç‰¹å¾ï¼ˆæ¥ç€ç”¨ä¸€ä¸ªéçº¿æ€§Ïƒï¼‰çš„åŠ æƒå¹³å‡å€¼ï¼Œä½œä¸ºiçš„æ–°è¡¨ç¤ºï¼š</p>
<script type="math/tex; mode=display">
h_i' = Ïƒ (\sum _{jâˆˆN_i} Î±_{ij} Â· W h_j) \quad\quad (4)</script></li>
</ul>
<h2 id="3-THE-EXPRESSIVE-POWER-OF-GRAPH-ATTENTION-MECHANISMS"><a href="#3-THE-EXPRESSIVE-POWER-OF-GRAPH-ATTENTION-MECHANISMS" class="headerlink" title="3. THE EXPRESSIVE POWER OF GRAPH ATTENTION MECHANISMS"></a>3. THE EXPRESSIVE POWER OF GRAPH ATTENTION MECHANISMS</h2><h3 id="3-1-THE-IMPORTANCE-OF-DYNAMIC-WEIGHTING"><a href="#3-1-THE-IMPORTANCE-OF-DYNAMIC-WEIGHTING" class="headerlink" title="3.1 THE IMPORTANCE OF DYNAMIC WEIGHTING"></a>3.1 THE IMPORTANCE OF DYNAMIC WEIGHTING</h3><p>å›ç­”Qï¼šä¸ºä»€ä¹ˆä¸æ˜¯åŠ¨æ€ä¼šé™åˆ¶attentionå‘¢ï¼Ÿ</p>
<ul>
<li><p>Attention</p>
<p>Attention: Attentionæ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒç»™å®šä¸€ä¸ªé¢å¤–çš„æŸ¥è¯¢å‘é‡ï¼ˆquery vector)æ¥è®¡ç®—ä¸€ç»„è¾“å…¥keyå‘é‡çš„åˆ†å¸ƒã€‚</p>
<p>å¦‚æœattentionå‡½æ•°æ€»æ˜¯å°†ä¸€ä¸ªkeyçš„æƒé‡è®¡ç®—çš„è‡³å°‘ä¸å…¶ä»–ä»»ä½•keyä¸€æ ·å¤§ï¼Œè€Œä¸queryæ— å…³ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°ä»–ä¸º<strong>static attention</strong>ï¼ˆå³ä¸ç®¡queryæ˜¯ä»€ä¹ˆï¼Œè®¡ç®—çš„ä¸€ç»„keyé‡Œé¢ï¼Œæœ€å¤§çš„ï¼ˆä¸å°äºå…¶ä»–key) é‚£ä¸ªæ˜¯å®šæ­»çš„ï¼‰</p>
</li>
<li><p><strong>Definition 3.1</strong> ï¼ˆ<strong>static attention</strong>)</p>
<p>A (possibly infinite) family of scoring functions <em>F âŠ† (</em>R<em>d Ã—</em> R<em>d â†’</em> R) computes <em>static scoring</em> for a given set of key vectors <script type="math/tex">K=\{k_1, ...,k_n\} âŠ‚R^d</script> and query vectors <script type="math/tex">Q =\{q_1, ..., q_m\} âŠ‚R^d</script>, if for every <script type="math/tex">f \in F</script> there exists a â€œhighest scoringâ€ key <script type="math/tex">j_fâˆˆ [n]</script> such that for every query iâˆˆ[m] and key jâˆˆ [n] it holds that <script type="math/tex">f(q_i,k_{j_f})\ge f(q_i,k_j)</script>. We say that a family of attention functions computes <em>static attention</em> given K and Q , if its scoring function computes static scoring, possibly followed by monotonic normalization such as softmax.</p>
</li>
<li><p>é™æ€æ³¨æ„åŠ›éå¸¸æœ‰é™</p>
<p>é™æ€æ³¨æ„éå¸¸æœ‰é™ï¼Œå› ä¸ºæ— è®ºæŸ¥è¯¢å¦‚ä½•ï¼Œæ¯ä¸ªå‡½æ•°$f\in F$éƒ½æœ‰ä¸€ä¸ªæ€»æ˜¯é€‰ä¸­çš„keyã€‚è¿™äº›å‡½æ•°ä¸èƒ½æ¨¡æ‹Ÿä¸åŒkeyå¯¹ä¸åŒqueryæœ‰ä¸åŒå…³è”çš„æƒ…å†µã€‚</p>
</li>
<li><p><strong>Defifinition 3.2</strong> (<strong>Dynamic attention</strong>)</p>
<p>A (possibly infifinite) family of scoring functions <em>F âŠ† (</em>R<em>d Ã—</em> R<em>d â†’</em> R) computes <em>dynamic attention</em> for a given set  of key vectors <script type="math/tex">K=\{k_1, ...,k_n\} âŠ‚R^d</script> and <script type="math/tex">Q =\{q_1, ..., q_m\} âŠ‚R^d</script>,  if for any mapping $\phi: [m] â†’ [n]$ , there exists $f \in F$ such that for any query <script type="math/tex">i\in [m]</script> and any key <script type="math/tex">j _{\neq \phi(i)} \in [n]</script>: <script type="math/tex">f(q_i, k_Ï•(i)) > f(q_i, k_j)</script>. We say that a family of attention functions computes <em>dynamic attention</em> for K and Q, if its scoring function computes dynamic scoring, possibly followed by monotonic normalization such as softmax.</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ¨æ€æ³¨æ„å¯ä»¥é€šè¿‡æŸ¥è¯¢ié€‰æ‹©æ¯ä¸ªé”®Ï•(i)ï¼Œä½¿<script type="math/tex">f(q_i, k_Ï•(i))</script>åœ¨<script type="math/tex">\{fï¼ˆq_iï¼Œk_jï¼‰| jâˆˆ[n])\}</script>ä¸­æœ€å¤§ã€‚è¯·æ³¨æ„ï¼ŒåŠ¨æ€æ³¨æ„å’Œé™æ€æ³¨æ„éƒ½æ˜¯æ’ä»–æ€§çš„å±æ€§ï¼Œä½†å®ƒä»¬å¹¶ä¸æ˜¯äº’è¡¥çš„ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªåŠ¨æ€æ³¨æ„æ—å¯¹äºç›¸åŒçš„Kå’ŒQéƒ½æœ‰ä¸¥æ ¼çš„é™æ€æ³¨æ„æ—å­é›†ã€‚</p>
</li>
<li><p><strong>Attending by decaying</strong></p>
<p>å¦ä¸€ç§æ€è€ƒæ³¨æ„åŠ›çš„æ–¹å¼æ˜¯â€œfocusâ€äºæœ€ç›¸å…³çš„è¾“å…¥çš„èƒ½åŠ›ã€‚Focusingåªèƒ½é€šè¿‡è¡°å‡å…¶ä»–è¾“å…¥ï¼Œå³ï¼Œç»™å‡ºè¿™äº›è¾“å…¥è¡°å‡çš„è¾“å…¥å€¼çš„åˆ†æ•°ä½äºå…¶ä»–è¾“å…¥å€¼ã€‚å¦‚æœä¸€ä¸ªé”®çš„æ³¨æ„åŠ›å¾—åˆ†æ€»æ˜¯æ¯”å…¶ä»–é”®ç›¸åŒæˆ–æ›´é«˜ï¼ˆå¦‚é™æ€æ³¨æ„ï¼‰ï¼Œé‚£ä¹ˆä»»ä½•æŸ¥è¯¢éƒ½ä¸èƒ½å¿½ç•¥è¿™ä¸ªé”®æˆ–è¡°å‡è¿™ä¸ªé”®çš„score.</p>
</li>
</ul>
<h3 id="3-2-THE-LIMITED-EXPRESSIVITY-OF-GAT"><a href="#3-2-THE-LIMITED-EXPRESSIVITY-OF-GAT" class="headerlink" title="3.2 THE LIMITED EXPRESSIVITY OF GAT"></a>3.2 THE LIMITED EXPRESSIVITY OF GAT</h3><p><strong>Theorem 1.</strong> <em>A GAT layer computes only static attention, for any set of node representations $K = Q = {h_1, â€¦, h_n}$. In particular, for n &gt;</em> 1<em>, a GAT layer does not compute dynamic attention.</em></p>
<p>è¯æ˜ï¼š</p>
<p><img src="/posts/82187def/Untitled 1.png" alt></p>
<p>å®šç†1çš„ç»“æœæ˜¯ï¼Œå¯¹äºä»»ä½•ä¸€ç»„èŠ‚ç‚¹Vå’Œè®­ç»ƒçš„GATå±‚ï¼Œæ³¨æ„å‡½æ•°Î±å®šä¹‰äº†ä¸€ä¸ªèŠ‚ç‚¹çš„constant rankingï¼ˆargsortï¼‰ï¼Œæ— è®ºæŸ¥è¯¢èŠ‚ç‚¹iæ˜¯å“ªä¸ªã€‚å³ï¼Œå­˜åœ¨$s_j = a_2^T W h_j$, æˆ‘ä»¬å¯ä»¥å¯¹äºä»»æ„é€‰æ‹©çš„$h_i$, å¾—åˆ°Î±ç›¸å¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„åˆ†æ•°${sj | jâˆˆV}$æ˜¯å•è°ƒçš„ã€‚è¿™ç§å…¨å±€æ’åºå¼•å‡ºäº†æ¯ä¸ªé‚»å±…ç¾¤Niçš„å±€éƒ¨æ’åºã€‚ hiçš„å”¯ä¸€å½±å“æ˜¯åœ¨æ‰€äº§ç”Ÿçš„æ³¨æ„åŠ›åˆ†å¸ƒçš„â€œé”åº¦â€ä¸Šã€‚è¿™åœ¨å›¾1aï¼ˆåº•éƒ¨ï¼‰ä¸­å¾—åˆ°äº†æ¼”ç¤ºï¼Œå…¶ä¸­ä¸åŒçš„æ›²çº¿è¡¨ç¤ºä¸åŒçš„æŸ¥è¯¢ï¼ˆhiï¼‰ã€‚</p>
<p><strong>Generalization to multi-head attention</strong></p>
<p>å¯¹äºå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œtheorem1åŒæ ·é€‚ç”¨äºæ¯ä¸€ä¸ªå¤´ï¼Œå¾—åˆ°çš„è¾“å‡ºæ˜¯é™æ€æ³¨æ„åŠ›å¤´çš„æ‹¼æ¥ã€‚</p>
<h3 id="3-3-BUILDING-DYNAMIC-GRAPH-ATTENTION-NETWORKS"><a href="#3-3-BUILDING-DYNAMIC-GRAPH-ATTENTION-NETWORKS" class="headerlink" title="3.3 BUILDING DYNAMIC GRAPH ATTENTION NETWORKS"></a>3.3 BUILDING DYNAMIC GRAPH ATTENTION NETWORKS</h3><p>standard GAT è¯„åˆ†å‡½æ•°ï¼ˆEq.2ï¼‰çš„ä¸»è¦é—®é¢˜æ˜¯å­¦ä¹ åˆ°çš„Wå’Œaæ˜¯è¿ç»­åº”ç”¨çš„ï¼Œå› æ­¤å¯ä»¥åˆ†è§£æˆä¸€ä¸ªå•ä¸€çš„çº¿æ€§å±‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬ç®€å•åœ°åœ¨éçº¿æ€§(LeakyReLU)ä¹‹ååº”ç”¨a layerï¼Œåœ¨æ‹¼æ¥ä¹‹ååº”ç”¨W layerï¼Œæœ‰æ•ˆåœ°åº”ç”¨ä¸€ä¸ªMLPæ¥è®¡ç®—æ¯ä¸ªquery-keyå¯¹çš„åˆ†æ•°ï¼š</p>
<script type="math/tex; mode=display">
GAT: \quad e (h_i, h_j ) = LeakyReLU(a^T Â· [W h_i||W h_j ]) \quad (6)</script><script type="math/tex; mode=display">
GATv2 (our\ fixed\ version):\quad e (h_i, h_j ) = a^T LeakyReLU( W Â· [ h_i||h_j ]) \quad (7)</script><p>ç®€å•çš„ä¿®æ”¹å¯¹æ³¨æ„åŠŸèƒ½çš„è¡¨è¾¾æ€§æœ‰æ˜¾è‘—çš„å½±å“ï¼š</p>
<p><strong>Theorem 2.</strong> <em>A GATv2 layer computes dynamic attention for any set of node representations  $K = Q = {h_1, â€¦, h_n}$.</em></p>
<p>è¯æ˜è§é™„å½•Aã€‚ä¸»è¦æ€æƒ³æ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé€‚å½“çš„å‡½æ•°ï¼ŒGATv2å°†æ˜¯ä¸€ä¸ªé€šç”¨è¿‘ä¼¼å™¨ï¼ˆCybenkoï¼Œ1989ï¼›Hornikï¼Œ1991ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒGATï¼ˆå¼ï¼ˆ52ï¼‰)ä¸èƒ½è¿‘ä¼¼ä»»ä½•è¿™æ ·çš„æœŸæœ›çš„å‡½æ•°ï¼ˆå®šç†1ï¼‰ã€‚</p>
<p><strong>Complexity</strong></p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦</li>
</ul>
<p>both: $O (|V|ddâ€™ + |E|dâ€™)$ï¼Œå¯ä»¥é€šè¿‡åˆå¹¶çº¿æ€§å±‚å‡å°‘ã€‚</p>
<ul>
<li>å‚æ•°å¤æ‚åº¦ï¼š</li>
</ul>
<p><img src="/posts/82187def/Untitled 2.png" alt></p>
<h2 id="4-EVALUATION"><a href="#4-EVALUATION" class="headerlink" title="4. EVALUATION"></a>4. EVALUATION</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„åˆæˆé—®é¢˜ï¼ˆsynthetic problemï¼‰æ¥è¯æ˜GATçš„å¼±ç‚¹ï¼Œ<strong>å³GATç”šè‡³ä¸èƒ½æ‹Ÿåˆï¼ˆç”šè‡³ä¸èƒ½è¾¾åˆ°è¾ƒé«˜çš„è®­ç»ƒç²¾åº¦ï¼‰</strong>ï¼Œä½†å¾ˆå®¹æ˜“é€šè¿‡GATv2æ¥è§£å†³ï¼ˆç¬¬4.1èŠ‚ï¼‰ã€‚</p>
<p>ç¬¬äºŒï¼Œæˆ‘ä»¬è¯æ˜GATv2å¯¹è¾¹ç¼˜å™ªå£°æ›´é²æ£’ï¼Œå› ä¸ºå®ƒçš„åŠ¨æ€æ³¨æ„æœºåˆ¶å…è®¸å®ƒè¡°å‡å™ªå£°ï¼ˆå‡ï¼‰è¾¹ç¼˜ï¼Œè€ŒGATçš„æ€§èƒ½éšç€å™ªå£°çš„å¢åŠ è€Œä¸¥é‡é™ä½(ç¬¬4.2èŠ‚)ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬åœ¨12ä¸ªåŸºå‡†æµ‹è¯•ä¸­æ¯”è¾ƒäº†GATå’ŒGATv2ã€‚ï¼ˆç¬¬4.3è‡³4.6èŠ‚å’Œé™„å½•D.3)ã€‚æˆ‘ä»¬å‘ç°åœ¨æ‰€æœ‰æµ‹è¯•GATçš„åŸºå‡†æµ‹è¯•ä¸­éƒ½ä¸å¦‚GATv2ã€‚</p>
<h3 id="4-1-SYNTHETIC-BENCHMARK-DICTIONARYLOOKUP"><a href="#4-1-SYNTHETIC-BENCHMARK-DICTIONARYLOOKUP" class="headerlink" title="4.1 SYNTHETIC BENCHMARK: DICTIONARYLOOKUP"></a>4.1 SYNTHETIC BENCHMARK: DICTIONARYLOOKUP</h3><p>æ¡å½¢ç é¢„æµ‹é—®é¢˜</p>
<p><img src="/posts/82187def/Untitled 3.png" alt></p>
<p>è™½ç„¶è¿™æ˜¯ä¸€ä¸ªäººä¸ºçš„é—®é¢˜ï¼Œä½†å®ƒä¸å…·æœ‰å…±äº«å¤šä¸ªæŸ¥è¯¢çš„é”®çš„ä»»ä½•å­å›¾ç›¸å…³ï¼Œå¹¶ä¸”æ¯ä¸ªæŸ¥è¯¢éƒ½éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¿™äº›é”®ã€‚è¿™æ ·çš„å­å›¾åœ¨ç°å®ä¸–ç•Œçš„å„ç§é¢†åŸŸå¾ˆå¸¸è§ã€‚</p>
<p><strong>Result</strong></p>
<p>å¦‚ä¸Šå³å›¾</p>
<ul>
<li><p>GAT with a single head (GAT1<em>h</em>) failed to fit the <em>training</em> set for any value of <em>k</em>, no matter for how many iterations it was trained, and after trying various training methods.</p>
</li>
<li><p>GAT8<em>h</em> successfully fits the <em>training</em> set, but generalizes <em>poorly</em> to the <em>test</em> set.</p>
</li>
<li><p>GATv2 easily achieves 100% training and 100% test accuracies for any value of <em>k</em>, and even for <em>k</em>=100 (not shown) and using a <em>single head</em></p>
</li>
<li><p>GINï¼ˆnon-attentive baselines ï¼‰çš„å®éªŒ</p>
<p><img src="/posts/82187def/Untitled 4.png" style="zoom:80%;"></p>
</li>
</ul>
<p><strong>Visualization</strong></p>
<p>è§Figure1</p>
<p><strong>The role of multi-head attention</strong></p>
<p>GATä½œè€…å‘ç°å¤šå¤´æ³¨æ„çš„ä½œç”¨æ˜¯â€œç¨³å®šå­¦ä¹ è¿‡ç¨‹â€ã€‚ç„¶è€Œï¼Œå›¾3æ˜¾ç¤ºï¼Œå¢åŠ å¤´éƒ¨çš„æ•°é‡ä¸¥æ ¼æé«˜äº†è®­ç»ƒçš„å‡†ç¡®æ€§ï¼Œå› æ­¤ï¼Œæé«˜è¡¨è¾¾æ€§ã€‚å› æ­¤ï¼ŒGATä¾èµ–äºæœ‰å¤šä¸ªæ³¨æ„åŠ›å¤´ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªGATv2å¤´ä¹Ÿæ¯”ä¸€ä¸ªå¤šå¤´GATæ³›åŒ–æ›´å¥½ã€‚</p>
<p>Qï¼š å¤šå¤´æ³¨æ„åŠ›ç¼ºä¹è§£é‡Šæ€§ï¼ŒçœŸçš„èƒ½ä¸€å®šæé«˜å‡†ç¡®æ€§å—</p>
<p>Aï¼šåœ¨å®é™…è®­ç»ƒä¸­ï¼Œæœ‰çš„æ—¶å€™åè€Œä¸‹é™äº†å‘¢ã€‚ä¸ºä»€ä¹ˆå‘¢ ï¼ˆè§4.4 NODE-PREDICTIONï¼‰</p>
<p><img src="/posts/82187def/Untitled 5.png" alt></p>
<h3 id="4-2-ROBUSTNESS-TO-NOISE"><a href="#4-2-ROBUSTNESS-TO-NOISE" class="headerlink" title="4.2 ROBUSTNESS TO NOISE"></a>4.2 ROBUSTNESS TO NOISE</h3><p><img src="/posts/82187def/Untitled 6.png" style="zoom:80%;"></p>
<p>GATv2ç›¸æ¯”GATå¯¹äºå™ªå£°å—åˆ°çš„å½±å“æ›´å°ã€‚æˆ‘ä»¬æ¨æ–­åŠ¨æ€æ³¨æ„åŠ›å¸®åŠ©æ¨¡å‹åŒºåˆ†å™ªå£°è¾¹ã€‚</p>
<h3 id="4-3-PROGRAMS-VARMISUSE"><a href="#4-3-PROGRAMS-VARMISUSE" class="headerlink" title="4.3 PROGRAMS: VARMISUSE"></a>4.3 PROGRAMS: VARMISUSE</h3><p>åœ¨Varmisuseçš„ç»“æœ</p>
<p><img src="/posts/82187def/Untitled 7.png" style="zoom: 80%;"></p>
<h3 id="4-4-NODE-PREDICTION"><a href="#4-4-NODE-PREDICTION" class="headerlink" title="4.4 NODE-PREDICTION"></a>4.4 NODE-PREDICTION</h3><p><img src="/posts/82187def/Untitled 8.png"></p>
<p>table (a)ä¸­ï¼ŒGATv2 ä¸€ä¸ªå¤´çš„éƒ½æ¯”GATå¤šå¤´çš„è¦å¥½ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸ç®¡æ˜¯GATè¿˜æ˜¯GATv2ï¼Œéƒ½å¯ä»¥åœ¨è¡¨ä¸­è§‚å¯Ÿåˆ°8å¤´åè€Œæ²¡æœ‰1å¤´å¥½çš„æƒ…å†µï¼å››ä¸ªæ•°æ®é›†ä¸­ï¼ŒGATv2æœ‰ä¸¤ä¸ªï¼ŒGATæœ‰ä¸‰ä¸ªã€‚æ‰€ä»¥ï¼Ÿï¼Ÿï¼Ÿ</p>
<h3 id="4-5-GRAPH-PREDICTION-QM9"><a href="#4-5-GRAPH-PREDICTION-QM9" class="headerlink" title="4.5 GRAPH-PREDICTION: QM9"></a>4.5 GRAPH-PREDICTION: QM9</h3><p>QM9 æ¯ä¸ªå›¾éƒ½æ˜¯ä¸€ä¸ªåˆ†å­ï¼Œå…¶ç›®æ ‡æ˜¯å°†æ¯ä¸ªå›¾å›å½’åˆ°13ä¸ªå®å€¼çš„é‡å­åŒ–å­¦æ€§è´¨ï¼ˆproperty)ã€‚</p>
<p><img src="/posts/82187def/Untitled 9.png" alt></p>
<ul>
<li><p>GATv2æ¯”GATæœ‰æ›´ä½çš„è¯¯å·®ï¼Œä¸”æ¯”è¿™ä¸‰ä¸ªæ¨¡å‹éƒ½æ›´ä½è¯¯å·®ã€‚</p>
</li>
<li><p>å­˜åœ¨ä¸€äº›æƒ…å†µæ˜¯GCNä¸GINè¿™ç±»æ²¡æœ‰åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶çš„æ¨¡å‹åè€Œè¡¨ç°çš„æ›´å¥½ï¼Œæˆ‘ä»¬å‡è®¾åœ¨modeling these propertiesæ—¶ä¸éœ€è¦æ³¨æ„åŠ›ã€‚</p>
</li>
<li><p>ç–‘é—®</p>
<ol>
<li><p>è§‚å¯Ÿåˆ°ä¸€ä¸ªæ•°æ®é›†GATä¼˜äºGATv2ï¼Œè¯´æ˜ä¸æ˜¯æ‰€æœ‰æƒ…å†µéƒ½ä¸€å®šGATv2ä¼˜äºGATã€‚é¦–å…ˆæ¨¡å‹å‚æ•°ä»–æ˜¯å°†GATè°ƒåˆ°æœ€ä¼˜ç„¶åç›´æ¥ç”¨äºGATv2ï¼Œä¸æ’é™¤GATv2æ²¡æœ‰è°ƒå¥½å‚æ•°çš„æƒ…å†µï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½å­˜åœ¨ä¸€ç§æƒ…å†µï¼šåœ¨æŸäº›å»ºæ¨¡å±æ€§/å›¾ç»“æ„ä¸‹ï¼ˆæ¯”è¾ƒç®€å•ï¼Ÿï¼‰å¹¶ä¸éœ€è¦åŠ¨æ€æ³¨æ„åŠ›å‘¢ï¼Œæˆ–è€…è¯´åŠ¨æ€æ³¨æ„åŠ›åè€Œä½¿ä»–æ›´å·®ï¼Ÿâ†’ Discussionéƒ¨åˆ†</p>
</li>
<li><p>éæ³¨æ„åŠ›æœºåˆ¶æ¨¡å‹GCNç­‰åœ¨æœ‰äº›æ—¶å€™åè€Œè¡¨ç°çš„æ›´å¥½ã€‚è®ºæ–‡è§£é‡Šæ˜¯æ¨æ–­å¯èƒ½åœ¨modeling these propertiesæ—¶ä¸éœ€è¦æ³¨æ„åŠ›ã€‚å¯¹äºè¿™ç§æƒ…å†µæ˜¯å¦æœ‰è¯¦ç»†çš„æƒ…å†µè§£é‡Šå‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªè§£é‡Šä¾‹å­ï¼šå½“æ¯ä¸ªé‚»å±…çš„attentionéƒ½å‡ ä¹ä¸€æ ·çš„æ—¶å€™ï¼Œç”¨attentionæœºåˆ¶åŸºæœ¬å°±æ²¡æœ‰æå‡ï¼Œè€Œå¤šå‡ºæ¥çš„å‚æ•°ä¼šå¯¼è‡´ä¼˜åŒ–å’Œè®­ç»ƒæ›´éš¾ã€‚</p>
</li>
</ol>
</li>
</ul>
<h3 id="4-6-LINK-PREDICTION"><a href="#4-6-LINK-PREDICTION" class="headerlink" title="4.6 LINK-PREDICTION"></a>4.6 LINK-PREDICTION</h3><p><img src="/posts/82187def/Untitled 10.png" alt></p>
<p>GATv2è¡¨ç°ä¼˜äºGATã€‚</p>
<p>å…³äºGraphSAGEçš„è¡¨ç°æ›´å¥½ï¼Œä½œè€…çš„çŒœæµ‹ä¸å‡è®¾ï¼š</p>
<ul>
<li><p>æˆ‘ä»¬å‡è®¾åœ¨è¿™äº›æ•°æ®é›†ä¸­å¯èƒ½ä¸éœ€è¦æ³¨æ„ã€‚</p>
<p><img src="/posts/82187def/Untitled 11.png" alt></p>
</li>
<li><p>å¦ä¸€ç§å¯èƒ½æ€§æ˜¯ï¼ŒåŠ¨æ€æ³¨æ„åŠ›åœ¨å…·æœ‰é«˜èŠ‚ç‚¹åº¦çš„å›¾ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<p>åœ¨ogbn productså’Œogbn-proteinsä¸­ï¼ˆtable1)çš„å¹³å‡èŠ‚ç‚¹åº¦åˆ†åˆ«ä¸º50.5å’Œ597ï¼ˆè§é™„å½•Cä¸­çš„è¡¨5ï¼‰ã€‚ç„¶è€Œï¼Œogbl-collab and ogbl-citation2ï¼ˆtable 3ï¼‰çš„å¹³å‡èŠ‚ç‚¹åº¦è¦ä½å¾—å¤šï¼Œä¸º8.2å’Œ20.7ã€‚</p>
</li>
<li><p>æˆ‘ä»¬å‡è®¾ï¼Œå½“é‚»å±…æ€»æ•°è¾ƒé«˜æ—¶ï¼ŒåŠ¨æ€æ³¨æ„æœºåˆ¶å¯¹äºé€‰æ‹©æœ€ç›¸å…³çš„é‚»å±…ç‰¹åˆ«æœ‰ç”¨</p>
</li>
</ul>
<p>æå‡ºfuture workï¼šå…³äºæ•°æ®é›†å¹³å‡èŠ‚ç‚¹åº¦çš„å½±å“è¿™ä¸€è¯¾é¢˜çš„GNNæ¶æ„ä¼˜åŒ–</p>
<h3 id="4-7-Discussion"><a href="#4-7-Discussion" class="headerlink" title="4.7 Discussion"></a>4.7 Discussion</h3><ul>
<li><strong>Which graph attention mechanism should I use?</strong></li>
</ul>
<ol>
<li>å¤ªç®€å•çš„ä»»åŠ¡ä½¿ç”¨è¾ƒå¼ºçš„æ¨¡å‹å¯èƒ½ä¼šè¿‡æ‹Ÿåˆï¼Œæ›´å¼ºçš„å›¾æ³¨æ„åŠ›æœºåˆ¶åœ¨èŠ‚ç‚¹ä¹‹é—´ç›¸äº’è¶Šå¤æ‚çš„æƒ…å†µä¸‹ç†è®ºä¸Šè¡¨ç°æ›´å¥½ã€‚</li>
</ol>
<p>é€šå¸¸ä¸å¯èƒ½é¢„å…ˆç¡®å®šå“ªç§ä½“ç³»ç»“æ„çš„æ€§èƒ½æœ€å¥½ã€‚ä¸€ä¸ªç†è®ºä¸Šè¾ƒå¼±çš„æ¨¡å‹å¯èƒ½åœ¨å®è·µä¸­è¡¨ç°å¾—æ›´å¥½ï¼Œå› ä¸ºå¦‚æœä»»åŠ¡æ˜¯â€œå¤ªç®€å•â€çš„ä¸”ä¸éœ€è¦è¿™æ ·çš„è¡¨è¾¾èƒ½åŠ›ï¼Œä¸€ä¸ªè¾ƒå¼ºçš„æ¨¡å‹å¯èƒ½ä¼šè¿‡æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚ç›´è§‚åœ°è¯´ï¼Œæˆ‘ä»¬è®¤ä¸ºèŠ‚ç‚¹ä¹‹é—´çš„ç›¸äº’ä½œç”¨è¶Šå¤æ‚ï¼ŒGNNä»ç†è®ºä¸Šæ›´å¼ºçš„å›¾æ³¨æ„æœºåˆ¶ä¸­è·å¾—çš„å¥½å¤„å°±è¶Šå¤§ï¼Œå¦‚GATv2ã€‚</p>
<ol>
<li>GAT vs GATv2 | å…¨å±€æ’åº vs é‚»å±…æ’åº</li>
</ol>
<p>ä¸»è¦çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªproblem<strong>æ˜¯å¦æœ‰ä¸€ä¸ªâ€œæœ‰å½±å“åŠ›çš„â€èŠ‚ç‚¹çš„å…¨å±€æ’åï¼ˆGATå°±è¶³å¤Ÿäº†ï¼‰ï¼Œæˆ–è€…ä¸åŒçš„èŠ‚ç‚¹æ˜¯å¦æœ‰ä¸åŒé‚»å±…çš„é‚»å±…æ’åï¼ˆä½¿ç”¨GATv2ï¼‰ã€‚</strong></p>
<p>GATçš„ä½œè€…åœ¨<a href="https://twitter.com/PetarV_93/status/1399685979506675714">æ¨ç‰¹ä¸Š</a>è¯å®ï¼ŒGATçš„è®¾è®¡é€‚ç”¨äºå½“æ—¶ï¼ˆ2017å¹´ï¼‰â€œå®¹æ˜“è¿‡æ‹Ÿåˆâ€çš„çš„æ•°æ®é›†ï¼Œå¦‚Coraã€Citeseerï¼ˆSenetal.ï¼Œ2008å¹´ï¼‰ï¼Œ<strong>ä»–ä»¬è¿™äº›æ•°æ®é›†å¯èƒ½å…·æœ‰â€œglobally importantâ€èŠ‚ç‚¹çš„åº•å±‚é™æ€æ’å</strong>ã€‚GATçš„ä½œè€…åŒæ„è¿™ä¸€è§‚ç‚¹ï¼šæ›´æ–°å’Œæ›´å…·æŒ‘æˆ˜æ€§çš„åŸºå‡†æµ‹è¯•å¯èƒ½éœ€è¦æ›´å¼ºçš„æ³¨æ„æœºåˆ¶ï¼Œå¦‚GATv2ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å›é¡¾äº†ä¼ ç»Ÿçš„å‡è®¾ï¼Œå¹¶è¡¨æ˜è®¸å¤šç°ä»£å›¾åŸºå‡†å’Œæ•°æ®é›†åŒ…å«æ›´å¤æ‚çš„äº¤äº’ï¼Œå› æ­¤éœ€è¦åŠ¨æ€çš„æ³¨æ„åŠ›ã€‚</p>
<p><img src="/posts/82187def/Untitled 12.png" style="zoom:67%;"></p>
<p><img src="/posts/82187def/Untitled 13.png" style="zoom:67%;"></p>
<h2 id="5-Conclusion"><a href="#5-Conclusion" class="headerlink" title="5. Conclusion"></a>5. Conclusion</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å‘ç°æµè¡Œå’Œå¹¿æ³›ä½¿ç”¨çš„å›¾æ³¨æ„ç½‘ç»œä¸è®¡ç®—åŠ¨æ€æ³¨æ„ã€‚ç›¸åï¼Œåœ¨æ ‡å‡†å®šä¹‰å’Œå®ç°ä¸­çš„æ³¨æ„æœºåˆ¶çš„ç»“æœåªæ˜¯é™æ€çš„ï¼šå¯¹äºä»»ä½•æŸ¥è¯¢ï¼Œå®ƒçš„é‚»å±…åˆ†æ•°å¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„åˆ†æ•°æ˜¯å•è°ƒçš„ã€‚å› æ­¤ï¼ŒGATç”šè‡³ä¸èƒ½è¡¨è¾¾ç®€å•çš„å¯¹é½é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªç®€å•çš„ä¿®å¤å¹¶æå‡ºäº†GATv2ï¼šé€šè¿‡ä¿®æ”¹GATä¸­çš„æ“ä½œé¡ºåºï¼ŒGATv2å®ç°äº†ä¸€ä¸ªé€šç”¨çš„è¿‘ä¼¼æ³¨æ„å‡½æ•°ï¼Œå› æ­¤ä¸¥æ ¼æ¯”GATæ›´å¼ºå¤§ã€‚</p>
<p>æˆ‘ä»¬åœ¨ä¸€ä¸ªéœ€è¦åŠ¨æ€é€‰æ‹©èŠ‚ç‚¹çš„ç»¼åˆé—®é¢˜ä¸­ï¼Œå±•ç¤ºäº†GATv2ç›¸å¯¹äºGATçš„ç»éªŒä¼˜åŠ¿ï¼Œä»¥åŠæ¥è‡ªOGBå’Œå…¶ä»–å…¬å…±æ•°æ®é›†çš„11ä¸ªåŸºå‡†æµ‹è¯•ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜GATv2åœ¨æ‰€æœ‰åŸºå‡†æµ‹è¯•ä¸­éƒ½ä¼˜äºGATï¼ŒåŒæ—¶å…·æœ‰ç›¸åŒçš„å‚æ•°ä»£ä»·ã€‚</p>
<p>æˆ‘ä»¬é¼“åŠ±ç¤¾åŒºåœ¨å°†æ–°çš„GNNæ¶æ„ä¸å¸¸è§çš„å¼ºåŸºçº¿è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä½¿ç”¨GATv2è€Œä¸æ˜¯GATã€‚åœ¨å¤æ‚çš„ä»»åŠ¡å’Œé¢†åŸŸä¸­ï¼Œä»¥åŠåœ¨å…·æœ‰æŒ‘æˆ˜æ€§çš„æ•°æ®é›†ä¸­ï¼Œä¸€ä¸ªæ¨¡å‹ä½¿ç”¨GATä½œä¸ºå†…éƒ¨ç»„ä»¶å¯ä»¥ç”¨GATv2æ›¿æ¢å®ƒï¼Œä»¥é€‚åº”ä¸¥æ ¼ä¸Šæ›´å¼ºå¤§çš„æ¨¡å‹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨<a href="https://github.com/tech-srl/how_attentive_are_gats">https://github.com/tech-srl/how_attentive_are_gats</a> ä¸Šå…¬å¼€äº†æˆ‘ä»¬çš„ä»£ç ï¼Œå¹¶ä¸”GATv2å¯ä»¥ä½œä¸ºPyTorch Geometric library, the Deep Graph Library, and TensorFlow GNNçš„ä¸€éƒ¨åˆ†ä½¿ç”¨ã€‚åœ¨ <a href="https://nn.labml.ai/graphs/gatv2">https://nn.labml.ai/graphs/gatv2</a> ä¸Šæœ‰ä¸€ä¸ªå¸¦æ³¨é‡Šçš„å®ç° ã€‚</p>
]]></content>
      <categories>
        <category>è®ºæ–‡é˜…è¯»</category>
      </categories>
      <tags>
        <tag>GAT</tag>
        <tag>GNN</tag>
      </tags>
  </entry>
  <entry>
    <title>Guide for starting a new project</title>
    <url>/posts/5e0e6968/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>ç¿»è¯‘æ•´ç†è‡ª<a href="https://github.com/google-research/tuning_playbook#choosing-the-batch-size-to-minimize-training-time">google-research/tuning_playbook</a></p>
<h1 id="å¼€å±•ä¸€ä¸ªæ–°é¡¹ç›®çš„æŒ‡å—"><a href="#å¼€å±•ä¸€ä¸ªæ–°é¡¹ç›®çš„æŒ‡å—" class="headerlink" title="å¼€å±•ä¸€ä¸ªæ–°é¡¹ç›®çš„æŒ‡å—"></a>å¼€å±•ä¸€ä¸ªæ–°é¡¹ç›®çš„æŒ‡å—</h1><span id="more"></span>
<p><em>æ‘˜è¦ï¼š æˆ‘ä»¬åœ¨è°ƒæ•´è¿‡ç¨‹ä¸­åšå‡ºçš„è®¸å¤šå†³å®šå¯ä»¥åœ¨é¡¹ç›®å¼€å§‹æ—¶ä¸€æ¬¡æ€§åšå‡ºï¼Œåªæœ‰åœ¨æƒ…å†µå‘ç”Ÿå˜åŒ–æ—¶æ‰å¶å°”é‡æ–°å®¡è§†ã€‚</em></p>
<p>æˆ‘ä»¬çš„æŒ‡å¯¼å‡å®šä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>å·²ç»å®Œæˆäº†é—®é¢˜åˆ¶å®šã€æ•°æ®æ¸…ç†ç­‰åŸºæœ¬å·¥ä½œï¼ŒèŠ±æ—¶é—´è°ƒæ•´æ¨¡å‹æ¶æ„å’Œè®­ç»ƒé…ç½®æ˜¯æœ‰æ„ä¹‰çš„ã€‚</li>
<li>å·²ç»è®¾ç½®äº†ä¸€ä¸ªå¯ä»¥è¿›è¡Œè®­ç»ƒå’Œè¯„ä¼°çš„æµæ°´çº¿ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾æ‰§è¡Œæ„Ÿå…´è¶£çš„å„ç§æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ä»»åŠ¡ã€‚</li>
<li>å·²ç»é€‰æ‹©å¹¶å®æ–½äº†é€‚å½“çš„æŒ‡æ ‡ã€‚è¿™äº›æŒ‡æ ‡åº”å°½å¯èƒ½åæ˜ éƒ¨ç½²ç¯å¢ƒä¸­æµ‹é‡çš„å†…å®¹ã€‚</li>
</ul>
<h2 id="é€‰æ‹©æ¨¡å‹æ¶æ„"><a href="#é€‰æ‹©æ¨¡å‹æ¶æ„" class="headerlink" title="é€‰æ‹©æ¨¡å‹æ¶æ„"></a>é€‰æ‹©æ¨¡å‹æ¶æ„</h2><p><strong>æ‘˜è¦ï¼š</strong> <em>åœ¨å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®æ—¶ï¼Œå°è¯•é‡ç”¨ä¸€ä¸ªå·²ç»æœ‰æ•ˆçš„æ¨¡å‹ã€‚</em></p>
<ul>
<li>é¦–å…ˆé€‰æ‹©ä¸€ä¸ªæˆç†Ÿã€å¸¸ç”¨çš„æ¨¡å‹æ¶æ„ä»¥è·å¾—æœ‰æ•ˆçš„å·¥ä½œã€‚æ€»æ˜¯å¯ä»¥ç¨åæ„å»ºè‡ªå®šä¹‰æ¨¡å‹ã€‚</li>
<li>æ¨¡å‹æ¶æ„é€šå¸¸å…·æœ‰å„ç§è¶…å‚æ•°ï¼Œç”¨äºç¡®å®šæ¨¡å‹çš„å¤§å°å’Œå…¶ä»–ç»†èŠ‚ï¼ˆä¾‹å¦‚å±‚æ•°ã€å±‚å®½ã€æ¿€æ´»å‡½æ•°ç±»å‹ï¼‰ã€‚<ul>
<li>å› æ­¤ï¼Œé€‰æ‹©æ¶æ„å®é™…ä¸Šæ„å‘³ç€é€‰æ‹©ä¸€ä¸ªä¸åŒæ¨¡å‹çš„å®¶æ—ï¼ˆæ¯ä¸ªå¯¹åº”ä¸€ç§æ¨¡å‹è¶…å‚æ•°è®¾ç½®ï¼‰ã€‚</li>
<li>æˆ‘ä»¬å°†åœ¨<a href="https://github.com/google-research/tuning_playbook#choosing-the-initial-configuration">Choosing the initial configuration</a> and <a href="https://github.com/google-research/tuning_playbook#a-scientific-approach-to-improving-model-performance">A scientific approach to improving model performance</a>ä¸­è€ƒè™‘é€‰æ‹©æ¨¡å‹è¶…å‚æ•°çš„é—®é¢˜ã€‚</li>
</ul>
</li>
<li>å¦‚æœå¯èƒ½ï¼Œå°è¯•æ‰¾åˆ°ä¸€ç¯‡å°½å¯èƒ½æ¥è¿‘æ‰‹å¤´é—®é¢˜çš„è®ºæ–‡ï¼Œå¹¶å°†å…¶ä½œä¸ºèµ·ç‚¹è¿›è¡Œå¤ç°ã€‚</li>
</ul>
<h2 id="é€‰æ‹©ä¼˜åŒ–å™¨"><a href="#é€‰æ‹©ä¼˜åŒ–å™¨" class="headerlink" title="é€‰æ‹©ä¼˜åŒ–å™¨"></a>é€‰æ‹©ä¼˜åŒ–å™¨</h2><p><strong>æ‘˜è¦ï¼š</strong> <em>ä»æ‰‹å¤´é—®é¢˜ç±»å‹çš„æœ€æµè¡Œä¼˜åŒ–å™¨å¼€å§‹ã€‚</em></p>
<ul>
<li><p>æ²¡æœ‰ä¼˜åŒ–å™¨æ˜¯æ‰€æœ‰æœºå™¨å­¦ä¹ é—®é¢˜å’Œæ¨¡å‹æ¶æ„çš„â€œæœ€ä½³â€ä¼˜åŒ–å™¨ã€‚å³ä½¿åªæ˜¯<a href="https://arxiv.org/abs/1910.05446">æ¯”è¾ƒä¼˜åŒ–å™¨çš„æ€§èƒ½ä¹Ÿæ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡</a>ã€‚ğŸ¤–</p>
</li>
<li><p>æˆ‘ä»¬å»ºè®®åšæŒä½¿ç”¨æˆç†Ÿã€æµè¡Œçš„ä¼˜åŒ–å™¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¼€å§‹æ–°é¡¹ç›®æ—¶ã€‚</p>
<ul>
<li>ç†æƒ³æƒ…å†µä¸‹ï¼Œè¯·é€‰æ‹©ç”¨äºåŒä¸€ç±»å‹é—®é¢˜çš„æœ€æµè¡Œä¼˜åŒ–å™¨ã€‚</li>
</ul>
</li>
<li><p>å‡†å¤‡å…³æ³¨æ‰€é€‰ä¼˜åŒ–å™¨çš„æ‰€æœ‰è¶…å‚æ•°ã€‚</p>
<ul>
<li><p>å…·æœ‰æ›´å¤šè¶…å‚æ•°çš„ä¼˜åŒ–å™¨å¯èƒ½éœ€è¦æ›´å¤šçš„è°ƒæ•´å·¥ä½œæ‰èƒ½æ‰¾åˆ°æœ€ä½³é…ç½®ã€‚</p>
</li>
<li><p>åœ¨é¡¹ç›®çš„åˆå§‹é˜¶æ®µï¼Œå½“æˆ‘ä»¬è¯•å›¾æ‰¾åˆ°å…¶ä»–å„ç§è¶…å‚æ•°çš„æœ€ä½³å€¼æ—¶ï¼ˆä¾‹å¦‚æ¶æ„è¶…å‚æ•°ï¼‰ï¼Œå°†ä¼˜åŒ–å™¨è¶…å‚æ•°è§†ä¸ºå¹²æ‰°å‚æ•° ï¼ˆNuisance hyperparametersï¼‰ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>ï¼ˆNuisance hyperparametersæ˜¯æœªè¢«ç‰¹å®šï¼Œä½†æ˜¯åœ¨ç†è®ºæµ‹è¯•æ—¶è¢«è€ƒè™‘åˆ°çš„é‚£äº›ï¼Œå³å®ƒä»¬æ˜¯éœ€è¦ä¼˜åŒ–ä»¥ä¾¿æ¯”è¾ƒç§‘å­¦è¶…å‚æ•°ï¼ˆScientific hyperparameters) çš„ä¸åŒå€¼çš„å‚æ•°ã€‚ç§‘å­¦è¶…å‚æ•°æ˜¯æˆ‘ä»¬è¯•å›¾è¡¡é‡å®ƒä»¬å¯¹æ¨¡å‹æ€§èƒ½é€ æˆçš„å½±å“çš„å‚æ•°ã€‚</p>
</li>
<li><p>åœ¨é¡¹ç›®çš„åˆå§‹é˜¶æ®µï¼Œå¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨æ›´ç®€å•çš„ä¼˜åŒ–å™¨ï¼ˆä¾‹å¦‚å…·æœ‰å›ºå®šåŠ¨é‡çš„SGDæˆ–å…·æœ‰å›ºå®š<em>Ïµ</em>ã€<em>Î²1</em>å’Œ<em>Î²2</em>çš„Adamï¼‰ï¼Œç„¶åç¨ååˆ‡æ¢åˆ°æ›´ä¸€èˆ¬çš„ä¼˜åŒ–å™¨ã€‚</p>
</li>
</ul>
</li>
<li><p>æˆ‘ä»¬å–œæ¬¢çš„æˆç†Ÿä¼˜åŒ–å™¨ï¼ˆä½†ä¸é™äºï¼‰åŒ…æ‹¬ï¼š</p>
<ul>
<li>å¸¦æœ‰åŠ¨é‡çš„SGDï¼ˆæˆ‘ä»¬å–œæ¬¢Nesterovå˜ä½“ï¼‰</li>
<li>Adamå’ŒNAdamï¼Œå®ƒä»¬æ¯”å¸¦æœ‰åŠ¨é‡çš„SGDæ›´ä¸€èˆ¬ã€‚è¯·æ³¨æ„ï¼ŒAdamå…·æœ‰4ä¸ªå¯è°ƒè¶…å‚æ•°<a href="https://arxiv.org/abs/1910.05446">å®ƒä»¬éƒ½å¾ˆé‡è¦</a>ï¼</li>
<li>è¯·å‚é˜…[Adamçš„è¶…å‚æ•°å¦‚ä½•è°ƒæ•´ï¼Ÿ]<ul>
<li>æ ¹æ®ä¸Šé¢çš„è®¨è®ºï¼Œå…³äºæœç´¢ç©ºé—´ä»¥åŠåº”è¯¥ä»æœç´¢ç©ºé—´ä¸­é‡‡æ ·å¤šå°‘ç‚¹çš„ä¸€èˆ¬æ€§é™ˆè¿°æ˜¯éå¸¸å›°éš¾çš„ã€‚è¯·æ³¨æ„ï¼ŒAdamä¸­çš„æ‰€æœ‰è¶…å‚æ•°å¹¶ä¸éƒ½åŒæ ·é‡è¦ã€‚ä»¥ä¸‹ç»éªŒæ³•åˆ™å¯¹åº”äºä¸åŒçš„â€œé¢„ç®—â€ï¼Œç”¨äºç ”ç©¶ä¸­çš„è¯•éªŒæ¬¡æ•°ã€‚ - å¦‚æœç ”ç©¶ä¸­çš„è¯•éªŒæ¬¡æ•°å°‘äº10æ¬¡ï¼Œåªè°ƒæ•´ï¼ˆåŸºæœ¬ï¼‰å­¦ä¹ ç‡ã€‚ - å¦‚æœ10-25æ¬¡è¯•éªŒï¼Œè°ƒæ•´å­¦ä¹ ç‡å’ŒÎ²1ã€‚ - å¦‚æœ25+æ¬¡è¯•éªŒï¼Œè°ƒæ•´å­¦ä¹ ç‡ï¼ŒÎ²1å’ŒÏµã€‚ - å¦‚æœå¯ä»¥è¿è¡Œçš„è¯•éªŒæ¬¡æ•°å¤§å¤§è¶…è¿‡25æ¬¡ï¼Œè¿˜å¯ä»¥è°ƒæ•´Î²2ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="é€‰æ‹©æ‰¹é‡å¤§å°"><a href="#é€‰æ‹©æ‰¹é‡å¤§å°" class="headerlink" title="é€‰æ‹©æ‰¹é‡å¤§å°"></a>é€‰æ‹©æ‰¹é‡å¤§å°</h2><p><strong>æ‘˜è¦ï¼š</strong> <em>æ‰¹é‡å¤§å°æ§åˆ¶è®­ç»ƒé€Ÿåº¦ï¼Œä¸åº”è¯¥ç”¨æ¥ç›´æ¥è°ƒæ•´éªŒè¯é›†æ€§èƒ½ã€‚é€šå¸¸ï¼Œç†æƒ³çš„æ‰¹é‡å¤§å°å°†æ˜¯å¯ç”¨ç¡¬ä»¶æ”¯æŒçš„æœ€å¤§æ‰¹é‡å¤§å°ã€‚</em></p>
<ul>
<li>æ‰¹é‡å¤§å°æ˜¯ç¡®å®š<em>è®­ç»ƒæ—¶é—´</em>å’Œ<em>è®¡ç®—èµ„æºæ¶ˆè€—</em>çš„å…³é”®å› ç´ ã€‚</li>
<li>å¢åŠ æ‰¹é‡å¤§å°é€šå¸¸ä¼šå‡å°‘è®­ç»ƒæ—¶é—´ã€‚è¿™å¯èƒ½æ˜¯éå¸¸æœ‰ç›Šçš„ï¼Œå› ä¸ºå®ƒï¼š<ul>
<li>å…è®¸åœ¨å›ºå®šçš„æ—¶é—´é—´éš”å†…æ›´å½»åº•åœ°è°ƒæ•´è¶…å‚æ•°ï¼Œå¯èƒ½å¯¼è‡´æ›´å¥½çš„æœ€ç»ˆæ¨¡å‹ã€‚</li>
<li>å‡å°‘å¼€å‘å‘¨æœŸçš„å»¶è¿Ÿï¼Œå…è®¸æ›´é¢‘ç¹åœ°æµ‹è¯•æ–°æƒ³æ³•ã€‚</li>
</ul>
</li>
<li>å¢åŠ æ‰¹é‡å¤§å°å¯ä»¥å‡å°‘ã€å¢åŠ æˆ–ä¸æ”¹å˜èµ„æºæ¶ˆè€—ã€‚</li>
<li>æ‰¹é‡å¤§å°ä¸åº”è¯¥è¢«å½“ä½œç”¨äºéªŒè¯é›†æ€§èƒ½çš„å¯è°ƒè¶…å‚æ•°ã€‚<ul>
<li>åªè¦æ‰€æœ‰è¶…å‚æ•°éƒ½å¾—åˆ°å¾ˆå¥½çš„è°ƒæ•´ï¼ˆç‰¹åˆ«æ˜¯å­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–è¶…å‚æ•°ï¼‰ï¼Œå¹¶ä¸”è®­ç»ƒæ­¥æ•°è¶³å¤Ÿï¼Œä½¿ç”¨ä»»ä½•æ‰¹é‡å¤§å°éƒ½åº”è¯¥å¯ä»¥è·å¾—ç›¸åŒçš„æœ€ç»ˆæ€§èƒ½ï¼ˆè¯·å‚è§ <a href="https://arxiv.org/abs/1811.03600">Shallue et al. 2018</a> ï¼‰ã€‚</li>
<li>è¯·å‚é˜…ä¸ºä»€ä¹ˆä¸åº”è¯¥å°†æ‰¹é‡å¤§å°è°ƒæ•´ä¸ºç›´æ¥æ”¹å–„éªŒè¯é›†æ€§èƒ½ï¼Ÿ<ul>
<li>æ”¹å˜æ‰¹é‡å¤§å°<em>è€Œä¸æ”¹å˜ä»»ä½•å…¶ä»–è®­ç»ƒç®¡é“çš„ç»†èŠ‚</em>é€šå¸¸ä¼šå½±å“éªŒè¯é›†æ€§èƒ½ã€‚</li>
<li>ä½†æ˜¯ï¼Œå¦‚æœä¸ºæ¯ä¸ªæ‰¹é‡å¤§å°å•ç‹¬ä¼˜åŒ–è®­ç»ƒç®¡é“ï¼Œä¸¤ä¸ªæ‰¹é‡å¤§å°ä¹‹é—´çš„éªŒè¯é›†æ€§èƒ½å·®å¼‚é€šå¸¸ä¼šæ¶ˆå¤±ã€‚</li>
<li>ä¸æ‰¹é‡å¤§å°æœ€å¼ºçƒˆç›¸äº’ä½œç”¨çš„è¶…å‚æ•°ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªæ‰¹é‡å¤§å°æœ€é‡è¦çš„æ˜¯å•ç‹¬è°ƒæ•´ä¼˜åŒ–å™¨è¶…å‚æ•°ï¼ˆä¾‹å¦‚å­¦ä¹ ç‡ï¼ŒåŠ¨é‡ï¼‰å’Œæ­£åˆ™åŒ–è¶…å‚æ•°ã€‚<ul>
<li>è¾ƒå°çš„æ‰¹é‡å¤§å°ä¼šç”±äºæ ·æœ¬æ–¹å·®å‘è®­ç»ƒç®—æ³•å¼•å…¥æ›´å¤šå™ªå£°ï¼Œå¹¶ä¸”æ­¤å™ªå£°å¯èƒ½å…·æœ‰æ­£åˆ™åŒ–æ•ˆæœã€‚å› æ­¤ï¼Œè¾ƒå¤§çš„æ‰¹é‡å¤§å°å¯èƒ½æ›´å®¹æ˜“è¿‡åº¦æ‹Ÿåˆï¼Œå¯èƒ½éœ€è¦æ›´å¼ºçš„æ­£åˆ™åŒ–å’Œ/æˆ–é¢å¤–çš„æ­£åˆ™åŒ–æŠ€æœ¯ã€‚</li>
</ul>
</li>
<li>æ­¤å¤–ï¼Œæ”¹å˜æ‰¹é‡å¤§å°æ—¶ï¼Œ<a href="https://github.com/google-research/tuning_playbook#choosing-the-batch-size-to-minimize-training-time">å¯èƒ½éœ€è¦è°ƒæ•´è®­ç»ƒæ­¥éª¤çš„æ•°é‡</a>ã€‚</li>
<li>ä¸€æ—¦è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›å½±å“ï¼Œç›®å‰å°šæ— ä»¤äººä¿¡æœçš„è¯æ®è¡¨æ˜æ‰¹é‡å¤§å°ä¼šå½±å“æœ€å¤§å¯è¾¾åˆ°çš„éªŒè¯æ€§èƒ½ï¼ˆå‚è§<a href="https://arxiv.org/abs/1811.03600">Shallue et al. 2018</a>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ç¡®å®šå¯è¡Œçš„æ‰¹é‡å¤§å°å’Œä¼°è®¡è®­ç»ƒååé‡"><a href="#ç¡®å®šå¯è¡Œçš„æ‰¹é‡å¤§å°å’Œä¼°è®¡è®­ç»ƒååé‡" class="headerlink" title="ç¡®å®šå¯è¡Œçš„æ‰¹é‡å¤§å°å’Œä¼°è®¡è®­ç»ƒååé‡"></a>ç¡®å®šå¯è¡Œçš„æ‰¹é‡å¤§å°å’Œä¼°è®¡è®­ç»ƒååé‡</h3><ul>
<li>å¯¹äºç»™å®šçš„æ¨¡å‹å’Œä¼˜åŒ–å™¨ï¼Œå¯ç”¨ç¡¬ä»¶é€šå¸¸ä¼šæ”¯æŒä¸€å®šèŒƒå›´çš„æ‰¹é‡å¤§å°ã€‚é™åˆ¶å› ç´ é€šå¸¸æ˜¯åŠ é€Ÿå™¨å†…å­˜ã€‚</li>
<li>ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ä¸è¿è¡Œæˆ–è€…è‡³å°‘ä¸ç¼–è¯‘æ•´ä¸ªè®­ç»ƒç¨‹åºçš„æƒ…å†µä¸‹è®¡ç®—å“ªäº›æ‰¹é‡å¤§å°å°†é€‚åˆå†…å­˜å¯èƒ½å¾ˆå›°éš¾ã€‚</li>
<li>æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯è¿è¡Œä¸åŒæ‰¹é‡å¤§å°ï¼ˆä¾‹å¦‚å¢åŠ 2çš„å¹‚ï¼‰çš„è®­ç»ƒä½œä¸šï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªä½œä¸šè¶…è¿‡å¯ç”¨çš„å†…å­˜ä¸ºæ­¢ã€‚</li>
<li>å¯¹äºæ¯ä¸ªæ‰¹é‡å¤§å°ï¼Œæˆ‘ä»¬åº”è¯¥è®­ç»ƒè¶³å¤Ÿé•¿çš„æ—¶é—´æ¥è·å¾—<em>è®­ç»ƒååé‡</em>çš„å¯é ä¼°è®¡</li>
</ul>
<p>è®­ç»ƒååé‡ =ï¼ˆ#æ¯ç§’å¤„ç†çš„å®ä¾‹ï¼‰</p>
<p>æˆ–è€…ï¼Œç­‰æ•ˆåœ°ï¼Œ<em>æ¯æ­¥æ—¶é—´</em>ã€‚</p>
<p>æ¯æ­¥æ—¶é—´ =ï¼ˆæ‰¹é‡å¤§å°ï¼‰/ï¼ˆè®­ç»ƒååé‡ï¼‰</p>
<ul>
<li>å½“åŠ é€Ÿå™¨å°šæœªé¥±å’Œæ—¶ï¼Œå¦‚æœæ‰¹é‡å¤§å°ç¿»å€ï¼Œè®­ç»ƒååé‡ä¹Ÿåº”è¯¥ç¿»å€ï¼ˆæˆ–è€…è‡³å°‘æ¥è¿‘ç¿»å€ï¼‰ã€‚ç­‰æ•ˆåœ°ï¼Œæ¯æ­¥æ—¶é—´éšç€æ‰¹é‡å¤§å°çš„å¢åŠ åº”è¯¥æ˜¯æ’å®šçš„ï¼ˆæˆ–è€…è‡³å°‘æ¥è¿‘æ’å®šï¼‰ã€‚</li>
<li>å¦‚æœæƒ…å†µä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆè®­ç»ƒç®¡é“å°±å…·æœ‰ç“¶é¢ˆï¼Œä¾‹å¦‚I / Oæˆ–è®¡ç®—èŠ‚ç‚¹ä¹‹é—´çš„åŒæ­¥ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¿™å¯èƒ½å€¼å¾—è¯Šæ–­å’Œçº æ­£ã€‚</li>
<li>å¦‚æœè®­ç»ƒååé‡ä»…å¢åŠ åˆ°æŸä¸ªæœ€å¤§æ‰¹é‡å¤§å°ï¼Œé‚¤æˆ‘ä»¬åº”è¯¥åªè€ƒè™‘åˆ°è¯¥æœ€å¤§æ‰¹é‡å¤§å°ï¼Œå³ä½¿ç¡¬ä»¶æ”¯æŒæ›´å¤§çš„æ‰¹é‡å¤§å°ã€‚<ul>
<li>ä½¿ç”¨è¾ƒå¤§æ‰¹é‡å¤§å°çš„æ‰€æœ‰å¥½å¤„å‡å‡å®šè®­ç»ƒååé‡ä¼šå¢åŠ ã€‚  å¦‚æœä¸æ˜¯ï¼Œä¿®å¤ç“¶é¢ˆæˆ–ä½¿ç”¨è¾ƒå°çš„æ‰¹é‡å¤§å°ã€‚</li>
<li><strong>æ¢¯åº¦ç´¯ç§¯</strong>æ¨¡æ‹Ÿæ¯”ç¡¬ä»¶æ”¯æŒçš„æ›´å¤§çš„æ‰¹é‡å¤§å°ï¼Œå› æ­¤ä¸æä¾›ä»»ä½•ååé‡ä¼˜åŠ¿ã€‚ åœ¨åº”ç”¨å·¥ä½œä¸­é€šå¸¸åº”é¿å…ä½¿ç”¨å®ƒã€‚</li>
</ul>
</li>
<li>æ¯æ¬¡æ›´æ”¹æ¨¡å‹æˆ–ä¼˜åŒ–å™¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œä¸åŒçš„æ¨¡å‹æ¶æ„å¯èƒ½å…è®¸æ›´å¤§çš„æ‰¹é‡å¤§å°é€‚åˆå†…å­˜ï¼‰ï¼Œå¯èƒ½éœ€è¦é‡å¤è¿™äº›æ­¥éª¤ã€‚</li>
</ul>
<h3 id="é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–è®­ç»ƒæ—¶é—´"><a href="#é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–è®­ç»ƒæ—¶é—´" class="headerlink" title="é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–è®­ç»ƒæ—¶é—´"></a>é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–è®­ç»ƒæ—¶é—´</h3><p>è®­ç»ƒæ—¶é—´ =ï¼ˆæ¯æ­¥æ—¶é—´ï¼‰xï¼ˆæ€»æ­¥æ•°ï¼‰</p>
<ul>
<li><p>æˆ‘ä»¬é€šå¸¸å¯ä»¥è®¤ä¸ºæ¯æ­¥æ—¶é—´å¯¹äºæ‰€æœ‰å¯è¡Œçš„æ‰¹é‡å¤§å°æ¥è¯´éƒ½æ˜¯è¿‘ä¼¼æ’å®šçš„ã€‚ å½“æ²¡æœ‰å¹¶è¡Œè®¡ç®—çš„å¼€é”€å¹¶ä¸”æ‰€æœ‰è®­ç»ƒç“¶é¢ˆéƒ½å·²ç»è¯Šæ–­å’Œçº æ­£ï¼ˆè¯·å‚é˜…ä¸Šä¸€èŠ‚ä»¥äº†è§£å¦‚ä½•è¯†åˆ«è®­ç»ƒç“¶é¢ˆï¼‰æ—¶ï¼Œè¿™æ˜¯æ­£ç¡®çš„ã€‚ å®è·µä¸­ï¼Œéšç€æ‰¹é‡å¤§å°çš„å¢åŠ ï¼Œé€šå¸¸è‡³å°‘æœ‰ä¸€äº›å¼€é”€ã€‚</p>
</li>
<li><p>éšç€æ‰¹é‡å¤§å°çš„å¢åŠ ï¼Œè¦è¾¾åˆ°å›ºå®šæ€§èƒ½ç›®æ ‡æ‰€éœ€çš„æ€»æ­¥æ•°é€šå¸¸ä¼šå‡å°‘ï¼ˆæ‰€æœ‰ç›¸å…³è¶…å‚æ•°åœ¨æ›´æ”¹æ‰¹é‡å¤§å°æ—¶é‡æ–°è°ƒæ•´; Shallue et al. 2018ï¼‰ã€‚</p>
<ul>
<li>ä¾‹å¦‚ã€‚ å°†æ‰¹é‡å¤§å°ç¿»å€å¯èƒ½ä¼šä½¿æ‰€éœ€çš„æ€»æ­¥æ•°å‡åŠã€‚ è¿™ç§°ä¸º<strong>å®Œç¾ç¼©æ”¾</strong>ã€‚</li>
</ul>
</li>
<li><p>å®Œç¾ç¼©æ”¾é€‚ç”¨äºæ‰€æœ‰æ‰¹é‡å¤§å°ï¼Œç›´åˆ°ä¸€ä¸ªä¸´ç•Œæ‰¹é‡å¤§å°ï¼Œè¶…å‡ºè¯¥æ‰¹é‡å¤§å°ï¼Œæ”¶ç›Šå°±ä¼šé€æ¸å‡å°‘ã€‚</p>
<ul>
<li>æœ€ç»ˆï¼Œå¢åŠ æ‰¹é‡å¤§å°ä¸å†å‡å°‘è®­ç»ƒæ­¥éª¤çš„æ•°é‡ï¼ˆä½†æ°¸è¿œä¸ä¼šå¢åŠ ï¼‰ã€‚</li>
</ul>
</li>
<li><p>å› æ­¤ï¼Œæœ€å°åŒ–è®­ç»ƒæ—¶é—´çš„æ‰¹é‡å¤§å°é€šå¸¸æ˜¯ä»ç„¶æä¾›å‡å°‘è®­ç»ƒæ­¥éª¤æ•°é‡çš„æœ€å¤§æ‰¹é‡å¤§å°ã€‚</p>
<ul>
<li><p>æ­¤æ‰¹é‡å¤§å°å–å†³äºæ•°æ®é›†ï¼Œæ¨¡å‹å’Œä¼˜åŒ–å™¨ï¼Œé™¤äº†ä¸ºæ¯ä¸ªæ–°é—®é¢˜æ‰¾åˆ°å®ƒçš„å®éªŒä¹‹å¤–ï¼Œå¦‚ä½•è®¡ç®—å®ƒæ˜¯ä¸€ä¸ªæœªè§£å†³çš„é—®é¢˜ã€‚ ğŸ¤–</p>
</li>
<li><p>åœ¨æ¯”è¾ƒæ‰¹é‡å¤§å°æ—¶ï¼Œè¦æ³¨æ„ç¤ºä¾‹é¢„ç®—/epoché¢„ç®—ï¼ˆå›ºå®šè®­ç»ƒç¤ºä¾‹å‘ˆç°çš„æ•°é‡æ¥è¿è¡Œæ‰€æœ‰å®éªŒï¼‰å’Œæ­¥éª¤é¢„ç®—ï¼ˆå›ºå®šè®­ç»ƒæ­¥éª¤çš„æ•°é‡æ¥è¿è¡Œæ‰€æœ‰å®éªŒï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚</p>
<ul>
<li>ä½¿ç”¨epoché¢„ç®—æ¯”è¾ƒæ‰¹é‡å¤§å°åªæ¢æµ‹å®Œç¾ç¼©æ”¾æ¨¡å¼ï¼Œå³ä½¿æ›´å¤§çš„æ‰¹é‡å¤§å°ä»ç„¶å¯ä»¥é€šè¿‡å‡å°‘æ‰€éœ€çš„è®­ç»ƒæ­¥éª¤æ¥æä¾›æœ‰æ„ä¹‰çš„åŠ é€Ÿã€‚</li>
</ul>
</li>
<li><p>é€šå¸¸ï¼Œå¯ç”¨ç¡¬ä»¶æ”¯æŒçš„æœ€å¤§æ‰¹é‡å¤§å°å°äºå…³é”®æ‰¹é‡å¤§å°ã€‚å› æ­¤ï¼Œ<strong>ä¸€ä¸ªå¾ˆå¥½çš„ç»éªŒæ³•åˆ™ï¼ˆæ— éœ€è¿è¡Œä»»ä½•å®éªŒï¼‰æ˜¯ä½¿ç”¨å°½å¯èƒ½å¤§çš„æ‰¹é‡å¤§å°ã€‚</strong></p>
</li>
<li><p><strong>å¦‚æœä½¿ç”¨æ›´å¤§çš„æ‰¹é‡å¤§å°ä¼šå¢åŠ è®­ç»ƒæ—¶é—´ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦ä½¿ç”¨æ›´å¤§çš„æ‰¹é‡å¤§å°ã€‚</strong></p>
</li>
</ul>
</li>
</ul>
<h3 id="é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–èµ„æºæ¶ˆè€—"><a href="#é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–èµ„æºæ¶ˆè€—" class="headerlink" title="é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–èµ„æºæ¶ˆè€—"></a>é€‰æ‹©æ‰¹é‡å¤§å°ä»¥æœ€å°åŒ–èµ„æºæ¶ˆè€—</h3><ul>
<li>å¢åŠ æ‰¹é‡å¤§å°ä¸ä¹‹ç›¸å…³çš„èµ„æºæˆæœ¬æœ‰ä¸¤ç§ç±»å‹ï¼š<ol>
<li><em>é¢„ä»˜è´¹ç”¨</em>ï¼Œä¾‹å¦‚è´­ä¹°æ–°ç¡¬ä»¶æˆ–é‡å†™è®­ç»ƒç®¡é“ä»¥å®ç°å¤šGPU/å¤šTPUè®­ç»ƒã€‚</li>
<li><em>ä½¿ç”¨è´¹ç”¨</em>ï¼Œä¾‹å¦‚å¯¹å›¢é˜Ÿèµ„æºé¢„ç®—è¿›è¡Œè®¡è´¹ï¼Œäº‘æä¾›å•†æ”¶è´¹ï¼Œç”µè´¹/ç»´æŠ¤è´¹ç”¨ã€‚</li>
</ol>
</li>
<li>å¦‚æœå¢åŠ æ‰¹é‡å¤§å°ä¼šå¸¦æ¥æ˜¾ç€çš„å‰æœŸæˆæœ¬ï¼Œé‚£ä¹ˆæœ€å¥½æ¨è¿Ÿå¢åŠ æ‰¹é‡å¤§å°ï¼Œç›´åˆ°é¡¹ç›®å·²æˆç†Ÿï¼Œå¹¶ä¸”æ›´å®¹æ˜“è¯„ä¼°æˆæœ¬æ•ˆç›Šæƒè¡¡ã€‚ å®æ–½å¤šä¸»æœºå¹¶è¡Œè®­ç»ƒç¨‹åºå¯èƒ½ä¼šå¼•å…¥é”™è¯¯å’Œå¾®å¦™çš„é—®é¢˜ï¼Œå› æ­¤å¯èƒ½æœ€å¥½ä»ä¸€ä¸ªæ›´ç®€å•çš„ç®¡é“å¼€å§‹ã€‚ï¼ˆå¦ä¸€æ–¹é¢ï¼Œè®­ç»ƒæ—¶é—´çš„å¤§å¹…åŠ é€Ÿå¯èƒ½åœ¨å¤§é‡è°ƒæ•´å®éªŒéœ€è¦æ—¶å¾ˆæœ‰ç›Šã€‚ï¼‰</li>
<li>æˆ‘ä»¬å°†æ€»ä½¿ç”¨æˆæœ¬ï¼ˆå¯èƒ½åŒ…æ‹¬å¤šç§ä¸åŒç±»å‹çš„æˆæœ¬ï¼‰ç§°ä¸ºâ€œèµ„æºæ¶ˆè€—â€ã€‚ æˆ‘ä»¬å¯ä»¥å°†èµ„æºæ¶ˆè€—åˆ†è§£ä¸ºä»¥ä¸‹ç»„ä»¶ï¼š</li>
</ul>
<p>èµ„æºæ¶ˆè€—=ï¼ˆæ¯æ­¥èµ„æºæ¶ˆè€—ï¼‰xï¼ˆæ€»æ­¥æ•°ï¼‰</p>
<ul>
<li>å¢åŠ æ‰¹é‡å¤§å°é€šå¸¸å…è®¸æˆ‘ä»¬å‡å°‘æ€»æ­¥æ•°ã€‚ èµ„æºæ¶ˆè€—æ˜¯å¢åŠ è¿˜æ˜¯å‡å°‘å°†å–å†³äºæ¯æ­¥æ¶ˆè€—å¦‚ä½•æ”¹å˜ã€‚<ul>
<li>å¢åŠ æ‰¹é‡å¤§å°å¯èƒ½ä¼š<em>å‡å°‘</em>èµ„æºæ¶ˆè€—ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨è¾ƒå¤§æ‰¹é‡å¤§å°çš„æ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥åœ¨ä¸è¾ƒå°æ‰¹é‡å¤§å°ç›¸åŒçš„ç¡¬ä»¶ä¸Šè¿è¡Œï¼ˆä»…æ¯æ­¥æ—¶é—´ç¨æœ‰å¢åŠ ï¼‰</li>
<li>å¢åŠ æ‰¹é‡å¤§å°å¯èƒ½<em>ä¸ä¼šæ”¹å˜</em>èµ„æºæ¶ˆè€—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°†æ‰¹é‡å¤§å°ç¿»å€ï¼Œå¯ä»¥å‡å°‘æ‰€éœ€æ­¥éª¤çš„ä¸€åŠï¼Œå¹¶ä½¿ç”¨ä¸¤å€çš„GPUï¼Œæ€»æ¶ˆè€—ï¼ˆä»¥GPUå°æ—¶ä¸ºå•ä½ï¼‰å°†ä¸ä¼šæ”¹å˜ã€‚</li>
<li>å¢åŠ æ‰¹é‡å¤§å°å¯èƒ½ä¼š<em>å¢åŠ </em>èµ„æºæ¶ˆè€—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¢åŠ æ‰¹é‡å¤§å°éœ€è¦å‡çº§ç¡¬ä»¶ï¼Œæ¯æ­¥çš„æ¶ˆè€—å¢åŠ å¯èƒ½ä¼šè¶…è¿‡æ­¥éª¤æ•°é‡çš„å‡å°‘ã€‚</li>
</ul>
</li>
</ul>
<h3 id="æ›´æ”¹æ‰¹é‡å¤§å°éœ€è¦é‡æ–°è°ƒæ•´å¤§å¤šæ•°è¶…å‚æ•°"><a href="#æ›´æ”¹æ‰¹é‡å¤§å°éœ€è¦é‡æ–°è°ƒæ•´å¤§å¤šæ•°è¶…å‚æ•°" class="headerlink" title="æ›´æ”¹æ‰¹é‡å¤§å°éœ€è¦é‡æ–°è°ƒæ•´å¤§å¤šæ•°è¶…å‚æ•°"></a>æ›´æ”¹æ‰¹é‡å¤§å°éœ€è¦é‡æ–°è°ƒæ•´å¤§å¤šæ•°è¶…å‚æ•°</h3><ul>
<li>å¤§å¤šæ•°è¶…å‚æ•°çš„æœ€ä½³å€¼å¯¹æ‰¹é‡å¤§å°æ•æ„Ÿã€‚ å› æ­¤ï¼Œæ›´æ”¹æ‰¹é‡å¤§å°é€šå¸¸éœ€è¦é‡æ–°å¼€å§‹è°ƒæ•´è¿‡ç¨‹ã€‚</li>
<li>ä¸æ‰¹é‡å¤§å°æœ€å¯†åˆ‡ç›¸å…³çš„è¶…å‚æ•°ï¼Œå› æ­¤æœ€é‡è¦çš„æ˜¯ä¸ºæ¯ä¸ªæ‰¹é‡å¤§å°å•ç‹¬è°ƒæ•´ï¼Œæ˜¯ä¼˜åŒ–å™¨è¶…å‚æ•°ï¼ˆä¾‹å¦‚å­¦ä¹ ç‡ï¼ŒåŠ¨é‡ï¼‰å’Œæ­£åˆ™åŒ–è¶…å‚æ•°ã€‚</li>
<li>åœ¨é€‰æ‹©é¡¹ç›®å¼€å§‹æ—¶çš„æ‰¹é‡å¤§å°æ—¶è¦ç‰¢è®°è¿™ä¸€ç‚¹ã€‚ å¦‚æœæ‚¨ç¨åéœ€è¦åˆ‡æ¢åˆ°ä¸åŒçš„æ‰¹é‡å¤§å°ï¼Œåˆ™é‡æ–°è°ƒæ•´æ‰€æœ‰å†…å®¹ä»¥é€‚åº”æ–°æ‰¹é‡å¤§å°å¯èƒ½å¾ˆå›°éš¾ï¼Œè€—æ—¶ä¸”æ˜‚è´µã€‚</li>
</ul>
<h3 id="æ‰¹é‡å½’ä¸€åŒ–å¦‚ä½•ä¸æ‰¹é‡å¤§å°äº¤äº’"><a href="#æ‰¹é‡å½’ä¸€åŒ–å¦‚ä½•ä¸æ‰¹é‡å¤§å°äº¤äº’" class="headerlink" title="æ‰¹é‡å½’ä¸€åŒ–å¦‚ä½•ä¸æ‰¹é‡å¤§å°äº¤äº’"></a>æ‰¹é‡å½’ä¸€åŒ–å¦‚ä½•ä¸æ‰¹é‡å¤§å°äº¤äº’</h3><p>æ‰¹é‡å½’ä¸€åŒ–å¾ˆå¤æ‚ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä½¿ç”¨ä¸åŒäºæ¢¯åº¦è®¡ç®—çš„æ‰¹é‡å¤§å°æ¥è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ã€‚ æœ‰å…³è¯¦ç»†è®¨è®ºï¼Œè¯·å‚è§<a href="https://github.com/google-research/tuning_playbook#batch-normalization-implementation-details">æ‰¹é‡å½’ä¸€åŒ–éƒ¨åˆ†</a></p>
<h2 id="é€‰æ‹©åˆå§‹é…ç½®"><a href="#é€‰æ‹©åˆå§‹é…ç½®" class="headerlink" title="é€‰æ‹©åˆå§‹é…ç½®"></a>é€‰æ‹©åˆå§‹é…ç½®</h2><ul>
<li>åœ¨å¼€å§‹è¶…å‚æ•°è°ƒæ•´ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®å®šèµ·ç‚¹ã€‚ è¿™åŒ…æ‹¬æŒ‡å®šï¼ˆ1ï¼‰æ¨¡å‹é…ç½®ï¼ˆä¾‹å¦‚å±‚æ•°ï¼‰ï¼Œï¼ˆ2ï¼‰ä¼˜åŒ–å™¨è¶…å‚æ•°ï¼ˆä¾‹å¦‚å­¦ä¹ ç‡ï¼‰ä»¥åŠï¼ˆ3ï¼‰è®­ç»ƒæ­¥éª¤æ•°ã€‚</li>
<li>ç¡®å®šæ­¤åˆå§‹é…ç½®å°†éœ€è¦ä¸€äº›æ‰‹åŠ¨é…ç½®çš„è®­ç»ƒè¿è¡Œå’Œè¯•é”™ã€‚</li>
<li>æˆ‘ä»¬çš„æŒ‡å¯¼åŸåˆ™æ˜¯æ‰¾åˆ°ä¸€ä¸ªç®€å•ï¼Œç›¸å¯¹å¿«é€Ÿï¼Œç›¸å¯¹ä½èµ„æºæ¶ˆè€—çš„é…ç½®ï¼Œå¯ä»¥è·å¾—â€œåˆç†â€çš„ç»“æœã€‚<ul>
<li>â€œç®€å•â€æ„å‘³ç€å°½å¯èƒ½é¿å…èŠ±å“¨çš„ä¸œè¥¿ï¼›è¿™äº›éƒ½å¯ä»¥ç¨åæ·»åŠ ã€‚ å³ä½¿èŠ±å“¨çš„ä¸œè¥¿æœ€ç»ˆè¯æ˜æœ‰å¸®åŠ©ï¼Œåœ¨åˆå§‹é…ç½®ä¸­æ·»åŠ å®ƒä»¬ä¹Ÿä¼šæµªè´¹æ—¶é—´æ¥è°ƒæ•´æ— ç”¨çš„åŠŸèƒ½ï¼Œæˆ–è€…åˆå¹¶ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚<ul>
<li>ä¾‹å¦‚ï¼Œå…ˆä½¿ç”¨æ’å®šçš„å­¦ä¹ ç‡ï¼Œç„¶åå†æ·»åŠ èŠ±å“¨çš„è¡°å‡è®¡åˆ’ã€‚</li>
</ul>
</li>
<li>é€‰æ‹©å¿«é€Ÿä¸”èµ„æºæ¶ˆè€—æœ€å°çš„åˆå§‹é…ç½®å°†ä½¿è¶…å‚æ•°è°ƒæ•´æ›´åŠ é«˜æ•ˆã€‚<ul>
<li>ä¾‹å¦‚ï¼Œä»è¾ƒå°çš„æ¨¡å‹å¼€å§‹ã€‚</li>
</ul>
</li>
<li>â€œåˆç†â€çš„æ€§èƒ½å–å†³äºé—®é¢˜ï¼Œä½†è‡³å°‘æ„å‘³ç€è®­ç»ƒçš„æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„è¡¨ç°è¦å¥½å¾—å¤šï¼Œæ¯”éšæœºæœºä¼šå¥½ï¼ˆå°½ç®¡å®ƒå¯èƒ½è¶³å¤Ÿç³Ÿç³•ï¼Œä¸å€¼å¾—éƒ¨ç½²ï¼‰ã€‚</li>
</ul>
</li>
<li>é€‰æ‹©è®­ç»ƒæ­¥éª¤æ•°é‡æ¶‰åŠä»¥ä¸‹è€ƒé‡ï¼š<ul>
<li>ä¸€æ–¹é¢ï¼Œè®­ç»ƒæ›´å¤šæ­¥éª¤å¯ä»¥æé«˜æ€§èƒ½ï¼Œå¹¶ä½¿è¶…å‚æ•°è°ƒæ•´æ›´å®¹æ˜“ï¼ˆè¯·å‚è§<a href="https://arxiv.org/abs/1811.03600">Shallue et al. 2018</a>ï¼‰ã€‚</li>
<li>å¦ä¸€æ–¹é¢ï¼Œè®­ç»ƒæ­¥éª¤è¾ƒå°‘æ„å‘³ç€æ¯æ¬¡è®­ç»ƒè¿è¡Œæ›´å¿«ï¼Œä½¿ç”¨çš„èµ„æºæ›´å°‘ï¼Œé€šè¿‡å‡å°‘å‘¨æœŸä¹‹é—´çš„æ—¶é—´æ¥æé«˜è°ƒæ•´æ•ˆç‡ï¼Œå¹¶å…è®¸å¹¶è¡Œè¿è¡Œæ›´å¤šå®éªŒã€‚æ­¤å¤–ï¼Œå¦‚æœæœ€åˆé€‰æ‹©äº†ä¸å¿…è¦çš„å¤§æ­¥éª¤é¢„ç®—ï¼Œåˆ™å¯èƒ½å¾ˆéš¾åœ¨ä»¥åæ›´æ”¹å®ƒï¼Œä¾‹å¦‚ä¸€æ—¦ä¸ºè¯¥æ­¥æ•°è°ƒæ•´äº†å­¦ä¹ ç‡è®¡åˆ’ã€‚</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Deep Learning Tuning Playbook</tag>
      </tags>
  </entry>
  <entry>
    <title>Exploiting Completeness and Uncertainty of Pseudo Labels</title>
    <url>/posts/d2ac8e77/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="Exploiting-Completeness-and-Uncertainty-of-Pseudo-Labels"><a href="#Exploiting-Completeness-and-Uncertainty-of-Pseudo-Labels" class="headerlink" title="Exploiting Completeness and Uncertainty of Pseudo Labels"></a>Exploiting Completeness and Uncertainty of Pseudo Labels</h1><p><a href="https://arxiv.org/abs/2212.04090">[2212.04090] Exploiting Completeness and Uncertainty of Pseudo Labels for Weakly Supervised Video Anomaly Detection (arxiv.org)</a>(CVPR 2022.10)</p>
<aside>
ğŸ’¡ è¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ç§åˆ©ç”¨ä¼ªæ ‡ç­¾çš„å®Œæ•´æ€§å’Œä¸ç¡®å®šæ€§çš„å¼±ç›‘ç£è§†é¢‘å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚å®ƒç”±ä¸€ä¸ªå®Œæ•´æ€§å¢å¼ºçš„ä¼ªæ ‡ç­¾ç”Ÿæˆå™¨ç»„æˆï¼Œè¯¥ç”Ÿæˆå™¨ä½¿ç”¨3D CNNæå–è§†é¢‘ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨å¤šå¤´åˆ†ç±»å™¨è®­ç»ƒå¤šæ ·æ€§æŸå¤±å’ŒMILæ’åºæŸå¤±æ¥ç”Ÿæˆåˆå§‹ä¼ªæ ‡ç­¾ï¼Œä»¥åŠä¸€ä¸ªè¿­ä»£çš„ä¸ç¡®å®šæ€§æ„ŸçŸ¥ä¼ªæ ‡ç­¾ç»†åŒ–ç­–ç•¥ï¼Œè¯¥ç­–ç•¥ä½¿ç”¨è’™ç‰¹å¡ç½—ï¼ˆMCï¼‰ä¸¢å¤±æ¥æµ‹é‡ä¸ç¡®å®šæ€§ï¼Œå¹¶é€æ¸ç»†åŒ–ä¼ªæ ‡ç­¾ä»¥è®­ç»ƒæ‰€éœ€çš„åˆ†ç±»å™¨ã€‚ UCF-Crimeï¼ŒTADå’ŒXD-Violenceçš„å®éªŒè¡¨æ˜ï¼Œä¸å‡ ç§æœ€å…ˆè¿›çš„æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒçš„æ€§èƒ½è‰¯å¥½ã€‚
</aside>

<span id="more"></span>
<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><hr>
<h3 id="ç°æœ‰æ–¹æ³•"><a href="#ç°æœ‰æ–¹æ³•" class="headerlink" title="ç°æœ‰æ–¹æ³•"></a>ç°æœ‰æ–¹æ³•</h3><p>paperå°†ç°æœ‰çš„å¼±ç›‘ç£æ–¹æ³•åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>MIL</li>
<li>two-stage self-training</li>
</ul>
<p>åŸºäºMILçš„æ–¹æ³•ç”±äºç¼ºå°‘clip-levelçš„æ ‡æ³¨ï¼Œå¾—åˆ°çš„å¼‚å¸¸åˆ†æ•°å¸¸å¸¸æ˜¯è¾ƒä¸ºä¸ç²¾ç¡®çš„ã€‚è€Œtwo-stage self-training æ–¹æ³•çš„æå‡ºå¯ä»¥ç¼“è§£è¯¥é—®é¢˜ã€‚</p>
<p>two-stage self-training[5,12]</p>
<ol>
<li>åŸºäºMILæ–¹æ³•ä¸ºclipsç”Ÿæˆä¼ªæ ‡ç­¾(pseudo labelsï¼‰</li>
<li>ç”¨ä¼ªæ ‡ç­¾å»ç²¾ç»†åŒ–åˆ¤åˆ«è¡¨ç¤º</li>
</ol>
<h3 id="limitations"><a href="#limitations" class="headerlink" title="limitations"></a>limitations</h3><p>é’ˆå¯¹two-stage self training çš„ <strong>Completeness and Uncertainty of Pseudo Labels</strong></p>
<ul>
<li><p>ç”¨äºä¼ªæ ‡ç­¾ç”Ÿæˆçš„ranking loss å¿½ç•¥å¼‚å¸¸äº‹ä»¶çš„å®Œæ•´æ€§</p>
<p>â€œä¸€ä¸ªæ­£è¢‹å¯èƒ½åŒ…å«å¤šä¸ªå¼‚å¸¸äº‹ä»¶ç‰‡æ®µï¼Œï¼Œä½†æ˜¯MILåªä¼šæ£€æµ‹åˆ°æœ€åƒçš„ä¸€ä¸ªã€‚â€(really?)</p>
<p><img src="/posts/d2ac8e77/Untitled.png" alt></p>
<p>æ©˜è‰²éƒ¨åˆ†ä»£è¡¨ground truth, ç°æœ‰çš„æ–¹æ³•å¦‚bæ‰€ç¤ºï¼Œå…³æ³¨åœ¨æœ€å¼‚å¸¸çš„ç‰‡æ®µã€‚å› æ­¤ï¼Œæå‡ºä½¿ç”¨åŸºäºdiversity lossçš„å¤šå¤´åˆ†ç±»æ¨¡å—ï¼Œä»¥ç”Ÿæˆèƒ½å¤Ÿè¦†ç›–å®Œæ•´å¼‚å¸¸äº‹ä»¶çš„ä¼ªæ ‡ç­¾ï¼ˆå¦‚cæ‰€ç¤ºï¼‰</p>
</li>
<li><p>åœ¨ç¬¬äºŒæ­¥ä¸­  ç”Ÿæˆä¼ªæ ‡ç­¾çš„ä¸ç¡®å®šæ€§ æœªè¢«è€ƒè™‘</p>
<p>ä¼ªæ ‡ç­¾é€šå¸¸æ˜¯æœ‰å™ªå£°çš„ï¼Œç›´æ¥ä½¿ç”¨è¿›è¡Œæœ€ååˆ†ç±»æ¨¡å‹çš„è®­ç»ƒå¯èƒ½æŸå®³æ¨¡å‹æ€§èƒ½è¡¨ç°ã€‚</p>
</li>
</ul>
<h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>åˆ†åˆ«é’ˆå¯¹ä¸¤ä¸ªlimitations</p>
<ul>
<li>æå‡ºå¤šå¤´æ¨¡å—ç”Ÿæˆä¼ªæ ‡ç­¾ï¼Œå¼•å…¥diversity lossä»¥ç¡®ä¿å¤šä¸ªåˆ†ç±»å¤´ç”Ÿæˆçš„ä¼ªæ ‡ç­¾çš„åˆ†å¸ƒå·®å¼‚â†’ ç¡®ä¿å¼‚å¸¸äº‹ä»¶çš„å®Œæ•´æ€§æ£€æµ‹ ï¼ˆå¯¹åº”step1)<ul>
<li>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¯ä¸€ä¸ªå¤´å€¾å‘äºå‘ç°ä¸åŒçš„å¼‚å¸¸äº‹ä»¶ï¼Œå› æ­¤å¯ä»¥è®©ä¼ªæ ‡ç­¾å°½å¯èƒ½è¦†ç›–æ›´å¤šçš„å¼‚å¸¸äº‹ä»¶</li>
</ul>
</li>
<li>è®¾è®¡ä¸€ä¸ªè¿­ä»£çš„åŸºäºä¸ç¡®å®šæ€§çš„è®­ç»ƒç­–ç•¥ ï¼ˆå¯¹åº”step2)<ul>
<li>ä½¿ç”¨Monte Carlo(MC) Dropout åº¦é‡ä¸ç¡®å®šæ€§</li>
<li>å°†ä½ä¸ç¡®å®šæ€§çš„ç‰‡æ®µç”¨äºæœ€ååˆ†ç±»å™¨çš„è®­ç»ƒ (è¯¥è¿‡ç¨‹é€æ¸è¿­ä»£ç»†åŒ–ä¼ªæ ‡ç­¾ï¼‰<ul>
<li>ç¬¬ä¸€æ¬¡è¿­ä»£  ç»†åŒ– step1ç”Ÿæˆçš„ä¼ªæ ‡ç­¾</li>
<li>å‰©ä½™çš„è¿­ä»£ç»†åŒ–åˆ†ç±»å™¨æ¯æ¬¡è¿­ä»£çš„è¾“å‡ºä¼ªæ ‡ç­¾</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ul>
<li>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªåŸºäºå¤šæ ·æ€§æŸå¤±çš„å¤šå¤´åˆ†ç±»å™¨æ–¹æ¡ˆï¼Œä½¿å¾—ä¼ªæ ‡ç­¾è¦†ç›–å°½å¯èƒ½å¤šçš„å¼‚å¸¸ç‰‡æ®µã€‚</li>
<li>æˆ‘ä»¬è®¾è®¡äº†ä¸€ç§è¿­ä»£çš„ä¸ç¡®å®šæ€§æ„ŸçŸ¥çš„è‡ªæˆ‘è®­ç»ƒç­–ç•¥ï¼Œä»¥é€æ­¥æé«˜ä¼ªæ ‡ç­¾çš„è´¨é‡ã€‚</li>
<li>åœ¨UCF-Crimeã€TADå’ŒXD-Violenceä¸Šè¿›è¡Œçš„å®éªŒè¡¨æ˜ï¼Œä¸å‡ ç§æœ€å…ˆè¿›çš„æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒå…·æœ‰è‰¯å¥½çš„æ€§èƒ½ã€‚</li>
</ul>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><hr>
<p><img src="/posts/d2ac8e77/Untitled 1.png" alt></p>
<p>1)  ä½¿ç”¨é¢„è®­ç»ƒçš„3D CNNæ¨¡å‹æå–è§†é¢‘ç‰¹å¾ï¼ˆpaperä½¿ç”¨çš„æ˜¯I3Dï¼‰</p>
<p>2ï¼‰ç»è¿‡å¤šæ ·æ€§æŸå¤±å’ŒMILæ’åºæŸå¤±è®­ç»ƒçš„å¤šå¤´åˆ†ç±»å™¨æ¥ç”Ÿæˆåˆå§‹çš„ç‰‡æ®µä¼ªæ ‡ç­¾</p>
<p>3ï¼‰åˆ©ç”¨ä¸€ä¸ªè¿­ä»£çš„ä¸ç¡®å®šæ€§æ„ŸçŸ¥çš„ä¼ªæ ‡ç­¾ç»†åŒ–ç­–ç•¥ï¼Œ é€æ­¥æé«˜ä¼ªæ ‡ç­¾çš„è´¨é‡ï¼Œè®­ç»ƒæœ€ç»ˆæœŸæœ›çš„åˆ†ç±»å™¨ã€‚</p>
<blockquote>
<p>Completeness Enhanced Pseudo Label Generator<br>ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„3D CNNæ¥æå–è§†é¢‘ç‰¹å¾ã€‚å°†è¿™äº›ç‰¹å¾è¾“å…¥å—å¤šæ ·æ€§æŸå¤±çº¦æŸçš„å¤šå¤´åˆ†ç±»å™¨ï¼Œä»¥æ£€æµ‹å®Œæ•´çš„å¼‚å¸¸äº‹ä»¶ã€‚</p>
</blockquote>
<p>Iterative Uncertainty Aware Pseudo Label Refinement<br>åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬ä»first stageçš„å¤šå¤´åˆ†ç±»å™¨ä¸­è·å¾—åˆå§‹çš„clipçº§ä¼ªæ ‡ç­¾ï¼Œå¹¶é€šè¿‡Monte Carlo Dropoutè®¡ç®—å…¶ä¸ç¡®å®šæ€§ã€‚ç„¶åæ ¹æ®ä¸ç¡®å®šæ€§é€‰æ‹©å¯é çš„ç‰‡æ®µæ¥è®­ç»ƒä¸€ä¸ªæ–°çš„ç‰‡æ®µåˆ†ç±»å™¨ã€‚åœ¨å‰©ä¸‹çš„è¿­ä»£ä¸­ï¼Œä½¿ç”¨æ–°çš„ç‰‡æ®µåˆ†ç±»å™¨æ›´æ–°ä¼ªæ ‡ç­¾ã€‚</p>
<blockquote>
</blockquote>
<h3 id="Completeness-of-Pseudo-Labels"><a href="#Completeness-of-Pseudo-Labels" class="headerlink" title="Completeness of Pseudo Labels"></a><strong>Completeness of Pseudo Labels</strong></h3><p>ä¼ªæ ‡ç­¾ç”Ÿæˆå™¨ç”±å¹¶è¡Œçš„å¤šå¤´åˆ†ç±»å™¨ç»„æˆã€‚each headç”±ä¸‰ä¸ªå…¨è¿æ¥å±‚ç»„æˆ</p>
<p><img src="/posts/d2ac8e77/Untitled 2.png" alt></p>
<ul>
<li>diversity loss</li>
</ul>
<p>each headè¾“å‡ºæ¯ä¸ªç‰‡æ®µçš„å¼‚å¸¸åˆ†æ•°ï¼Œå¹¶é€šè¿‡softmaxç”Ÿæˆåˆ†æ•°çš„åˆ†å¸ƒï¼š</p>
<p><img src="/posts/d2ac8e77/Untitled 3.png" alt></p>
<p>é€šè¿‡å¤šæ ·æ€§æŸå¤±ï¼ˆdiversity loss) å°†å±äºä¸åŒheadçš„åˆ†æ•°åˆ†å¸ƒäº’ç›¸åŒºåˆ†å¼€æ¥â† é€šè¿‡æœ€å°åŒ–ä»»æ„ä¸¤å¤´ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦</p>
<p><img src="/posts/d2ac8e77/Untitled 4.png" alt></p>
<ul>
<li>regularization term</li>
</ul>
<p>ç‰‡æ®µåˆ†æ•°åºåˆ—çš„æ­£åˆ™åŒ–é¡¹ï¼šå¹³è¡¡å¤šå¤´å¹¶é¿å…ç”±äºä¸€å¤´å ä¸»å¯¼åœ°ä½å¯¼è‡´çš„æ€§èƒ½ä¸‹é™</p>
<p><img src="/posts/d2ac8e77/Untitled 5.png" alt></p>
<p>åœ¨å¤šæ ·æ€§æŸå¤±å’ŒèŒƒæ•°æ­£åˆ™åŒ–çš„ä½œç”¨ä¸‹ï¼Œå¤šå¤´äº§ç”Ÿçš„å¼‚å¸¸å¾—åˆ†å¯ä»¥è¾¾åˆ°æœ€å¤§çš„åŒºåˆ«ï¼Œå¹¶èƒ½å¤Ÿæ£€æµ‹ä¸åŒçš„å¼‚å¸¸ç‰‡æ®µã€‚</p>
<p>sigmoidæ‰€æœ‰å¤´å¼‚å¸¸åˆ†æ•°çš„å¹³å‡å¾—åˆ°ç‰‡æ®µçº§çš„æ ‡ç­¾</p>
<p><img src="/posts/d2ac8e77/Untitled 6.png" alt></p>
<ul>
<li><p>ranking loss</p>
<p>æœ€å¤§åŒ–å¼‚å¸¸å’Œæ­£å¸¸å®ä¾‹çš„å·®è·</p>
</li>
</ul>
<p><img src="/posts/d2ac8e77/Untitled 7.png" alt></p>
<h3 id="Uncertainty-of-Pseudo-Labels"><a href="#Uncertainty-of-Pseudo-Labels" class="headerlink" title="Uncertainty of Pseudo Labels"></a><strong>Uncertainty of Pseudo Labels</strong></h3><p>ä¸ºäº†è®­ç»ƒæœ€ç»ˆæœŸæœ›çš„ç‰‡æ®µåˆ†ç±»å™¨fcï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨åœ¨step1è·å¾—çš„ç‰‡æ®µçº§ä¼ªæ ‡ç­¾ æå‡ºäº†ä¸€ç§ä¸ç¡®å®šæ€§æ„ŸçŸ¥çš„è‡ªè®­ç»ƒç­–ç•¥æŒ–æ˜å…·æœ‰å¯é ä¼ªæ ‡ç­¾çš„ç‰‡æ®µã€‚</p>
<p>å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬å¼•å…¥äº†åˆ©ç”¨Monte Carlo Dropout çš„ä¸ç¡®å®šæ€§ä¼°è®¡ï¼Œä»è€Œé€‰æ‹©å…·æœ‰ä½ä¸ç¡®å®šæ€§ï¼ˆå³å¯é çš„ï¼‰ä¼ªæ ‡ç­¾çš„ç‰‡æ®µè¿›è¡Œè®­ç»ƒfcã€‚è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œäº†å‡ æ¬¡è¿­ä»£ã€‚ä¼ªæ ‡ç­¾æœ€åˆæ˜¯åœ¨ç¬¬ä¸€é˜¶æ®µè·å¾—çš„ï¼Œç„¶åè¿›è¡Œç»ç”±fcæ›´æ–°ã€‚</p>
<p><img src="/posts/d2ac8e77/Untitled 8.png" alt></p>
<h2 id="Experimental-Results"><a href="#Experimental-Results" class="headerlink" title="Experimental Results"></a>Experimental Results</h2><p><img src="/posts/d2ac8e77/Untitled 9.png" alt></p>
<p><img src="/posts/d2ac8e77/Untitled 10.png" alt="Untitled"></p>
<p><img src="/posts/d2ac8e77/Untitled 11.png" alt></p>
<p>æ¶ˆèå®éªŒ</p>
<p><img src="/posts/d2ac8e77/Untitled 12.png" alt></p>
<p>è¶…å‚åˆ†æ</p>
<p><img src="/posts/d2ac8e77/Untitled 13.png" alt></p>
<p>æœ€å¥½çš„ç»“æœæ˜¯åŒå¤´</p>
]]></content>
      <categories>
        <category>è®ºæ–‡é˜…è¯»</category>
      </categories>
      <tags>
        <tag>å¼±ç›‘ç£å­¦ä¹ </tag>
        <tag>VAD</tag>
      </tags>
  </entry>
  <entry>
    <title>zero-shot</title>
    <url>/posts/2ac833a5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><blockquote>
<p>Zero-shot is the natural <em>best-case scenario</em> for a model as it means we require <em>zero</em> training samples before shifting it to a new domain or task.<br>zero-shotæ˜¯ä¸€ä¸ªæ¨¡å‹çš„è‡ªç„¶æœ€ä½³æƒ…å†µï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘ä»¬å°†å…¶è¿ç§»åˆ°æ–°çš„é¢†åŸŸæˆ–è€…ä»»åŠ¡æ—¶éœ€è¦é›¶ä¸ªè®­ç»ƒæ ·æœ¬</p>
</blockquote>
<span id="more"></span>
<h2 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h2><p>Sotaçš„CVæ¨¡å‹åœ¨ç‰¹å®šçš„ä»»åŠ¡å’Œæ•°æ®é›†ä¸­è¡¨ç°è‰¯å¥½ï¼Œä½†æ˜¯ä¸èƒ½å¾ˆå¥½çš„æ³›åŒ–ï¼Œä»–ä»¬æ— æ³•å¤„ç†åœ¨ä»–ä»¬å·²ç»è®­ç»ƒè¿‡çš„é¢†åŸŸä¹‹å¤–çš„æ–°çš„ç±»åˆ«æˆ–è€…å›¾ç‰‡ã€‚æ”¶é›†è¶³å¤Ÿå¤§çš„æ ‡è®°æ•°æ®é›†ä»¥ä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•å¯¹è¿™äº›ä¸“ä¸šç”¨ä¾‹çš„CVæ¨¡å‹è¿›è¡Œå¾®è°ƒå¯èƒ½éå¸¸å›°éš¾ã€‚</p>
<p>ç†æƒ³æƒ…å†µä¸‹ï¼ŒCVæ¨¡å‹åº”è¯¥å­¦ä¹ å›¾åƒçš„å†…å®¹ï¼Œè€Œä¸æ˜¯è¿‡åˆ†å…³æ³¨æœ€åˆè®­ç»ƒç†è§£çš„ç‰¹å®šæ ‡ç­¾ã€‚æ¯”å¦‚ï¼Œå¯¹äºç‹—çš„å›¾åƒï¼Œæ¨¡å‹åº”è¯¥ç†è§£â€œç‹—åœ¨å›¾åƒä¸­â€ï¼Œå½“ç„¶é‚£ï¼Œå¦‚æœå®ƒèƒ½ç†è§£èƒŒæ™¯ä¸­æœ‰æ ‘æœ¨ã€ç°åœ¨åœ¨ç™½å¤©ã€ç‹—åœ¨è‰åœ°ä¸Šï¼Œé‚£å°†æ›´åŠ æœ‰ç”¨ã€‚</p>
<p>åˆ†ç±»è®­ç»ƒçš„ç»“æœæ°æ°ä¸è¯¥ç†æƒ³æƒ…å†µç›¸åã€‚æ¨¡å‹å­¦ä¹ å°†ç‹—çš„internal representationæ”¾åˆ°ç›¸åŒçš„â€œç‹—å‘é‡ç©ºé—´â€ï¼Œå°†çŒ«çš„æ”¾åˆ°ç›¸åŒçš„â€œçŒ«å‘é‡ç©ºé—´â€ã€‚ä»–ä»¬å…³æ³¨çš„ç‚¹åœ¨äºå›¾ç‰‡æ˜¯å¦ä¸ç±»åŒ¹é…çš„yes or noã€‚</p>
<p>é‡æ–°è®­ç»ƒåˆ†ç±»æ¨¡å‹æ˜¯ä¸€ç§é€‰æ‹©ï¼Œä½†æ˜¯éœ€è¦å¤§é‡çš„æ—¶é—´å’Œæˆæœ¬æŠ•å…¥ï¼šæ”¶é›†ä¸€ä¸ªåˆ†ç±»æ•°æ®é›†å’Œæ¨¡å‹è®­ç»ƒè¿‡ç¨‹æœ¬èº«ã€‚</p>
<h2 id="N-shotå’ŒZero-shot"><a href="#N-shotå’ŒZero-shot" class="headerlink" title="N-shotå’ŒZero-shot"></a>N-shotå’ŒZero-shot</h2><h3 id="N-shot-learning"><a href="#N-shot-learning" class="headerlink" title="N-shot learning"></a>N-shot learning</h3><blockquote>
<p>Here we define <em>N</em> as the number of samples required to train a model to begin making predictions in a new domain or on a new task.</p>
</blockquote>
<p>å®šä¹‰Nä¸º  ä¸ºäº†åœ¨æ–°é¢†åŸŸæˆ–è€…æ–°ä»»åŠ¡è¿›è¡Œé¢„æµ‹ è€Œéœ€è¦ç”¨äºè®­ç»ƒä¸€ä¸ªæ¨¡å‹çš„æ ·æœ¬æ•°é‡ã€‚</p>
<p>å¦‚ä»Šï¼Œè®¸å¤šSotAæ¨¡å‹éƒ½æ˜¯åœ¨ResNetæˆ–BERTç­‰ç”¨å¤§é‡æ•°æ®ä¸Šè¿›è¡Œé¢„è®­ç»ƒçš„ã€‚ç„¶åé’ˆå¯¹ç‰¹å®šä»»åŠ¡å’Œé¢†åŸŸå¯¹è¿™äº›é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œ<em>å¾®è°ƒ</em>ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://www.pinecone.io/learn/imagenet">ImageNet å¯¹ ResNet</a> æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼Œç„¶åé’ˆå¯¹æœè£…åˆ†ç±»è¿›è¡Œå¾®è°ƒã€‚</p>
<p>åƒ ResNet å’Œ BERT è¿™æ ·çš„æ¨¡å‹è¢«ç§°ä¸º<em>â€œN-shotâ€</em>learnerï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦<em>è®¸å¤š</em>è®­ç»ƒæ ·æœ¬æ‰èƒ½åœ¨æœ€åçš„å¾®è°ƒæ­¥éª¤ä¸­è¾¾åˆ°å¯æ¥å—çš„æ€§èƒ½ã€‚</p>
<p>åªæœ‰å½“æˆ‘ä»¬æœ‰è®¡ç®—ã€æ—¶é—´å’Œæ•°æ®å…è®¸æˆ‘ä»¬å¾®è°ƒæ¨¡å‹æ—¶ï¼ŒN-shot learningæ‰æœ‰å¯èƒ½ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€å¤§é™åº¦åœ°æé«˜æ¨¡å‹æ€§èƒ½ï¼ŒåŒæ—¶æœ€å°åŒ–N-shotè¦æ±‚ã€‚å³æå‡ºZero-shotã€‚</p>
<h3 id="zero-shot"><a href="#zero-shot" class="headerlink" title="zero-shot"></a>zero-shot</h3><p>zero-shotæ˜¯ä¸€ä¸ªæ¨¡å‹çš„è‡ªç„¶æœ€ä½³æƒ…å†µï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘ä»¬å°†å…¶è¿ç§»åˆ°æ–°çš„é¢†åŸŸæˆ–è€…ä»»åŠ¡æ—¶éœ€è¦é›¶ä¸ªè®­ç»ƒæ ·æœ¬ã€‚</p>
<h2 id="Zero-shotå®ç°"><a href="#Zero-shotå®ç°" class="headerlink" title="Zero-shotå®ç°"></a>Zero-shotå®ç°</h2><p>OpenAIçš„CLIPå·²ç»è¯æ˜è‡ªå·±æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„åˆ†ç±»æ¨¡å‹ï¼Œé€šå¸¸éœ€è¦zeroçš„å†è®­ç»ƒã€‚</p>
<p><strong>C</strong>ontrastive <strong>L</strong>anguage-I mage <strong>P</strong>retraining ï¼ˆCLIPï¼‰ æ˜¯ OpenAI äº 2021 å¹´å‘å¸ƒçš„ä¸€ä¸ªä¸»è¦åŸºäºtransformerçš„æ¨¡å‹ [1]ã€‚</p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„ CLIP ç‰ˆæœ¬åŒ…æ‹¬ä¸€ä¸ªç”¨äºç¼–ç æ–‡æœ¬åµŒå…¥çš„æ–‡æœ¬è½¬æ¢å™¨å’Œä¸€ä¸ªç”¨äºç¼–ç å›¾åƒåµŒå…¥çš„è§†è§‰è½¬æ¢å™¨ ï¼ˆViTï¼‰ã€‚</p>
<p>ä¸¤ç§ CLIP æ¨¡å‹éƒ½åœ¨é¢„è®­ç»ƒæœŸé—´è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä»¥å¯¹é½å‘é‡ç©ºé—´ä¸­çš„ç›¸ä¼¼æ–‡æœ¬å’Œå›¾åƒã€‚å®ƒé€šè¿‡è·å–<strong>å›¾åƒæ–‡æœ¬å¯¹</strong> (image-text pairs )å¹¶åœ¨å‘é‡ç©ºé—´ä¸­å°†å…¶è¾“å‡ºå‘é‡æ¨è¿‘ï¼ŒåŒæ—¶åˆ†ç¦»éå¯¹(non-pairs)çš„å‘é‡æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<p><img src="/posts/2ac833a5/image-20230206150750481.png" alt></p>
<p>å®ƒä¸å…¸å‹çš„åˆ†ç±»æ¨¡å‹åŒºåˆ«å¼€æ¥æœ‰å‡ ä¸ªåŸå› ã€‚é¦–å…ˆï¼ŒOpenAIåœ¨ä¸€ä¸ª<strong>ç”±4äº¿æ–‡æœ¬å›¾åƒå¯¹ç»„æˆçš„åºå¤§</strong>æ•°æ®é›†ä¸Šå¯¹å…¶è¿›è¡Œäº†è®­ç»ƒï¼Œè¿™äº›æ•°æ®é›†æ˜¯ä»äº’è”ç½‘ä¸ŠæŠ“å–çš„ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸‰ä¸ªä¸»è¦å¥½å¤„ï¼š</p>
<ol>
<li>CLIPåªéœ€è¦<strong>å›¾åƒ-æ–‡æœ¬å¯¹</strong>ï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„ç±»æ ‡ç­¾ï¼Œè¿™è¦å½’åŠŸäºcontrastiveè€Œä¸æ˜¯classificationçš„è®­ç»ƒåŠŸèƒ½ã€‚åœ¨å½“ä»Šä»¥ç¤¾äº¤åª’ä½“ä¸ºä¸­å¿ƒçš„ä¸–ç•Œä¸­ï¼Œè¿™ç§ç±»å‹çš„æ•°æ®éå¸¸ä¸°å¯Œã€‚</li>
<li>å¤§æ•°æ®é›†å¤§å°æ„å‘³ç€ CLIP å¯ä»¥å¯¹å›¾åƒä¸­æ˜¾ç¤ºçš„ä¸€èˆ¬æ–‡æœ¬æ¦‚å¿µå»ºç«‹æ·±åˆ»çš„ç†è§£ã€‚</li>
<li>æ–‡æœ¬æè¿°ç¬¦é€šå¸¸æè¿°å›¾åƒçš„å„ç§ç‰¹å¾ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç‰¹å¾ã€‚è¿™æ„å‘³ç€å¯ä»¥æ„å»ºå›¾åƒï¼ˆå’Œæ–‡æœ¬ï¼‰çš„æ›´å…¨é¢çš„è¡¨ç¤ºã€‚</li>
</ol>
<p>CLIPçš„è¿™äº›ä¼˜ç‚¹æ˜¯å¯¼è‡´å…¶å‡ºè‰²çš„zero-shotæ€§èƒ½çš„ä¸»è¦å› ç´ ã€‚</p>
<p>æ•°æ®å¯¹æ¯”ï¼š</p>
<p><img src="/posts/2ac833a5/image-20230206151132885.png" alt></p>
<h3 id="zero-shot-classification"><a href="#zero-shot-classification" class="headerlink" title="zero-shot classification"></a>zero-shot classification</h3><p>è¿™äº›<em>â€œç±»â€</em>ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä½œä¸ºå‘é‡ä»æ–‡æœ¬ç¼–ç å™¨åˆ†åˆ«è¾“å‡ºä¸ºT1,T2å’ŒT3ã€‚ç»™å®šä¸€å¼ çŒ«çš„ç…§ç‰‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ ViT æ¨¡å‹å¯¹å…¶è¿›è¡Œç¼–ç ä»¥åˆ›å»ºçŸ¢é‡æˆ‘I1.å½“æˆ‘ä»¬ç”¨ä½™å¼¦ç›¸ä¼¼æ€§è®¡ç®—è¿™äº›å‘é‡çš„ç›¸ä¼¼æ€§æ—¶ï¼Œæˆ‘ä»¬æœŸæœ›simï¼ˆT3ï¼ŒI1ï¼‰è¿”å›æœ€é«˜åˆ†ã€‚</p>
<p><img src="/posts/2ac833a5/image-20230206151357836.png" alt></p>
<h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><p><a href="https://www.pinecone.io/learn/zero-shot-image-classification-clip/">Zero-shot Image Classification with OpenAIâ€™s CLIP | Pinecone</a></p>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç†è®ºè®¤çŸ¥</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡ ä¸ªåŸºç¡€å›¾ç¥ç»ç½‘ç»œ</title>
    <url>/posts/71dd2457/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="GCNã€GraphSAGEå’ŒGAT"><a href="#GCNã€GraphSAGEå’ŒGAT" class="headerlink" title="GCNã€GraphSAGEå’ŒGAT"></a>GCNã€GraphSAGEå’ŒGAT</h1><span id="more"></span>
<h2 id="GCN"><a href="#GCN" class="headerlink" title="GCN"></a>GCN</h2><ul>
<li>å…¬å¼ï¼šï¼ˆIæ˜¯å•ä½çŸ©é˜µï¼‰</li>
</ul>
<p><img src="/posts/71dd2457/image-20221126212953575.png" alt="image-20221126212953575"></p>
<ul>
<li>èšåˆè¿‡ç¨‹</li>
</ul>
<p>åº¦çŸ©é˜µçš„ä½œç”¨ä¸»è¦æ˜¯å½’ä¸€åŒ–ã€‚å¦‚ä¸‹å›¾ï¼ŒGCNèšåˆçš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯å°†é‚»å±…èŠ‚ç‚¹ä¿¡æ¯ç›¸åŠ ã€‚å¦‚èŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2ã€èŠ‚ç‚¹3ç›¸è¿ï¼ŒçŸ©é˜µç›¸ä¹˜çš„ç»“æœæ˜¯ï¼šèŠ‚ç‚¹1çš„ç‰¹å¾=èŠ‚ç‚¹2+èŠ‚ç‚¹3+è‡ªå·±ã€‚</p>
<p><img src="/posts/71dd2457/image-20221126213047435.png" alt="image-20221126213047435"></p>
<ul>
<li>GCNæ“ä½œ</li>
</ul>
<p>å¦‚ä¸‹å›¾æ˜¯ä¸¤å±‚GCNå·ç§¯ï¼šï¼ˆNï¼ŒCï¼‰*ï¼ˆCï¼ŒFï¼‰ =&gt;ï¼ˆNï¼ŒFï¼‰</p>
<p>åˆ†ç±»ï¼š1ï¼‰æœ€åè¾“å‡ºçš„ç»´åº¦ä¸ºåˆ†ç±»çš„ç±»æ•°ï¼›2ï¼‰ä¸ä¸ºåˆ†ç±»çš„ç±»æ•°ï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªç‰¹å¾æå–å™¨ï¼Œ åŠ ä¸Šå…¨è¿æ¥å±‚è¿›è¡Œåˆ†ç±»ã€‚</p>
<p><img src="/posts/71dd2457/image-20221126213249170.png" alt="image-20221126213249170"></p>
<h2 id="GraphSAGE-SAmple-and-aggreGatE"><a href="#GraphSAGE-SAmple-and-aggreGatE" class="headerlink" title="GraphSAGE(SAmple and aggreGatE)"></a>GraphSAGE(SAmple and aggreGatE)</h2><p>æå‡ºå½’çº³å¼çš„graph embeddingæ–¹æ³•ï¼Œä¹‹å‰çš„graph embeddingæ–¹æ³•éƒ½æ˜¯æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨å›¾ä¸­ï¼Œå¯¹äºæ²¡æœ‰<br>çœ‹åˆ°è¿‡çš„èŠ‚ç‚¹æ˜¯ä¸èƒ½å¤„ç†çš„ï¼Œè¿™ç§å«åšç›´æ¨å¼æ–¹æ³•ã€‚<br>è€ŒGraphSAGEè¿™ç§å½’çº³å¼çš„æ–¹æ³•ï¼Œå¯ ä»¥å¯¹äºæ²¡è§è¿‡çš„èŠ‚ç‚¹ä¹Ÿç”Ÿæˆembeddingã€‚<br>GraphSAGEä¸ä»…é™äºæ„å»ºembedding,ä¹Ÿé€šè¿‡èšåˆå‘¨å›´é‚»å±…èŠ‚ç‚¹çš„ç‰¹å¾ã€‚</p>
<h3 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h3><p><img src="/posts/71dd2457/image-20221126212301603.png" alt="image-20221126212301603"></p>
<h3 id="é‚»å±…é‡‡æ ·"><a href="#é‚»å±…é‡‡æ ·" class="headerlink" title="é‚»å±…é‡‡æ ·"></a>é‚»å±…é‡‡æ ·</h3><p>èšåˆé‚»å±…ä¸ªæ•°é‡‡ç”¨å›ºå®šé•¿åº¦kã€‚</p>
<p>å½“k&lt;é‚»å±…æ€»æ•°æ—¶ï¼Œç›´æ¥<code>neighbors = np.random.choice(neighbors,self.max_degree,replace=False)</code></p>
<p>å½“k&gt;é‚»å±…æ•°æ—¶ï¼Œ<code>neighbors = np.random.choice(neighbors,self.max_degree,replace=True)</code> (æ¯”å¦‚å½“é‚»å±…æ•°æ˜¯2ï¼Œè€Œè¦é‡‡æ ·3ä¸ªæ—¶ï¼Œå…ˆå°†2ä¸ªéƒ½æ”¾è¿›æ¥ï¼Œç„¶åå†åœ¨2ä¸ªé‚»å±…é‡Œé¢éšæœºé€‰ä¸€ä¸ªå‡‘ä¸‰ä¸ª)</p>
<p>ä½œè€…å‘ç°è¯¥æ–¹æ³•åœ¨K=2ï¼Œå³ä¸¤å±‚æ—¶å¯ä»¥è¾¾åˆ°å¥½çš„è¡¨ç°ã€‚S1*S2&lt;= 500ï¼ˆS1è¡¨ç¤ºç¬¬ä¸€æ¬¡é‡‡æ ·çš„é‚»å±…æ•°ï¼‰</p>
<h3 id="èšåˆå‡½æ•°"><a href="#èšåˆå‡½æ•°" class="headerlink" title="èšåˆå‡½æ•°"></a>èšåˆå‡½æ•°</h3><p>aggregator éœ€è¦æ»¡è¶³çš„æ€§è´¨ï¼š</p>
<ul>
<li><p>å¯¹ç§°çš„</p>
</li>
<li><p>å¯¹äºè¾“å…¥æ’åˆ—ä¸å˜çš„</p>
<p>ï¼ˆå³æ”¹å˜é‚»å±…èŠ‚ç‚¹è¾“å…¥çš„é¡ºåºï¼Œè¾“å‡ºçš„ç»“æœä¸å˜ï¼‰</p>
</li>
</ul>
<p>ä¸‰ç§</p>
<ul>
<li><p>mean aggregator</p>
<p><img src="/posts/71dd2457/image-20221126212500331.png" alt="image-20221126212500331"></p>
</li>
<li><p>LSTM aggregator</p>
<p>LSTMæœ¬èº«æ˜¯æœ‰é¡ºåºçš„ï¼Œä½†æ˜¯é€šè¿‡å°†è¾“å…¥èŠ‚ç‚¹éšæœºæ’åˆ—ï¼Œä½¿å¾—é€‚ç”¨äºæ— åºé›†åˆã€‚</p>
<p>å®¹é‡å¤§ï¼Œè¡¨ç°å¥½ã€‚</p>
</li>
<li><p>Pooling aggregator</p>
</li>
</ul>
<p><img src="/posts/71dd2457/image-20221126212637461.png" alt="image-20221126212637461"></p>
<p><img src="/posts/71dd2457/image-20221126212630219.png" alt="image-20221126212630219"></p>
<p>ä¸ä»…å¯ä»¥ä½¿ç”¨maxï¼Œä½¿ç”¨å…¶ä»–çš„æ’åˆ—ä¸å˜æ€§å‡½æ•°éƒ½å¯ä»¥ï¼Œå¦‚meanå’Œmaxæ•ˆæœä¸Šæ˜¯æ²¡æœ‰å·®å¼‚çš„ã€‚</p>
<p>é€šè¿‡Wå¯ä»¥æ”¹å˜è¾“å‡ºçš„ç»´åº¦ã€‚</p>
<h2 id="GraphSAGE-minibatch"><a href="#GraphSAGE-minibatch" class="headerlink" title="GraphSAGE minibatch"></a>GraphSAGE minibatch</h2><p>å’ŒGCNä½¿ç”¨å…¨å›¾ä¸åŒçš„æ˜¯ï¼ŒGraphSageç”¨é‡‡æ ·çš„æ–¹å¼ï¼Œåœ¨minibatchä¸‹ï¼Œå¯ä»¥ä¸ä½¿ç”¨å…¨å›¾ä¿¡æ¯ã€‚ä½¿å¾—åœ¨å¤§è§„æ¨¡å›¾ä¸Šè®­ç»ƒå˜å¾—å¯è¡Œã€‚</p>
<p>ç®—æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/posts/71dd2457/image-20221126210734688.png" alt="image-20221126210734688"></p>
<h3 id="é‚»å±…é‡‡æ ·ï¼šä»ç¬¬K-1å±‚åˆ°ç¬¬0å±‚ï¼ˆä»å†…åˆ°å¤–ï¼‰"><a href="#é‚»å±…é‡‡æ ·ï¼šä»ç¬¬K-1å±‚åˆ°ç¬¬0å±‚ï¼ˆä»å†…åˆ°å¤–ï¼‰" class="headerlink" title="é‚»å±…é‡‡æ ·ï¼šä»ç¬¬K-1å±‚åˆ°ç¬¬0å±‚ï¼ˆä»å†…åˆ°å¤–ï¼‰"></a><strong>é‚»å±…é‡‡æ ·ï¼šä»ç¬¬K-1å±‚åˆ°ç¬¬0å±‚</strong>ï¼ˆä»å†…åˆ°å¤–ï¼‰</h3><p>ä»¥èŠ‚ç‚¹aä¸ºä¸­å¿ƒè¿›è¡Œé‚»å±…é‡‡æ ·ã€‚èŠ‚ç‚¹aæ‰€åœ¨å±‚ä¸ºç¬¬kå±‚ï¼Œæ­¤æ—¶k=2ã€‚èšåˆçš„æ€»ç»“ç‚¹æ•°ä¸ºSall = 1ã€‚</p>
<p>ç¬¬k-1å±‚ï¼Œèšåˆç¬¬kå±‚çš„Skä¸ªé‚»å±…èŠ‚ç‚¹ã€‚æ­¤æ—¶B1å±‚é‡‡æ ·èŠ‚ç‚¹aï¼ˆç¬¬2å±‚ï¼‰çš„S2ä¸ªé‚»å±…ï¼Œå³ä¸‰ä¸ªé‚»å±…ï¼›é‡‡æ ·çš„æ€»èŠ‚ç‚¹æ•°ä¸ºSall = Sall*S2 = 3.</p>
<p>ç¬¬k-2å±‚ï¼Œèšåˆç¬¬k-1å±‚çš„Sk-1ä¸ªé‚»å±…ã€‚æ­¤æ—¶B0å±‚é‡‡æ ·B1å±‚çš„S1ä¸ªé‚»å±…ï¼Œå³B1å±‚çš„ä¸‰ä¸ªèŠ‚ç‚¹çš„å¯¹åº”çš„ä¸¤ä¸ªé‚»å±…ã€‚æ€»é‚»å±…æ•°ä¸ºSall = Sall*S1 = 6.</p>
<p><img src="/posts/71dd2457/image-20221126205428637.png" alt style="zoom:67%;"></p>
<p>ä¿å­˜æ‰€æœ‰è¿™äº›é‡‡æ ·çš„èŠ‚ç‚¹ä½œä¸ºåç»­èšåˆç”¨ã€‚å¯ä»¥å‡å°‘å†…å­˜ï¼Œåœ¨å¤§å›¾ä¸Šç”¨ã€‚</p>
<h3 id="èŠ‚ç‚¹èšåˆï¼šä»ç¬¬1å±‚åˆ°ç¬¬Kå±‚ï¼ˆä»å¤–åˆ°å†…ï¼‰"><a href="#èŠ‚ç‚¹èšåˆï¼šä»ç¬¬1å±‚åˆ°ç¬¬Kå±‚ï¼ˆä»å¤–åˆ°å†…ï¼‰" class="headerlink" title="èŠ‚ç‚¹èšåˆï¼šä»ç¬¬1å±‚åˆ°ç¬¬Kå±‚ï¼ˆä»å¤–åˆ°å†…ï¼‰"></a>èŠ‚ç‚¹èšåˆï¼šä»ç¬¬1å±‚åˆ°ç¬¬Kå±‚ï¼ˆä»å¤–åˆ°å†…ï¼‰</h3><p><img src="/posts/71dd2457/image-20221126210846442.png" alt="image-20221126210846442"></p>
<h3 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h3><p>è®­ç»ƒçš„æ˜¯GraphSageçš„æƒé‡å‡½æ•°W</p>
<p>ç»è¿‡GraphSageåï¼Œç”Ÿæˆçš„embedding:Zu,æ±‚loss</p>
<p><img src="/posts/71dd2457/image-20221126211203555.png" alt="image-20221126211203555"></p>
<p>ä½œè€…æå‡ºç»è¿‡embeddingä¹‹åï¼Œç›¸è¿‘çš„èŠ‚ç‚¹åº”è¯¥æœ‰ç›¸ä¼¼çš„è¡¨ç¤ºï¼Œåä¹‹ï¼ŒåŒºåˆ«è¾ƒå¤§çš„èŠ‚ç‚¹çš„è¡¨ç¤ºåº”è¯¥å¾ˆä¸åŒã€‚zuä¸ºèŠ‚ç‚¹uçš„è¡¨ç¤ºï¼Œåº”è¯¥ä½¿å¾—ç›¸ä¼¼çš„èŠ‚ç‚¹uå’Œvï¼Œä»–ä»¬çš„è¡¨ç¤º$z_u^T z_v$ä¹˜ç§¯æ¯”è¾ƒå¤§ï¼Œè€Œä¸ç›¸ä¼¼çš„ä¹˜ç§¯æ¯”è¾ƒå°=ã€‹è¯¥å¼çš„lossè¶Šå°è¶Šå¥½ã€‚</p>
<h2 id="GAT-Graph-Attention-Networks"><a href="#GAT-Graph-Attention-Networks" class="headerlink" title="GAT(Graph Attention Networks)"></a>GAT(Graph Attention Networks)</h2><ul>
<li>å…¬å¼ï¼š</li>
</ul>
<script type="math/tex; mode=display">
\alpha _{ij} = \frac{exp(LeakyReLU(\vec a^T[W\vec h_i||W\vec h_j]))}{\sum_{k\in N_i} exp(LeakyReLU(\vec a^T[W\vec h_i||W\vec h_k]))}</script><script type="math/tex; mode=display">
\vec h'_i = \sigma(\sum \limits_{j \in N_i}a_{ij} W\vec h_j)</script><p>â€‹    Nä¸ºé‚»å±…èŠ‚ç‚¹é›†åˆï¼Œ||ä¸ºconcatï¼ŒWä¸ºå…±äº«çš„æƒå€¼</p>
<ul>
<li>å…·ä½“ä¾‹å­ï¼š</li>
</ul>
<p><img src="/posts/71dd2457/image-20221126214520133.png" alt="image-20221126214520133"></p>
<ul>
<li><p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</p>
<p><img src="/posts/71dd2457/image-20221126214858258.png" alt style="zoom:67%;"></p>
<p><img src="/posts/71dd2457/image-20221126214941394.png" alt style="zoom:67%;"></p>
</li>
</ul>
<p>â€‹    æ¯ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶éƒ½å­¦åˆ°èŠ‚ç‚¹çš„ç‰¹å¾ï¼Œç„¶åå°†è¿™Kä¸ªæ‹¼æ¥åˆ°ä¸€èµ·ä½œä¸ºæœ€åçš„ç»“æœã€‚</p>
<p>â€‹    å¦‚æœå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶åœ¨æœ€åä¸€å±‚ï¼Œç”¨softmaxé¢„æµ‹ï¼Œåˆ™æ‹¼æ¥æ²¡å¿…è¦ï¼Œç›´æ¥æ±‚å¹³å‡ã€‚å¦‚æœæ˜¯æ¥ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œæ‹¼æ¥æ— æ‰€è°“ã€‚</p>
<h2 id="ç½‘ç»œå¯¹æ¯”"><a href="#ç½‘ç»œå¯¹æ¯”" class="headerlink" title="ç½‘ç»œå¯¹æ¯”"></a>ç½‘ç»œå¯¹æ¯”</h2><p><img src="/posts/71dd2457/image-20221126215407142.png" alt style="zoom:67%;"></p>
<p>åº”ç”¨ï¼š</p>
<p>ä¸‰è€…éƒ½å¯ä»¥ç”¨äºåŠç›‘ç£çš„ä»»åŠ¡ã€‚ä½†æ˜¯æå‡ºè¯´GCNä¸èƒ½ç”¨äºæ¨ç†å­¦ä¹ ä»»åŠ¡ï¼ˆå³å­¦ä¹ ä¸€å¼ å›¾ï¼Œæ¨èæ²¡è§è¿‡çš„å¦ä¸€å¼ å›¾ï¼‰ï¼Œè¯´æ˜¯å› ä¸ºGCNçš„é‚»æ¥çŸ©é˜µçš„å®šä¹‰åœ¨ä¸¤å¼ å›¾é‡Œé¢æ˜¯ä¸åŒçš„ã€‚ï¼ˆï¼Ÿï¼Ÿï¼‰é‚£GATå°±å¯ä»¥æ˜¯å› ä¸ºæ˜¯åŠ¨æ€çš„èšåˆé‚»å±…å—ï¼Œå³ééœ€è¦å…¨å›¾ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="GCN-1"><a href="#GCN-1" class="headerlink" title="GCN"></a>GCN</h2><p><a href="https://github.com/tkipf/pygcn">tkipf/pygcn: Graph Convolutional Networks in PyTorch (github.com)</a></p>
<p>æ•°æ®é›†coras</p>
<p>pycharmè°ƒè¯•</p>
<p>ç®€å•çš„è·‘ä¸€ä¸‹é»˜è®¤æ•°å€¼ Test set results: loss= 0.7157 accuracy= 0.8320</p>
<h2 id="GAT"><a href="#GAT" class="headerlink" title="GAT"></a>GAT</h2><p><a href="https://github.com/Diego999/pyGAT">Diego999/pyGAT: Pytorch implementation of the Graph Attention Network model by VeliÄkoviÄ‡ et. al (2017, https://arxiv.org/abs/1710.10903) (github.com)</a></p>
<p>githubä¸Šä»“åº“æœ‰å¯¹GATä»£ç è¿›è¡Œæ›´æ–°ï¼Œæ–°çš„ä»£ç å‡å°‘å†…å­˜çš„å ç”¨ï¼šåŸæœ¬a_inputæ˜¯é€šè¿‡å°†æ‰€æœ‰èŠ‚ç‚¹concatï¼›æ–°çš„ä»£ç æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span>  <span class="title function_">_prepare_attentional_mechanism_input</span>(<span class="params">self, Wh</span>):</span><br><span class="line">    <span class="comment"># Wh.shape (N, out_feature)</span></span><br><span class="line">    <span class="comment"># self.a.shape (2 * out_feature, 1)</span></span><br><span class="line">    <span class="comment"># Wh1&amp;2.shape (N, 1)</span></span><br><span class="line">    <span class="comment"># e.shape (N, N)</span></span><br><span class="line">    Wh1 = torch.matmul(Wh, self.a[:self.out_features, :])</span><br><span class="line">    Wh2 = torch.matmul(Wh, self.a[self.out_features:, :])</span><br><span class="line">    <span class="comment"># broadcast add</span></span><br><span class="line">    e = Wh1 + Wh2.T</span><br><span class="line">    <span class="keyword">return</span> self.leakyrelu(e)</span><br></pre></td></tr></table></figure>
<ul>
<li>batchçš„å®ç°</li>
</ul>
<p>è¾“å…¥ï¼š[batch,node,feature]</p>
<p>adj: [batch,node,node]</p>
<p>å…³äºGAT batchçš„å®ç°ï¼Œè¯¥ä»“åº“çš„issueä¸­æœ‰è®¨è®ºï¼Œå¹¶æœ‰æå‡ºä¸€äº›è§£å†³æ–¹å¼ã€‚</p>
<p>æˆ‘è‡ªå·±ç²—ç•¥çš„å®ç°ï¼Œåœ¨GraphAttentionLayerä¸­ä¿®æ”¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, adj</span>):</span><br><span class="line">       h = torch.matmul(<span class="built_in">input</span>, self.W)</span><br><span class="line">       <span class="built_in">print</span>(h.shape)</span><br><span class="line">       <span class="comment">#N = h.size()[0]</span></span><br><span class="line">       N = h.size()[<span class="number">1</span>]</span><br><span class="line">       <span class="built_in">print</span>(N)</span><br><span class="line">       <span class="comment">#a_input = torch.cat([h.repeat(1, N).view(N * N, -1), h.repeat(N, 1)], dim=1).view(N, -1, 2 * self.out_features)</span></span><br><span class="line">       a_input = torch.cat([h.repeat(<span class="number">1</span>,<span class="number">1</span>, N).view(h.shape[<span class="number">0</span>],N * N, -<span class="number">1</span>), h.repeat(<span class="number">1</span>,N, <span class="number">1</span>)], dim=<span class="number">2</span>).view(h.shape[<span class="number">0</span>],N, -<span class="number">1</span>, <span class="number">2</span> * self.out_features)</span><br><span class="line">       <span class="built_in">print</span>(a_input.shape)</span><br><span class="line">       <span class="comment">#e = self.leakyrelu(torch.matmul(a_input, self.a).squeeze(2))</span></span><br><span class="line">       e = self.leakyrelu(torch.matmul(a_input, self.a).squeeze(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªåšå®¢çš„å®ç°å’Œæˆ‘çš„æ€è·¯ç±»ä¼¼ï¼š<a href="https://blog.csdn.net/pixian3729/article/details/110261140">GATï¼ˆå‚æ•°ä¸­åŠ å…¥batchï¼‰_2snoopyçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è¯¥æ–¹æ³•å…¶å®è¿˜æ˜¯æŒºæ¶ˆè€—å†…å­˜çš„ã€‚</p>
<p>Diego999å‡è½»å†…å­˜å ç”¨å¹¶åº”ç”¨batchçš„å®ç°ï¼š</p>
<p><a href="https://github.com/Diego999/pyGAT/issues/62">How to implement batch training? Â· Issue #62 Â· Diego999/pyGAT (github.com)</a></p>
<p>å®é™…ä¸­ç¡®å®æœ‰å‡å°‘å†…å­˜å ç”¨ï¼Œä½†æ˜¯GATæœ¬èº«çš„ç‰¹è´¨å†…å­˜æ¶ˆè€—æ¯”è¾ƒå¤§ï¼Œå¯ä»¥å»æ¢ç´¢å…¶ä»–æ”¹è¿›çš„GNNã€‚</p>
<h2 id="GraphSAGE"><a href="#GraphSAGE" class="headerlink" title="GraphSAGE"></a>GraphSAGE</h2><p>tensorflowç‰ˆæœ¬:<a href="https://github.com/williamleif/GraphSAGE">williamleif/GraphSAGE: Representation learning on large graphs using stochastic graph convolutions. (github.com)</a></p>
<p>pytorchå®ç°ï¼ˆç®€æ´ç‰ˆæœ¬ï¼‰ï¼š<a href="https://github.com/williamleif/graphsage-simple">williamleif/graphsage-simple: Simple reference implementation of GraphSAGE. (github.com)</a></p>
<p><a href="https://blog.csdn.net/qq_35812205/article/details/126681519">ã€GraphSAGEå®è·µã€‘YelpChiè¯„è®ºå›¾æ•°æ®é›†ä¸Šçš„åæ¬ºè¯ˆæ£€æµ‹_å±±é¡¶å¤•æ™¯çš„åšå®¢-CSDNåšå®¢_yelpchiæ•°æ®é›†</a></p>
]]></content>
      <categories>
        <category>å›¾ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>GNN</tag>
      </tags>
  </entry>
  <entry>
    <title>å›¾åŸºæœ¬çŸ¥è¯†</title>
    <url>/posts/5f3db67/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="å›¾åŸºæœ¬çŸ¥è¯†"><a href="#å›¾åŸºæœ¬çŸ¥è¯†" class="headerlink" title="å›¾åŸºæœ¬çŸ¥è¯†"></a>å›¾åŸºæœ¬çŸ¥è¯†</h1><h2 id="å›¾çš„è¡¨ç¤º"><a href="#å›¾çš„è¡¨ç¤º" class="headerlink" title="å›¾çš„è¡¨ç¤º"></a>å›¾çš„è¡¨ç¤º</h2><p>ç‚¹å’Œè¾¹æ„æˆçš„æ•°æ®ç»“æ„</p>
<p>æ—¥å¸¸ç”Ÿæ´»ä¸­æ— å¤„ä¸åœ¨ï¼šå›¾åƒï¼šåƒç´ å’Œåƒç´ ä¹‹é—´çš„è¿æ¥æ„æˆçš„å›¾; ç½‘é¡µï¼š ç½‘é¡µä¹‹é—´çš„è·³è½¬;</p>
<span id="more"></span>
<h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p><strong>æ— å‘å›¾å’Œæœ‰å‘å›¾</strong></p>
<h3 id="è¡¨ç¤º"><a href="#è¡¨ç¤º" class="headerlink" title="è¡¨ç¤º"></a>è¡¨ç¤º</h3><ul>
<li>é‚»æ¥çŸ©é˜µ</li>
</ul>
<h2 id="å›¾çš„æ€§è´¨"><a href="#å›¾çš„æ€§è´¨" class="headerlink" title="å›¾çš„æ€§è´¨"></a>å›¾çš„æ€§è´¨</h2><h3 id="åº¦"><a href="#åº¦" class="headerlink" title="åº¦"></a>åº¦</h3><ul>
<li>æ— å‘å›¾çš„åº¦==è¯¥èŠ‚ç‚¹è¿æ¥çš„è¾¹çš„æ•°é‡</li>
<li>æœ‰å‘å›¾çš„åº¦<ul>
<li>å‡ºåº¦ï¼šä»è¯¥èŠ‚ç‚¹æŒ‡å‘çš„è¾¹çš„æ•°é‡</li>
<li>å…¥åº¦ï¼šæŒ‡å‘è¯¥èŠ‚ç‚¹çš„è¾¹çš„æ•°é‡</li>
</ul>
</li>
</ul>
<h3 id="å­å›¾"><a href="#å­å›¾" class="headerlink" title="å­å›¾"></a>å­å›¾</h3><p>â€‹    å­å›¾æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½åŒ…å«åœ¨å¤§å›¾é‡Œé¢ï¼›</p>
<p>â€‹    å­å›¾çš„è¾¹éƒ½æ˜¯å¤§å›¾çš„è¾¹çš„å­é›†ï¼›</p>
<h3 id="è¿é€šå›¾å’Œè¿é€šåˆ†é‡"><a href="#è¿é€šå›¾å’Œè¿é€šåˆ†é‡" class="headerlink" title="è¿é€šå›¾å’Œè¿é€šåˆ†é‡"></a>è¿é€šå›¾å’Œè¿é€šåˆ†é‡</h3><p>æ— å‘å›¾</p>
<ul>
<li><p>è¿é€šå›¾ï¼š</p>
<p>ä»»æ„èŠ‚ç‚¹ièƒ½å¤Ÿé€šè¿‡ä¸€äº›è¾¹åˆ°è¾¾èŠ‚ç‚¹jï¼Œåˆ™ç§°ä¹‹ä¸ºè¿é€šå›¾ï¼›åä¹‹éè¿é€šå›¾ã€‚</p>
<p>å¯¹äºä¸€ä¸ªæ— å‘å›¾ï¼šæ²¡æœ‰å­¤ç«‹çš„èŠ‚ç‚¹å…¶å®éƒ½èƒ½è¿é€š</p>
</li>
<li><p>è¿é€šåˆ†é‡ï¼š<br>æ— å‘å›¾Gçš„ä¸€ä¸ªæå¤§è¿é€šå­å›¾ç§°ä¸ºGçš„ä¸€ä¸ªè¿é€šåˆ†é‡ï¼ˆæˆ–è¿é€šåˆ†æ”¯ï¼‰ã€‚</p>
<p>è¿é€šå›¾åªæœ‰ä¸€ä¸ªè¿é€šåˆ†é‡ï¼šä»–æœ¬èº«ï¼›éè¿é€šå›¾æœ‰å¤šä¸ªè¿é€šåˆ†é‡ã€‚</p>
</li>
</ul>
<p>æœ‰å‘å›¾çš„è¿é€šæ€§</p>
<ul>
<li>å¼ºè¿é€šå›¾ï¼šç»™å®šå›¾Gçš„ä»»æ„ä¸¤ä¸ªç»“ç‚¹u,vå¯äº’ç›¸åˆ°è¾¾ã€‚</li>
<li>å¼±è¿é€šå›¾ï¼šè‡³å°‘æœ‰ä¸€å¯¹ç»“ç‚¹ä¸æ»¡è¶³å•å‘è¿é€šï¼Œä½†å»æ‰è¾¹çš„æ–¹å‘ä¹‹åä»æ— å‘å›¾çš„è§‚ç‚¹çœ‹æ˜¯è¿é€šå›¾ã€‚</li>
</ul>
<h3 id="æœ€çŸ­è·¯å¾„å’Œå›¾ç›´å¾„"><a href="#æœ€çŸ­è·¯å¾„å’Œå›¾ç›´å¾„" class="headerlink" title="æœ€çŸ­è·¯å¾„å’Œå›¾ç›´å¾„"></a>æœ€çŸ­è·¯å¾„å’Œå›¾ç›´å¾„</h3><p>ä¸¤ç»“ç‚¹çš„æœ€çŸ­åˆ°è¾¾è·¯å¾„å°±æ˜¯æœ€çŸ­è·¯å¾„</p>
<p>ä¸¤ä¸¤ç»“ç‚¹çš„æœ€çŸ­è·¯å¾„ä¸­çš„é•¿åº¦æœ€å¤§å€¼æ˜¯å›¾ç›´å¾„ã€‚</p>
<h3 id="åº¦ä¸­å¿ƒæ€§"><a href="#åº¦ä¸­å¿ƒæ€§" class="headerlink" title="åº¦ä¸­å¿ƒæ€§"></a>åº¦ä¸­å¿ƒæ€§</h3><script type="math/tex; mode=display">
åº¦ä¸­å¿ƒæ€§ = \frac{N_{degree}}{n-1}</script><p>$N_{degree}$è¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„åº¦ï¼Œnä¸ºè¯¥èŠ‚ç‚¹æ‰€åœ¨å›¾çš„èŠ‚ç‚¹æ€»æ•°ã€‚</p>
<h3 id="ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§Eigenvector-Centrality"><a href="#ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§Eigenvector-Centrality" class="headerlink" title="ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§Eigenvector Centrality"></a>ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§Eigenvector Centrality</h3><p>æœ€å¤§ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ä½œä¸ºç‰¹å¾å‘é‡ä¸­å¿ƒæ€§çš„å¯¹æ¯”æŒ‡æ ‡ã€‚</p>
<p>Aä¸ºé‚»æ¥çŸ©é˜µï¼›</p>
<p>å¦‚å›¾ï¼Œæœ€å¤§çš„ç‰¹å¾å€¼æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ‰€ä»¥ç‰¹å¾å‘é‡å¯¹åº”ç¬¬ä¸€åˆ—ã€‚</p>
<p>ï¼ˆç‰¹å¾å‘é‡ä¸­å¿ƒæ€§å°†ç‰¹å¾å‘é‡çš„è´Ÿå€¼å˜æˆæ­£è¿›è¡Œç»Ÿä¸€å¯¹æ¯”ï¼‰</p>
<p><img src="/posts/5f3db67/image-20221126140426649.png" style="zoom: 67%;"></p>
<p>ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§ä¸ä»…è€ƒè™‘äº†è‡ªå·±èŠ‚ç‚¹çš„åº¦ï¼Œè¿˜è€ƒè™‘äº†å’Œä»–å‘é‡èŠ‚ç‚¹çš„åº¦çš„æƒ…å†µã€‚å¦‚v4çš„å€¼ä¼šæ¯”v2å’Œv3å¤§æ˜¯å› ä¸ºå®ƒè™½ç„¶åº¦å’Œv2\v3ä¸€æ ·å¤§ï¼Œä½†æ˜¯ç›¸è¿çš„æ˜¯v1å’Œv5ï¼Œæ¯”v2/v3å‘é‡çš„èŠ‚ç‚¹çš„åº¦æ€»ä½“è¦å¤§ã€‚</p>
<p><strong>conclu:ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§æ¯”åº¦ä¸­å¿ƒæ€§å¯ä»¥æ›´å¥½çš„è¡¨ç¤ºèŠ‚ç‚¹åœ¨å›¾ä¸­æ‰€å¤„çš„ä½ç½®ã€‚</strong></p>
<h3 id="ä¸­ä»‹ä¸­å¿ƒæ€§-Betweenness-Centrality"><a href="#ä¸­ä»‹ä¸­å¿ƒæ€§-Betweenness-Centrality" class="headerlink" title="ä¸­ä»‹ä¸­å¿ƒæ€§ Betweenness Centrality"></a>ä¸­ä»‹ä¸­å¿ƒæ€§ Betweenness Centrality</h3><script type="math/tex; mode=display">
Betweenness  = \frac{ç»è¿‡è¯¥èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„}{å…¶ä½™ä¸¤ä¸¤èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„}</script><h3 id="è¿æ¥ä¸­å¿ƒæ€§-Closeness"><a href="#è¿æ¥ä¸­å¿ƒæ€§-Closeness" class="headerlink" title="è¿æ¥ä¸­å¿ƒæ€§ Closeness"></a>è¿æ¥ä¸­å¿ƒæ€§ Closeness</h3><script type="math/tex; mode=display">
Closeness = \frac{n-1}{è¯¥èŠ‚ç‚¹åˆ°å…¶ä»–èŠ‚ç‚¹æœ€çŸ­è·¯å¾„ä¹‹å’Œ}</script><p>â€‹    nä¸ºèŠ‚ç‚¹æ€»æ•°ï¼›</p>
<h3 id><a href="#" class="headerlink" title=" "></a> </h3><h3 id="ç½‘é¡µæ’åºç®—æ³•"><a href="#ç½‘é¡µæ’åºç®—æ³•" class="headerlink" title="ç½‘é¡µæ’åºç®—æ³•"></a>ç½‘é¡µæ’åºç®—æ³•</h3><h4 id="pagerank"><a href="#pagerank" class="headerlink" title="pagerank"></a>pagerank</h4><p>è¾¹çš„pagerankå€¼ä¸ºèŠ‚ç‚¹å‘å¤–æŒ‡å‘æ—¶å¹³åˆ†çš„ç»“æœã€‚å¦‚èŠ‚ç‚¹2å‘å¤–æŒ‡å‘çš„è¾¹æœ‰ä¸¤æ¡ï¼Œå› æ­¤ç°åœ¨é‚£ä¸¤æ¡è¾¹çš„pagerankå€¼éƒ½ä¸ºpagerank2/2ã€‚</p>
<p>èŠ‚ç‚¹çš„pagerankå€¼å³ä¸ºæŒ‡å‘å®ƒçš„è¾¹çš„å€¼çš„å’Œã€‚</p>
<p><img src="/posts/5f3db67/image-20221126142317310.png" style="zoom:67%;"></p>
<p>ä¸æ–­çš„è¿­ä»£ï¼Œæœ€åæ¯ä¸ªèŠ‚ç‚¹çš„pagerankå€¼è¾¾åˆ°ç¨³æ€    ã€‚</p>
<p>é˜»å°¼ç³»æ•°ï¼šå¦‚èŠ‚ç‚¹3åˆ°èŠ‚ç‚¹4çš„æ¦‚ç‡æœ‰0.15ã€‚</p>
<h4 id="HITS"><a href="#HITS" class="headerlink" title="HITS"></a>HITS</h4><p><img src="/posts/5f3db67/image-20221126142814847.png" style="zoom: 67%;"></p>
<p>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰authorityå€¼å’Œhubå€¼</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">lis =<span class="keyword">lambda</span> x:random.randint(<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">edges  = pd.DataFrame()</span><br><span class="line">edges[<span class="string">&#x27;sources&#x27;</span>] = [lis(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line">edges[<span class="string">&#x27;targets&#x27;</span>] = [lis(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line">edges[<span class="string">&#x27;weights&#x27;</span>] = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line"></span><br><span class="line">G = nx.from_pandas_edgelist(edges,source=<span class="string">&#x27;sources&#x27;</span>,target=<span class="string">&#x27;targets&#x27;</span>,edge_attr=<span class="string">&#x27;weights&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;G:&quot;</span>,G)</span><br><span class="line"><span class="built_in">print</span>(nx.__version__)</span><br><span class="line"><span class="built_in">print</span>(nx.adjacency_matrix(G))</span><br><span class="line"><span class="comment">#åº¦</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;degree:&quot;</span>,nx.degree(G))</span><br><span class="line"><span class="comment"># è¿é€šåˆ†é‡</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;connected_components&quot;</span>,<span class="built_in">list</span>(nx.connected_components(G)))</span><br><span class="line"><span class="comment">#å›¾ç›´å¾„</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;diameter:&quot;</span>,nx.diameter(G))</span><br><span class="line"><span class="comment"># åº¦ä¸­å¿ƒæ€§</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;degree_centrality:&quot;</span>,nx.degree_centrality(G))</span><br><span class="line"><span class="comment">#ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;eigenvector:&quot;</span>,nx.eigenvector_centrality(G))</span><br><span class="line"><span class="comment"># betweenness ä¸­ä»‹ä¸­å¿ƒæ€§</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;betweenness:&quot;</span>,nx.betweenness_centrality(G))</span><br><span class="line"><span class="comment"># closeness è¿æ¥ä¸­å¿ƒæ€§</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;closenesss:&quot;</span>,nx.closeness_centrality(G))</span><br><span class="line"><span class="comment">#pagerank</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pagerank:&quot;</span>,nx.pagerank(G))</span><br><span class="line"><span class="comment">#hits</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hits:&quot;</span>,nx.hits(G))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FutureWarning: adjacency_matrix will return a scipy.sparse array instead of a matrix in Networkx 3.0.</span><br><span class="line">  print(nx.adjacency_matrix(G))</span><br><span class="line">G: Graph with 6 nodes and 8 edges</span><br><span class="line">2.8.4</span><br><span class="line">  (0, 0)	1</span><br><span class="line">  (0, 2)	1</span><br><span class="line">  (0, 3)	1</span><br><span class="line">  (0, 4)	1</span><br><span class="line">  (1, 1)	1</span><br><span class="line">  (1, 4)	1</span><br><span class="line">  (1, 5)	1</span><br><span class="line">  (2, 0)	1</span><br><span class="line">  (2, 3)	1</span><br><span class="line">  (3, 0)	1</span><br><span class="line">  (3, 2)	1</span><br><span class="line">  (4, 0)	1</span><br><span class="line">  (4, 1)	1</span><br><span class="line">  (5, 1)	1</span><br><span class="line">degree: [(3, 5), (1, 4), (4, 2), (2, 2), (5, 2), (6, 1)]</span><br><span class="line">connected_components [&#123;1, 2, 3, 4, 5, 6&#125;]</span><br><span class="line">diameter: 4</span><br><span class="line">degree_centrality: &#123;3: 1.0, 1: 0.8, 4: 0.4, 2: 0.4, 5: 0.4, 6: 0.2&#125;</span><br><span class="line">eigenvector: &#123;3: 0.6845438993664699, 1: 0.2664667519552274, 4: 0.4038050904760662, 2: 0.4038050904760662, 5: 0.3528502881437044, 6: 0.09886704157967073&#125;</span><br><span class="line">betweenness: &#123;3: 0.6000000000000001, 1: 0.4, 4: 0.0, 2: 0.0, 5: 0.6000000000000001, 6: 0.0&#125;</span><br><span class="line">closenesss: &#123;3: 0.625, 1: 0.5, 4: 0.45454545454545453, 2: 0.45454545454545453, 5: 0.625, 6: 0.35714285714285715&#125;</span><br><span class="line">pagerank: &#123;3: 0.26059842893288254, 1: 0.22624644367910318, 4: 0.1397855189975688, 2: 0.1397855189975688, 5: 0.1444805278346477, 6: 0.08910356155822868&#125;</span><br><span class="line">hits: (&#123;3: 0.3097026575730737, 1: 0.1205522404859372, 4: 0.18269069072963665, 2: 0.18269069072963665, 5: 0.1596357156065535, 6: 0.04472800487516233&#125;, &#123;3: 0.30970265757307375, 1: 0.1205522404859372, 4: 0.1826906907296366, 2: 0.18269069072963656, 5: 0.1596357156065534, 6: 0.04472800487516234&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è§†é¢‘æ¥æºï¼š<a href="https://www.bilibili.com/video/BV1aB4y1Q7RL">https://www.bilibili.com/video/BV1aB4y1Q7RL</a></p>
<h1 id="Graph-Embedding"><a href="#Graph-Embedding" class="headerlink" title="Graph Embedding"></a>Graph Embedding</h1><p><a href="https://github.com/shenweichen/GraphEmbedding">ä»£ç </a></p>
<ol>
<li>DeepWalk :é‡‡ç”¨éšæœºæ¸¸èµ°ï¼Œå½¢æˆåºåˆ—ï¼Œé‡‡ç”¨skip-gramæ–¹ å¼ç”ŸæˆèŠ‚ç‚¹embeddingã€‚</li>
<li>node2vec :ä¸åŒçš„éšæœºæ¸¸èµ°ç­–ç•¥ï¼Œå½¢æˆåºåˆ—ï¼Œç±»ä¼¼skip-gramæ–¹ å¼ç”ŸæˆèŠ‚ç‚¹embeddingã€‚</li>
<li>LINE :æ•è·èŠ‚ç‚¹çš„ä¸€-é˜¶å’ŒäºŒé˜¶ç›¸ä¼¼åº¦ï¼Œåˆ†åˆ«æ±‚è§£ï¼Œå†å°†ä¸€é˜¶äºŒé˜¶æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œ ä½œä¸ºèŠ‚ç‚¹çš„embedding</li>
<li>struc2vec :å¯¹å›¾çš„ç»“æ„ä¿¡æ¯è¿›è¡Œæ•è·ï¼Œåœ¨å…¶ç»“æ„é‡è¦æ€§å¤§äºé‚»å±…é‡è¦æ€§æ—¶ï¼Œæœ‰è¾ƒå¥½çš„æ•ˆæœã€‚</li>
<li>SDNE :é‡‡ç”¨äº†å¤šä¸ªéçº¿æ€§å±‚çš„æ–¹å¼æ•è·ä¸€é˜¶äºŒé˜¶çš„ç›¸ä¼¼æ€§ã€‚</li>
</ol>
<h2 id="DeepWalk"><a href="#DeepWalk" class="headerlink" title="DeepWalk"></a>DeepWalk</h2><ul>
<li>é€‚ç”¨äºæ— å‘å›¾</li>
</ul>
<p>éšæœºæ¸¸èµ°è·å¾—èŠ‚ç‚¹åºåˆ—</p>
<p>ä½¿ç”¨skipgramç®—æ³•å®ŒæˆåµŒå…¥</p>
<p>window size dæ˜¯å‘å‰å‘åçœ‹å¤šå°‘ä¸ªèŠ‚ç‚¹</p>
<p>ç®—æ³•ï¼š</p>
<p><img src="/posts/5f3db67/image-20221126154802461.png" alt style="zoom: 50%;"></p>
<p>å¦‚ä¸‹å›¾ï¼šç»™å®šv4èŠ‚ç‚¹ï¼Œç®—å‡ºv2,v3,v5,v6åŒæ—¶å‡ºç°çš„æ¦‚ç‡ã€‚ç„¶åå®ŒæˆåµŒå…¥ã€‚</p>
<p><img src="/posts/5f3db67/image-20221126155109322.png" alt style="zoom:50%;"></p>
<ul>
<li><p>embeddingæ•ˆæœå¯¹æ¯”ï¼Œçœ‹å‚æ•°ä½œç”¨</p>
<p>DeepWalkæ˜¯æ— ç›‘ç£çš„å®Œæˆå›¾åµŒå…¥ï¼Œæ•ˆæœåˆ¤åˆ«é€šè¿‡å°†å®ŒæˆåµŒå…¥çš„å›¾ï¼ˆæœ‰label)è¾“å…¥åˆ†ç±»å™¨,çœ‹åˆ†ç±»æ•ˆæœ</p>
<ul>
<li><p>embedding size d</p>
<p>då˜å¤§ï¼Œæ•ˆæœ</p>
<p>ä¸€å®šèŒƒå›´å†…ä¸Šå‡ï¼Œè¶…è¿‡ä¸€å®šå€¼ï¼Œåè€Œä¸‹é™</p>
</li>
<li><p>è¿­ä»£æ¬¡æ•°</p>
</li>
</ul>
</li>
</ul>
<p>â€‹                è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œæ•ˆæœä¸Šå‡ï¼›åˆ°è¾¾ä¸€å®šå€¼å†å¢åŠ ï¼Œæ•ˆæœå˜åŒ–æœ‰é™</p>
<h2 id="LINE"><a href="#LINE" class="headerlink" title="LINE"></a>LINE</h2><p>large-scale Information Network Embedding</p>
<p>ä½œè€…æå‡ºLINEç”¨äºå¤§è§„æ¨¡å›¾ä¸Šè¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„ç»“æ„ä¿¡æ¯è¡¨ç°æ¯”è¾ƒå¥½</p>
<ul>
<li><strong>ä¸€é˜¶</strong>ï¼šå±€éƒ¨çš„ç»“æ„ä¿¡æ¯ã€‚</li>
<li><strong>äºŒé˜¶</strong>ï¼šèŠ‚ç‚¹çš„é‚»å±…ã€‚å…±äº«é‚»å±…çš„èŠ‚ç‚¹å¯èƒ½æ˜¯ç›¸ä¼¼çš„ã€‚</li>
</ul>
<p>ä¸€é˜¶ç›¸ä¼¼æ€§ï¼šä¸¤ä¸ªèŠ‚ç‚¹ç›¸è¿æ¥ï¼Œä¸”è¾¹çš„æƒé‡å¾ˆå¤§ï¼Œé‚£ä¹ˆä»–ä»¬çš„ä¸€é˜¶ç›¸ä¼¼æ€§å¾ˆé«˜</p>
<p>äºŒé˜¶ç›¸ä¼¼æ€§ï¼š ä¸¤ä¸ªèŠ‚ç‚¹çš„é‚»å±…å¾ˆç›¸ä¼¼ï¼Œé‚£ä¹ˆå³ä½¿è¿™ä¸¤ä¸ªèŠ‚ç‚¹æ²¡æœ‰ç›¸äº’è¿æ¥ï¼Œä»–ä»¬çš„äºŒé˜¶ç›¸ä¼¼æ€§ä¹Ÿå¾ˆå¤§</p>
<p>å¦‚å›¾ï¼Œå…­èŠ‚ç‚¹å’Œä¸ƒèŠ‚ç‚¹ä¸€é˜¶ç›¸ä¼¼æ€§é«˜ï¼Œäº”èŠ‚ç‚¹å’Œå…­èŠ‚ç‚¹çš„embeddingçš„äºŒé˜¶ç›¸ä¼¼æ€§å¾ˆé«˜ï¼š</p>
<p><img src="/posts/5f3db67/image-20221126160339470.png" alt style="zoom: 50%;"></p>
<ul>
<li><p>èŠ‚ç‚¹çš„åº¦æ¯”è¾ƒä½çš„è¯ï¼Œä½¿ç”¨LINEæ•ˆæœä¸ä¼šå¾ˆå¥½</p>
</li>
<li><p>é€‚ç”¨äºæœ‰å‘å›¾å’Œæ— å‘å›¾</p>
</li>
</ul>
<p>ä¸€é˜¶å’ŒäºŒé˜¶embeddingè®­ç»ƒçš„lossï¼š</p>
<p><img src="/posts/5f3db67/image-20221126163731692.png" alt style="zoom: 50%;"></p>
<p><img src="/posts/5f3db67/image-20221126163701508.png" alt style="zoom:50%;"></p>
<p>æœ€åçš„embeddingæ˜¯ä¸€é˜¶å’ŒäºŒé˜¶çš„ç›´æ¥æ‹¼æ¥</p>
<h2 id="Node2Vec"><a href="#Node2Vec" class="headerlink" title="Node2Vec"></a>Node2Vec</h2><p>å’ŒDeepWalkç›¸ä¼¼ï¼Œä¸åŒçš„æ˜¯é‡‡ç”¨äº†æœ‰ç­–ç•¥çš„æ¸¸èµ°</p>
<p>æ¸¸èµ°ç­–ç•¥ï¼š</p>
<p><img src="/posts/5f3db67/image-20221126170021320.png" alt style="zoom:67%;"></p>
<p>DFSï¼Œå³qå€¼å°ï¼Œæ¢ç´¢æ€§å¼ºï¼Œä¼šæ•æ‰åŒè´¨æ€§èŠ‚ç‚¹ï¼Œå³ç›¸é‚»èŠ‚ç‚¹è¡¨ç¤ºç±»ä¼¼ï¼›BFSï¼Œå³på€¼å°ï¼Œä¿å®ˆå‘¨å›´ï¼Œä¼šæ•æ‰ç»“æ„æ€§ï¼Œå³æŸäº›èŠ‚ç‚¹çš„å›¾ä¸Šç»“æ„ç±»ä¼¼ã€‚</p>
<h2 id="struct2vec"><a href="#struct2vec" class="headerlink" title="struct2vec"></a>struct2vec</h2><p>ä¹‹å‰çš„æ–¹å¼éƒ½æ˜¯åŸºäºè¿‘é‚»ï¼Œä½†æ˜¯æœ‰äº›èŠ‚ç‚¹æ²¡æœ‰è¿‘é‚»ä¹Ÿæœ‰ç»“æ„ç›¸ä¼¼æ€§</p>
<h2 id="SDNE"><a href="#SDNE" class="headerlink" title="SDNE"></a>SDNE</h2><p>structural deep network embedding</p>
<p>æ¶‰åŠ autoencoderçš„æ€æƒ³</p>
]]></content>
      <categories>
        <category>å›¾ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>å›¾</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€pytorch-learningã€‘(ä¸‰) å¯è§†åŒ–</title>
    <url>/posts/f19419c5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="tensorboardçš„ä½¿ç”¨"><a href="#tensorboardçš„ä½¿ç”¨" class="headerlink" title="tensorboardçš„ä½¿ç”¨"></a>tensorboardçš„ä½¿ç”¨</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install tensorboard</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="add-scalar"><a href="#add-scalar" class="headerlink" title="add_scalar"></a>add_scalar</h3><h4 id="è¿è¡Œä»£ç "><a href="#è¿è¡Œä»£ç " class="headerlink" title="è¿è¡Œä»£ç "></a><strong>è¿è¡Œä»£ç </strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span>  SummaryWriter</span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)<span class="comment"># ä¿å­˜logçš„æ–‡ä»¶å¤¾</span></span><br><span class="line"><span class="comment">##y=x</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line"></span><br><span class="line">    writer.add_scalar(<span class="string">&quot;y=2x&quot;</span>,<span class="number">2</span>*i,i)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
<h4 id="å‘½ä»¤è¡Œè¿è¡Œï¼šæ‰“å¼€äº‹ä»¶æ–‡ä»¶"><a href="#å‘½ä»¤è¡Œè¿è¡Œï¼šæ‰“å¼€äº‹ä»¶æ–‡ä»¶" class="headerlink" title="å‘½ä»¤è¡Œè¿è¡Œï¼šæ‰“å¼€äº‹ä»¶æ–‡ä»¶"></a><strong>å‘½ä»¤è¡Œè¿è¡Œï¼šæ‰“å¼€äº‹ä»¶æ–‡ä»¶</strong></h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tensorboard --logdir=logs --port=6007</span><br></pre></td></tr></table></figure>
<p>tensorboardå‚æ•°ï¼š â€”logdir=æ–‡ä»¶å¤¹åç§° â€”port=ç«¯å£å· å¯ä»¥ä¸è®¾ç½®ç«¯å£å·å°±æ˜¯é»˜è®¤ï¼Œä¸ºäº†é¿å…å†²çªå¯ä»¥è®¾ç½®</p>
<p>ç”±äºå¤šæ¬¡æ·»åŠ ï¼Œå¯¼è‡´logæ–‡ä»¶ä¸­æœ‰å„ç§ï¼Œå¯èƒ½å¯¼è‡´tensorboardæ˜¾ç¤ºæ›²çº¿çš„ä¸€äº›æ‹Ÿåˆç­‰ã€‚</p>
<p>è§£å†³ï¼š</p>
<ul>
<li>åˆ é™¤logsæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œé‡æ–°è¿è¡Œç¨‹åºã€‚</li>
<li>å¯¹åº”æ¯ä¸ªä»»åŠ¡æ¯æ¬¡éƒ½è®¾ç«‹å­æ–‡ä»¶å¤¹ã€‚</li>
</ul>
<h4 id="æµè§ˆå™¨æŸ¥çœ‹"><a href="#æµè§ˆå™¨æŸ¥çœ‹" class="headerlink" title="æµè§ˆå™¨æŸ¥çœ‹"></a><strong>æµè§ˆå™¨æŸ¥çœ‹</strong></h4><p>ç½‘å€åœ¨å‘½ä»¤è¡Œæœ‰æ˜¾ç¤ºã€‚å‰é¢ç¤ºä¾‹çš„ä¸º localhost:6007ã€‚</p>
<h3 id="add-image"><a href="#add-image" class="headerlink" title="add_image"></a>add_image</h3><p>å›¾ç‰‡</p>
<p>æ•°æ®ç±»å‹éœ€è¦tensoræˆ–è€…numpy array</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span>  SummaryWriter</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">img_path = <span class="string">&quot;./hymenoptera_data/hymenoptera_data/train/ants/0013035.jpg&quot;</span></span><br><span class="line">img_PIL = Image.<span class="built_in">open</span>(img_path)</span><br><span class="line">img_array = np.array(img_PIL)</span><br><span class="line"><span class="built_in">print</span>(img_array.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(img_array))</span><br><span class="line">writer.add_image(<span class="string">&quot;test&quot;</span>,img_array,<span class="number">1</span>,dataformats=<span class="string">&quot;HWC&quot;</span>)<span class="comment">##é»˜è®¤æ˜¯CHW,å¦‚æœä¸æ˜¯éœ€è¦è¿›è¡Œè®¾ç½®</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
<h3 id="add-graph"><a href="#add-graph" class="headerlink" title="add_graph"></a>add_graph</h3><p>å¯è§†åŒ–æ¨¡å‹</p>
<ul>
<li>ä»£ç ä¸­ä½¿ç”¨tensorboardçš„add_graphå°†æ¨¡å‹åŠ å…¥ï¼Œæ³¨æ„ä¼ å‚éœ€è¦ä¼ å…¥æ¨¡å‹è¾“å…¥ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Linear, Sequential</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Model</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Model, self).__init__()</span><br><span class="line">        self.model1 = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, kernel_size=<span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            nn.Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">model = Model()</span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.ones(<span class="number">64</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">32</span>)</span><br><span class="line">output = model(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output.shape)</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs_seq&quot;</span>)</span><br><span class="line">writer.add_graph(model,<span class="built_in">input</span>)</span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><p>å‘½ä»¤è¡Œè¿è¡Œå‘½ä»¤æ‰“å¼€äº‹ä»¶æ–‡ä»¶</p>
</li>
<li><p>æµè§ˆå™¨æŸ¥çœ‹æ¨¡å‹ï¼Œå¯ä»¥ç‚¹å‡»æ”¾å¤§ï¼Œçœ‹æ¨¡å‹å…·ä½“å±‚</p>
</li>
</ul>
<p><img src="/posts/f19419c5/æ¨¡å‹.png" alt="tensorboardæŸ¥çœ‹"></p>
<h1 id="Visdomå¯è§†åŒ–"><a href="#Visdomå¯è§†åŒ–" class="headerlink" title="Visdomå¯è§†åŒ–"></a>Visdomå¯è§†åŒ–</h1><p>çª—å£è§†å›¾ï¼Œç•Œé¢å‹å¥½</p>
<h2 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul>
<li>æ–¹å¼ä¸€</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install visdom</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤è¡Œè¿è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m visdom.server</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæŠ¥é”™æ‰¾ä¸åˆ°è·¯å¾„ï¼Œè§£å†³æ–¹å¼ï¼šåœ¨è¯¥ç›®å½•ä¸‹è‡ªå·±åˆ›å»ºè¯¥æ–‡ä»¶å¤¹</p>
<ul>
<li>å®‰è£…æ–¹å¼2ï¼šé¿å…downloadé—®é¢˜</li>
</ul>
<ol>
<li>pip uninstall visdom</li>
<li>ä»githubä¸‹è½½visdomæ–‡ä»¶</li>
<li>cd è¯¥ç›®å½•ä¸‹ï¼Œpip install -e .</li>
<li>åœ¨é¡¹ç›®è·¯å¾„ä¸‹ python -m visdom.serveræˆåŠŸå¯åŠ¨</li>
</ol>
<h2 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>visdomçš„ä¸€äº›å…·ä½“ä½¿ç”¨ï¼š<a href="https://blog.csdn.net/weixin_41010198/article/details/117853358">https://blog.csdn.net/weixin_41010198/article/details/117853358</a></p>
<h4 id="ä¸€ä¸ªä½¿ç”¨å®ä¾‹"><a href="#ä¸€ä¸ªä½¿ç”¨å®ä¾‹" class="headerlink" title="ä¸€ä¸ªä½¿ç”¨å®ä¾‹"></a><strong>ä¸€ä¸ªä½¿ç”¨å®ä¾‹</strong></h4><ol>
<li>å‘½ä»¤è¡Œè¿è¡Œ<code>python -m visdom.server</code>æˆåŠŸå¯åŠ¨</li>
<li>è¿è¡Œä»£ç </li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> visdom <span class="keyword">import</span> Visdom</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">loss = torch.rand(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">global_step = torch.arange(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">viz = Visdom()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">viz.line([<span class="number">0.</span>],[<span class="number">0.</span>],win=<span class="string">&#x27;train_loss&#x27;</span>,opts = <span class="built_in">dict</span>(title=<span class="string">&#x27;train_loss&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx,lossi <span class="keyword">in</span> <span class="built_in">enumerate</span>(loss):</span><br><span class="line">   </span><br><span class="line">    viz.line([lossi.item()],[idx],win = <span class="string">&#x27;train_loss&#x27;</span>,update=<span class="string">&#x27;append&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>æµè§ˆå™¨æŸ¥çœ‹</li>
</ol>
<p><img src="/posts/f19419c5/image-20221124200104212.png" alt="æµè§ˆå™¨è§†å›¾" style="zoom:67%;"></p>
<h4 id="å®Œæ•´æ¨¡å‹è®­ç»ƒæµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨visdomå¯è§†åŒ–"><a href="#å®Œæ•´æ¨¡å‹è®­ç»ƒæµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨visdomå¯è§†åŒ–" class="headerlink" title="å®Œæ•´æ¨¡å‹è®­ç»ƒæµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨visdomå¯è§†åŒ–"></a>å®Œæ•´æ¨¡å‹è®­ç»ƒæµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨visdomå¯è§†åŒ–</h4><p><a href="https://github.com/Xandra298/Pytorchlearning/tree/master/mnist data/MNIST">æ‰‹å†™æ•°å­—è¯†åˆ«æ•°æ®é›†</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"><span class="keyword">import</span>  torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span>  torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span>  torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span>    torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> visdom <span class="keyword">import</span> Visdom</span><br><span class="line"></span><br><span class="line">batch_size=<span class="number">200</span></span><br><span class="line">learning_rate=<span class="number">0.01</span></span><br><span class="line">epochs=<span class="number">2</span></span><br><span class="line"></span><br><span class="line">train_loader = torch.utils.data.DataLoader(</span><br><span class="line">    datasets.MNIST(<span class="string">&#x27;./mnist data/&#x27;</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>,</span><br><span class="line">                   transform=transforms.Compose([</span><br><span class="line">                       transforms.ToTensor(),</span><br><span class="line">                       <span class="comment"># transforms.Normalize((0.1307,), (0.3081,))</span></span><br><span class="line">                   ])),</span><br><span class="line">    batch_size=batch_size, shuffle=<span class="literal">True</span>)</span><br><span class="line">test_loader = torch.utils.data.DataLoader(</span><br><span class="line">    datasets.MNIST(<span class="string">&#x27;./mnist data/&#x27;</span>, train=<span class="literal">False</span>, transform=transforms.Compose([</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        <span class="comment"># transforms.Normalize((0.1307,), (0.3081,))</span></span><br><span class="line">    ])),</span><br><span class="line">    batch_size=batch_size, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MLP</span>(nn.Module):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MLP, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.model = nn.Sequential(</span><br><span class="line">            nn.Linear(<span class="number">784</span>, <span class="number">200</span>),</span><br><span class="line">            nn.LeakyReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.Linear(<span class="number">200</span>, <span class="number">200</span>),</span><br><span class="line">            nn.LeakyReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.Linear(<span class="number">200</span>, <span class="number">10</span>),</span><br><span class="line">            nn.LeakyReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.model(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda:0&#x27;</span>)</span><br><span class="line">net = MLP().to(device)</span><br><span class="line">optimizer = optim.SGD(net.parameters(), lr=learning_rate)</span><br><span class="line">criteon = nn.CrossEntropyLoss().to(device)</span><br><span class="line"></span><br><span class="line">viz = Visdom()</span><br><span class="line"></span><br><span class="line">viz.line([<span class="number">0.</span>], [<span class="number">0.</span>], win=<span class="string">&#x27;train_loss&#x27;</span>, opts=<span class="built_in">dict</span>(title=<span class="string">&#x27;train loss&#x27;</span>))</span><br><span class="line">viz.line([[<span class="number">0.0</span>, <span class="number">0.0</span>]], [<span class="number">0.</span>], win=<span class="string">&#x27;test&#x27;</span>, opts=<span class="built_in">dict</span>(title=<span class="string">&#x27;test loss&amp;acc.&#x27;</span>,</span><br><span class="line">                                                   legend=[<span class="string">&#x27;loss&#x27;</span>, <span class="string">&#x27;acc.&#x27;</span>]))</span><br><span class="line">global_step = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line">        data = data.view(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>)</span><br><span class="line">        data, target = data.to(device), target.to(device)</span><br><span class="line"></span><br><span class="line">        logits = net(data)</span><br><span class="line">        loss = criteon(logits, target)</span><br><span class="line"></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        <span class="comment"># print(w1.grad.norm(), w2.grad.norm())</span></span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        global_step += <span class="number">1</span></span><br><span class="line">        viz.line([loss.item()], [global_step], win=<span class="string">&#x27;train_loss&#x27;</span>, update=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> batch_idx % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Train Epoch: &#123;&#125; [&#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%)]\tLoss: &#123;:.6f&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                epoch, batch_idx * <span class="built_in">len</span>(data), <span class="built_in">len</span>(train_loader.dataset),</span><br><span class="line">                       <span class="number">100.</span> * batch_idx / <span class="built_in">len</span>(train_loader), loss.item()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    test_loss = <span class="number">0</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> data, target <span class="keyword">in</span> test_loader:</span><br><span class="line">        data = data.view(-<span class="number">1</span>, <span class="number">28</span> * <span class="number">28</span>)</span><br><span class="line">        data, target = data.to(device), target.cuda()</span><br><span class="line">        logits = net(data)</span><br><span class="line">        test_loss += criteon(logits, target).item()</span><br><span class="line"></span><br><span class="line">        pred = logits.argmax(dim=<span class="number">1</span>)</span><br><span class="line">        correct += pred.eq(target).<span class="built_in">float</span>().<span class="built_in">sum</span>().item()</span><br><span class="line"></span><br><span class="line">    viz.line([[test_loss, correct / <span class="built_in">len</span>(test_loader.dataset)]],</span><br><span class="line">             [global_step], win=<span class="string">&#x27;test&#x27;</span>, update=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line">    viz.images(data.view(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>), win=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    viz.text(<span class="built_in">str</span>(pred.detach().cpu().numpy()), win=<span class="string">&#x27;pred&#x27;</span>,</span><br><span class="line">             opts=<span class="built_in">dict</span>(title=<span class="string">&#x27;pred&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    test_loss /= <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy: &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%)\n&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        test_loss, correct, <span class="built_in">len</span>(test_loader.dataset),</span><br><span class="line">        <span class="number">100.</span> * correct / <span class="built_in">len</span>(test_loader.dataset)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>è§†å›¾</li>
</ul>
<p>â€‹        <img src="/posts/f19419c5/image-20221124201948485.png" alt="image-20221124201948485"></p>
<h2 id="ç«¯å£å ç”¨å¤„ç†"><a href="#ç«¯å£å ç”¨å¤„ç†" class="headerlink" title="ç«¯å£å ç”¨å¤„ç†"></a>ç«¯å£å ç”¨å¤„ç†</h2><p>windowsä¸Š</p>
<ul>
<li>æŸ¥æ‰¾æœ¬ç«¯å£å½“å‰ä½¿ç”¨æƒ…å†µ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netstat -ano |findstr &quot;8097&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TCP    0.0.0.0:8097           0.0.0.0:0              LISTENING       12236</span><br><span class="line">  TCP    [::]:8097              [::]:0                 LISTENING       12236</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥è¯¢å½“å‰ç«¯å£PIDçš„è¿›ç¨‹ï¼Œå‰ä¸€æ­¥çœ‹åˆ°ä¸º12236</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tasklist | findstr 12236</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»ˆæ­¢è¿›ç¨‹</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">taskkill /f /t /im &quot;12236&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆåŠŸ: å·²ç»ˆæ­¢ PID 12236 (å±äº PID 7560 å­è¿›ç¨‹)çš„è¿›ç¨‹ã€‚</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€pytorch-learningã€‘(äºŒ) æ¨¡å‹æ­å»º-è®­ç»ƒ-æµ‹è¯•</title>
    <url>/posts/13fc6476/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="æ¨¡å‹æ­å»º"><a href="#æ¨¡å‹æ­å»º" class="headerlink" title="æ¨¡å‹æ­å»º"></a>æ¨¡å‹æ­å»º</h1><h2 id="è‡ªå®šä¹‰æ¨¡å‹"><a href="#è‡ªå®šä¹‰æ¨¡å‹" class="headerlink" title="è‡ªå®šä¹‰æ¨¡å‹"></a>è‡ªå®šä¹‰æ¨¡å‹</h2><p>åŸºæœ¬éª¨æ¶ä¸º <code>torch.nn.Module</code></p>
<span id="more"></span>
<p>å®ç°ä¸€ä¸ªç»§æ‰¿è‡ªModuleçš„ç±»ï¼Œè¯¥ç±»ä¸­ä¸»è¦åŒ…å«initå’Œforwardæ–¹æ³•ã€‚</p>
<p>é€šè¿‡forwardæ–¹æ³•å®Œæˆç½‘ç»œçš„å‰å‘ä¼ é€’ã€‚</p>
<p>è¯¦ç»†è®²è§£è§æˆ‘è®°çš„Bç«™å°åœŸå †çš„ç¬”è®°ï¼š<a href="https://github.com/Xandra298/Pytorchlearning/blob/master/å°åœŸå †/1.2pytorchä½¿ç”¨_ç¥ç»ç½‘ç»œæ­å»º.ipynb">ç¥ç»ç½‘ç»œæ­å»º</a></p>
<p>ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span>  nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;dataset/&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor(),download= <span class="literal">True</span>)</span><br><span class="line">dataloader  = DataLoader(dataset,batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Model_conv</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Model_conv, self).__init__()</span><br><span class="line">        self.conv1 = Conv2d(in_channels=<span class="number">3</span>,out_channels=<span class="number">3</span>,kernel_size=<span class="number">3</span>,stride=<span class="number">1</span>,padding=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        <span class="keyword">return</span>  x</span><br><span class="line"></span><br><span class="line">model = Model_conv()</span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataloader:</span><br><span class="line">    imgs,target = data</span><br><span class="line">    <span class="built_in">print</span>(imgs.shape)</span><br><span class="line">    output = model(imgs)</span><br><span class="line">    <span class="built_in">print</span>(output.shape)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>torch.nn.Sequential</code>ä½¿ç”¨ç¤ºä¾‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Linear, Sequential</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Model</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Model, self).__init__()</span><br><span class="line">        self.model1 = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, kernel_size=<span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            nn.Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">model = Model()</span><br></pre></td></tr></table></figure>
<h2 id="è¿ç§»å­¦ä¹ "><a href="#è¿ç§»å­¦ä¹ " class="headerlink" title="è¿ç§»å­¦ä¹ "></a>è¿ç§»å­¦ä¹ </h2><p>ä¿®æ”¹å·²æœ‰ç½‘ç»œæ¨¡å‹ç”¨äºè‡ªå·±çš„ä»»åŠ¡</p>
<h3 id="å®ä¾‹ä¸€ï¼šå°†VGG16ç”¨äºæ•°æ®é›†CIFAR10çš„åˆ†ç±»"><a href="#å®ä¾‹ä¸€ï¼šå°†VGG16ç”¨äºæ•°æ®é›†CIFAR10çš„åˆ†ç±»" class="headerlink" title="å®ä¾‹ä¸€ï¼šå°†VGG16ç”¨äºæ•°æ®é›†CIFAR10çš„åˆ†ç±»"></a>å®ä¾‹ä¸€ï¼šå°†VGG16ç”¨äºæ•°æ®é›†CIFAR10çš„åˆ†ç±»</h3><p>VGG16<a href="https://pytorch.org/vision/0.9/models.html">æ¨¡å‹</a> çš„datasetæ˜¯<a href="https://pytorch.org/vision/0.8/datasets.html#imagenet">ImagNet</a></p>
<p>é€šè¿‡torchvision.models.vgg16(pretained=True)(pretained=Trueä¼šå°†å…¶æƒé‡ä¹Ÿä¸‹è½½ä¸‹æ¥ï¼‰å°†æ¨¡å‹ä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œé»˜è®¤ä¿å­˜è·¯å¾„æ˜¯<code>C:\Users\[usename].cache\torch\hub\checkpoints</code></p>
<p>VGG16ç”¨äº1000åˆ†ç±»ï¼ˆæœ€åå…¨è¿æ¥å±‚çš„è¾“å‡ºæ˜¯1000ï¼‰ï¼Œä½¿ç”¨æ•°æ®é›†CIFAR10æ˜¯éœ€è¦10åˆ†ç±»çš„ã€‚å› æ­¤éš¾ç‚¹åœ¨äºå¦‚ä½•ä½¿ç”¨è¯¥VGGæ¨¡å‹è¿›è¡Œè¿ç§»ã€‚ ä¸‹æ–‡ä»£ç å±•ç°äº†ä¸¤ç§ä¸»è¦æ–¹å¼</p>
<h4 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span>  nn</span><br><span class="line"><span class="comment"># vgg16_false = torchvision.models.vgg16(pretrained=False)</span></span><br><span class="line">vgg16_true = torchvision.models.vgg16(pretrained=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train_data = torchvision.datasets.CIFAR10(<span class="string">&quot;dataset&quot;</span>,train=<span class="literal">True</span>,transform=torchvision.transforms.ToTensor(),download=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">##traindataæ˜¯10åˆ†ç±»ï¼Œè€Œvgg16æ˜¯1000åˆ†ç±»</span></span><br><span class="line"></span><br><span class="line">vgg16_true.add_module(<span class="string">&#x27;add_linear&#x27;</span>,nn.Linear(<span class="number">1000</span>,<span class="number">10</span>))</span><br><span class="line"><span class="built_in">print</span>(vgg16_true)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>VGGæ¨¡å‹æ·»åŠ äº†ä¸€å±‚ä¹‹åçš„ç»“æ„</p>
<p>å¤šäº†ä¸€å±‚æ·»åŠ çš„ï¼š</p>
<p><code>(add_linear): Linear(in_features=1000, out_features=10, bias=True)</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VGG(</span><br><span class="line">  (features): Sequential(</span><br><span class="line">    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (1): ReLU(inplace=True)</span><br><span class="line">    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (3): ReLU(inplace=True)</span><br><span class="line">    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</span><br><span class="line">    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (6): ReLU(inplace=True)</span><br><span class="line">    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (8): ReLU(inplace=True)</span><br><span class="line">    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</span><br><span class="line">    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (11): ReLU(inplace=True)</span><br><span class="line">    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (13): ReLU(inplace=True)</span><br><span class="line">    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (15): ReLU(inplace=True)</span><br><span class="line">    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</span><br><span class="line">    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (18): ReLU(inplace=True)</span><br><span class="line">    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (20): ReLU(inplace=True)</span><br><span class="line">    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (22): ReLU(inplace=True)</span><br><span class="line">    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</span><br><span class="line">    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (25): ReLU(inplace=True)</span><br><span class="line">    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (27): ReLU(inplace=True)</span><br><span class="line">    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">    (29): ReLU(inplace=True)</span><br><span class="line">    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</span><br><span class="line">  )</span><br><span class="line">  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))</span><br><span class="line">  (classifier): Sequential(</span><br><span class="line">    (0): Linear(in_features=25088, out_features=4096, bias=True)</span><br><span class="line">    (1): ReLU(inplace=True)</span><br><span class="line">    (2): Dropout(p=0.5, inplace=False)</span><br><span class="line">    (3): Linear(in_features=4096, out_features=4096, bias=True)</span><br><span class="line">    (4): ReLU(inplace=True)</span><br><span class="line">    (5): Dropout(p=0.5, inplace=False)</span><br><span class="line">    (6): Linear(in_features=4096, out_features=1000, bias=True)</span><br><span class="line">  )</span><br><span class="line">  (add_linear): Linear(in_features=1000, out_features=10, bias=True)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h4><p>æƒ³è¦åŠ åˆ°å…¶ä¸­çš„classifieré‡Œé¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vgg16_true.classifier.add_module(<span class="string">&#x27;add_linear&#x27;</span>,nn.Linear(<span class="number">1000</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<h3 id="å®ä¾‹äºŒï¼šresnet18"><a href="#å®ä¾‹äºŒï¼šresnet18" class="headerlink" title="å®ä¾‹äºŒï¼šresnet18"></a>å®ä¾‹äºŒï¼šresnet18</h3><p>è·å–ç½‘ç»œä¸­çš„æ¨¡å‹ï¼Œé€šè¿‡Sequentialå®Œæˆæ–°æ¨¡å‹çš„ç»„å»º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision.models <span class="keyword">import</span> resnet18 <span class="comment">##ä»ç½‘ç»œè·å–æ¨¡å‹</span></span><br><span class="line">trained_model = resnet18(pretrained=<span class="literal">True</span>)</span><br><span class="line">                <span class="comment">#*ç”¨äºè¿­ä»£å–å‡ºlistä¸­çš„å†…å®¹</span></span><br><span class="line">model = nn.Sequential(*<span class="built_in">list</span>(trained_model.children())[:-<span class="number">1</span>],<span class="comment">#[b,512,1,1]</span></span><br><span class="line">                          nn.Flatten(),<span class="comment">#[b,512,1,1]=&gt;[b,512]</span></span><br><span class="line">                          nn.Linear(<span class="number">512</span>,<span class="number">5</span>)</span><br><span class="line">                          ).to(device)</span><br></pre></td></tr></table></figure>
<h1 id="æ¨¡å‹ä¿å­˜å’Œè¯»å–"><a href="#æ¨¡å‹ä¿å­˜å’Œè¯»å–" class="headerlink" title="æ¨¡å‹ä¿å­˜å’Œè¯»å–"></a>æ¨¡å‹ä¿å­˜å’Œè¯»å–</h1><h2 id="æ–¹å¼ä¸€-1"><a href="#æ–¹å¼ä¸€-1" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torchvision</span><br><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¨¡å‹</span></span><br><span class="line">vgg16 = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ##ä¿å­˜æ–¹å¼1 æ¨¡å‹ç»“æ„+æ¨¡å‹å‚æ•°</span></span><br><span class="line"><span class="comment"># ### å‚æ•°ï¼šæ¨¡å‹ï¼Œè·¯å¾„</span></span><br><span class="line"></span><br><span class="line">torch.save(vgg16,<span class="string">&quot;vgg16_modelsave_1.pth&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">###è¯»å–æ–¹å¼1&gt;&gt;ä¿å­˜æ–¹å¼1</span></span><br><span class="line"><span class="comment">##å‚æ•°ï¼šè·¯å¾„</span></span><br><span class="line">model = torch.load(<span class="string">&quot;vgg16_modelsave_1.pth&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(model)</span><br></pre></td></tr></table></figure>
<h2 id="æ–¹å¼äºŒï¼ˆæ¨èï¼‰"><a href="#æ–¹å¼äºŒï¼ˆæ¨èï¼‰" class="headerlink" title="æ–¹å¼äºŒï¼ˆæ¨èï¼‰"></a>æ–¹å¼äºŒï¼ˆæ¨èï¼‰</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torchvision</span><br><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¨¡å‹</span></span><br><span class="line">vgg16 = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#ä¿å­˜æ–¹å¼2 æ¨¡å‹å‚æ•°ï¼ˆå®˜æ–¹æ¨èï¼‰</span></span><br><span class="line"><span class="comment">##å‚æ•°ï¼šæ¨¡å‹.state_dict(),è·¯å¾„</span></span><br><span class="line"><span class="comment">##527M</span></span><br><span class="line">torch.save(vgg16.state_dict(),<span class="string">&quot;vgg16_modelsave_2.pth&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">##è¯»å–æ–¹å¼2&gt;&gt;ä¿å­˜æ–¹å¼2</span></span><br><span class="line">vgg16 = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line">vgg16.load_state_dict(torch.load(<span class="string">&quot;vgg16_modelsave_2.pth&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(vgg16)</span><br></pre></td></tr></table></figure>
<h2 id="æ–¹å¼ä¸€çš„æŠ¥é”™å®ä¾‹"><a href="#æ–¹å¼ä¸€çš„æŠ¥é”™å®ä¾‹" class="headerlink" title="æ–¹å¼ä¸€çš„æŠ¥é”™å®ä¾‹"></a>æ–¹å¼ä¸€çš„æŠ¥é”™å®ä¾‹</h2><p>æŠ¥é”™è¿‡ç¨‹ï¼š</p>
<ol>
<li><p>a.pyä¸­åˆ›å»ºæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨toch.save(model,â€model pathâ€)</p>
</li>
<li><p>b.pyä¸­åŠ è½½è¯¥æ¨¡å‹ï¼šmodel = torch.load(â€œmodel pathâ€)</p>
</li>
</ol>
<p>è§£å†³æ–¹æ¡ˆï¼šè¦è®©è¯¥æ–‡ä»¶èƒ½è®¿é—®åˆ°è¯¥æ¨¡å‹çš„å®šä¹‰ã€‚</p>
<ul>
<li><p>åœ¨ç›´æ¥åŠ è½½å‰é‡æ–°å®šä¹‰ä¸€ä¸‹è¯¥æ¨¡å‹</p>
</li>
<li><p>æˆ–è€… <code>from model_save import *</code> å³åœ¨å¤´æ–‡ä»¶importä¸€ä¸‹è¯¥æ¨¡å‹å®šä¹‰æ–‡ä»¶</p>
</li>
</ul>
<h1 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h1><h2 id="éšæœºæ¢¯åº¦ä¸‹é™"><a href="#éšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="éšæœºæ¢¯åº¦ä¸‹é™"></a>éšæœºæ¢¯åº¦ä¸‹é™</h2><p><a href="https://github.com/Xandra298/Pytorchlearning/blob/master/4.éšæœºæ¢¯åº¦ä¸‹é™.ipynb">è¯¦ç»†ç†è®º</a>)</p>
<h3 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h3><p>é€šè¿‡æŸå¤±å‡½æ•°è®¡ç®—ç»è¿‡è®­ç»ƒçš„æ¨¡å‹å…¶é¢„æµ‹ç»“æœä¸çœŸå®å€¼çš„è¯¯å·®ï¼Œlossè¶Šå°è¯´æ˜äºŒè€…è¶Šæ¥è¿‘ã€‚</p>
<p>é€šè¿‡æ¢¯åº¦ä¸‹é™æœç´¢æå€¼ç‚¹ã€‚è®¡ç®—lossï¼Œé€šè¿‡loss.backward()åå‘ä¼ æ’­è¿›è¡Œè‡ªåŠ¨æ±‚å¯¼è·å¾—æ¢¯åº¦ã€‚</p>
<p>å¯¹äºæ¨¡å‹è€Œè¨€ï¼Œå˜åŒ–çš„æ˜¯å„ä¸ªæƒé‡å‚æ•°wã€‚</p>
<p><a href="https://pytorch.org/docs/1.8.1/generated/torch.nn.CrossEntropyLoss.html#torch.nn.CrossEntropyLoss">CrossEntropyLoss</a></p>
<p>ä½¿ç”¨å®ä¾‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span>  nn</span><br><span class="line">x = torch.tensor([<span class="number">0.1</span>,<span class="number">0.8</span>,<span class="number">0.1</span>])</span><br><span class="line">y = torch.tensor([<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">x = x.reshape(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">loss_cross = nn.CrossEntropyLoss()</span><br><span class="line">result_cross = loss_cross(x,y)</span><br><span class="line"><span class="built_in">print</span>(result_cross)</span><br></pre></td></tr></table></figure>
<h3 id="ä¼˜åŒ–å™¨"><a href="#ä¼˜åŒ–å™¨" class="headerlink" title="ä¼˜åŒ–å™¨"></a>ä¼˜åŒ–å™¨</h3><p>å†³å®šæ¢¯åº¦ä¸‹é™çš„æ–¹å¼ã€‚</p>
<p>ä½¿ç”¨ä¸»è¦å…³è”å››è¡Œä»£ç ï¼š</p>
<ul>
<li><code>optim = torch.optim.SGD(model.parameters(),lr=0.01)</code>  ï¼ˆSGDä¸ºä¸€ç§ä¼˜åŒ–å™¨ï¼‰</li>
</ul>
<p>epoch å†…</p>
<ul>
<li><code>optim.zero_grad()</code> ##å°†ä¼˜åŒ–å™¨æ¢¯åº¦æ¸…é›¶ï¼Œæ¯ä¸€æ¬¡å¾ªç¯æ³¨æ„æ¸…é›¶</li>
<li><code>result_loss.backward()</code></li>
<li><code>optim.step()</code></li>
</ul>
<h2 id="è®­ç»ƒæ¨¡å‹"><a href="#è®­ç»ƒæ¨¡å‹" class="headerlink" title="è®­ç»ƒæ¨¡å‹"></a>è®­ç»ƒæ¨¡å‹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;----epoch &#123;&#125; starting----&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="comment">##è®­ç»ƒæ­¥éª¤å¼€å§‹</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> train_dataloader:</span><br><span class="line">        imgs,targets = data</span><br><span class="line">        outputs = model(imgs)</span><br><span class="line">        loss = loss_fn(outputs,targets)</span><br><span class="line"></span><br><span class="line">        <span class="comment">##ä¼˜åŒ–å™¨ä¼˜åŒ–æ¨¡å‹</span></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        total_train_step+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> total_train_step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;batch &#123;&#125;---loss:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(total_train_step,loss.item()))</span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="æ¨¡å‹æµ‹è¯•è¯„ä¼°"><a href="#æ¨¡å‹æµ‹è¯•è¯„ä¼°" class="headerlink" title="æ¨¡å‹æµ‹è¯•è¯„ä¼°"></a>æ¨¡å‹æµ‹è¯•è¯„ä¼°</h1><p>å°†æµ‹è¯•é›†ä¼ å…¥è®­ç»ƒå¥½çš„æ¨¡å‹å¾—åˆ°é¢„æµ‹è¾“å‡ºã€‚</p>
<p>å°†é¢„æµ‹è¾“å‡ºå’Œæµ‹è¯•é›†çš„labelè¿›è¡Œæ¯”è¾ƒä»¥è¯„ä¼°è¯¥æ¨¡å‹ã€‚</p>
<p>æœ‰æ ‡ç­¾çš„è¯„ä¼°æŒ‡æ ‡æœ‰ï¼š</p>
<ul>
<li>å‡†ç¡®ç‡</li>
<li>å¬å›ç‡</li>
<li>ç²¾ç¡®ç‡</li>
<li>F1-score</li>
<li>â€¦</li>
</ul>
<p>å¦å¤–ï¼Œå¦‚ROCæ›²çº¿ï¼ŒAUCï¼ŒAPç­‰ä¹Ÿæ˜¯å¸¸è§çš„è¯„ä¼°</p>
<h1 id="è‡ªå®šä¹‰æ•°æ®é›†å®æˆ˜"><a href="#è‡ªå®šä¹‰æ•°æ®é›†å®æˆ˜" class="headerlink" title="è‡ªå®šä¹‰æ•°æ®é›†å®æˆ˜"></a>è‡ªå®šä¹‰æ•°æ®é›†å®æˆ˜</h1><h2 id="æ•°æ®é¢„å¤„ç†ä¸åŠ è½½"><a href="#æ•°æ®é¢„å¤„ç†ä¸åŠ è½½" class="headerlink" title="æ•°æ®é¢„å¤„ç†ä¸åŠ è½½"></a>æ•°æ®é¢„å¤„ç†ä¸åŠ è½½</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> os,glob</span><br><span class="line"><span class="keyword">import</span> random,csv</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset,DataLoader</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pokemen</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,root,resize,mode</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param root: æ•°æ®é›†æ ¹ç›®å½•ï¼›</span></span><br><span class="line"><span class="string">                    è¿™æ¬¡çš„å­˜å‚¨å½¢å¼æ˜¯æ ¹ç›®å½•ä¸‹æœ‰æ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯æ•°æ®é›†å›¾ç‰‡ï¼Œæ–‡ä»¶å¤¹åç§°æ˜¯å¯¹åº”çš„ç±»åˆ«</span></span><br><span class="line"><span class="string">        :param resize:</span></span><br><span class="line"><span class="string">        :param mode: train\test\val</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">super</span>(Pokemen, self).__init__()</span><br><span class="line">        self.root = root</span><br><span class="line">        self.resize = resize</span><br><span class="line"></span><br><span class="line">        self.name2label = &#123;&#125;<span class="comment"># å­˜å‚¨nameå¯¹åº”ç¼–ç çš„å­—å…¸</span></span><br><span class="line">        <span class="comment">#éå†æ ¹ç›®å½•ä¸‹æ–‡ä»¶å¤¹åç§°</span></span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> <span class="built_in">sorted</span>(os.listdir(os.path.join(root))):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(os.path.join(root,name)):</span><br><span class="line">                <span class="comment"># not a dir</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># æŒ‰ç…§å…ˆåé¡ºåºè·å¾—ç¼–ç </span></span><br><span class="line">            self.name2label[name] = <span class="built_in">len</span>(self.name2label.keys())</span><br><span class="line">        <span class="built_in">print</span>(self.name2label)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä»csvæ–‡ä»¶ä¸­è¯»å– image_path-labelï¼›</span></span><br><span class="line">        <span class="comment"># load_csvæ–¹æ³•å®ç°å°†æ•°æ®é›†æ¡ç›®ï¼šimage_path-label æ•´ç†åˆ°csvæ–‡ä»¶ä¸­</span></span><br><span class="line">        self.images,self.labels = self.load_csv(<span class="string">&quot;image.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">        <span class="keyword">if</span> mode == <span class="string">&#x27;train&#x27;</span>: <span class="comment">#60%</span></span><br><span class="line">            self.images = self.images[:<span class="built_in">int</span>(<span class="number">0.6</span>*<span class="built_in">len</span>(self.images))]</span><br><span class="line">            self.labels = self.labels[:<span class="built_in">int</span>(<span class="number">0.6</span>*<span class="built_in">len</span>(self.labels))]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;val&#x27;</span>: <span class="comment">#20%</span></span><br><span class="line">            self.images = self.images[<span class="built_in">int</span>(<span class="number">0.6</span> * <span class="built_in">len</span>(self.images)):<span class="built_in">int</span>(<span class="number">0.8</span>*<span class="built_in">len</span>(self.images))]</span><br><span class="line">            self.labels = self.labels[<span class="built_in">int</span>(<span class="number">0.6</span> * <span class="built_in">len</span>(self.labels)):<span class="built_in">int</span>(<span class="number">0.8</span>*<span class="built_in">len</span>(self.labels))]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">            self.images = self.images[<span class="built_in">int</span>(<span class="number">0.8</span> * <span class="built_in">len</span>(self.images)):]</span><br><span class="line">            self.labels = self.labels[<span class="built_in">int</span>(<span class="number">0.8</span> * <span class="built_in">len</span>(self.labels)):]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_csv</span>(<span class="params">self,filename</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        å°†æ•°æ®é›†çš„image_path-labelå­˜å‚¨åˆ°csvæ–‡ä»¶ä¸­ï¼Œå¹¶ä»csvæ–‡ä»¶åŠ è½½</span></span><br><span class="line"><span class="string">        :param filename: å­˜å‚¨csvçš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">        :return: images,labels==&gt; images_path,labels</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        savepath = os.path.join(self.root,filename)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(savepath):</span><br><span class="line">            images = []</span><br><span class="line">            <span class="keyword">for</span> name <span class="keyword">in</span> self.name2label.keys():</span><br><span class="line">                <span class="comment">#è·å–å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„å›¾ç‰‡æ–‡ä»¶,å­˜å‚¨åˆ°list(images)å†…</span></span><br><span class="line">                images += glob.glob(os.path.join(self.root,name,<span class="string">&#x27;*.png&#x27;</span>))</span><br><span class="line">                images += glob.glob(os.path.join(self.root, name, <span class="string">&#x27;*.jpg&#x27;</span>))</span><br><span class="line">                images += glob.glob(os.path.join(self.root, name, <span class="string">&#x27;*.gif&#x27;</span>))</span><br><span class="line">            <span class="comment">#print(images)</span></span><br><span class="line">            <span class="comment">#&#x27;./pokeman/squirtle\\00000073.png&#x27;</span></span><br><span class="line">            random.shuffle(images) <span class="comment">#shuffle</span></span><br><span class="line">            <span class="comment">#å†™å…¥csv</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(savepath,mode=<span class="string">&#x27;w&#x27;</span>,newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                writer = csv.writer(f)</span><br><span class="line">                <span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">                    name = img.split(os.sep)[-<span class="number">2</span>]</span><br><span class="line">                    label = self.name2label[name]</span><br><span class="line">                    writer.writerow([img,label])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;written into csv file:&#x27;</span>,savepath)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#ä»csvæ–‡ä»¶è¯»å–</span></span><br><span class="line">        images,labels = [],[]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(savepath) <span class="keyword">as</span> f:</span><br><span class="line">            reader = csv.reader(f)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">                img,label = row</span><br><span class="line">                label = <span class="built_in">int</span>(label)</span><br><span class="line">                images.append(img)</span><br><span class="line">                labels.append(label)</span><br><span class="line">        <span class="keyword">assert</span>  <span class="built_in">len</span>(images) == <span class="built_in">len</span>(labels)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span>  images,labels</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        :return: æ•°æ®é›†é•¿åº¦</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.images)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :param item: range in [0,len(images)]</span></span><br><span class="line"><span class="string">        :return: self.images,self.labels</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        img,label = self.images[item],self.labels[item]</span><br><span class="line">        </span><br><span class="line">        tf = transforms.Compose(</span><br><span class="line">            [<span class="keyword">lambda</span> x:Image.<span class="built_in">open</span>(x).convert(<span class="string">&#x27;RGB&#x27;</span>), <span class="comment"># open image and convert to RGB</span></span><br><span class="line">             transforms.Resize((<span class="built_in">int</span>(self.resize*<span class="number">1.25</span>),<span class="built_in">int</span>(self.resize*<span class="number">1.25</span>))),</span><br><span class="line">             transforms.RandomRotation(<span class="number">15</span>),</span><br><span class="line">             transforms.CenterCrop(self.resize),</span><br><span class="line">             transforms.ToTensor(),</span><br><span class="line">             transforms.Normalize(mean=[<span class="number">0.485</span>,<span class="number">0.456</span>,<span class="number">0.406</span>],std=[<span class="number">0.229</span>,<span class="number">0.224</span>,<span class="number">0.225</span>]),<span class="comment">#values computed from ImageNetï¼Œwe could use it in other dataset   </span></span><br><span class="line">             </span><br><span class="line">             ]  </span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        img = tf(img)</span><br><span class="line">        label = torch.tensor(label)</span><br><span class="line">        <span class="keyword">return</span> img,label</span><br><span class="line">db = Pokemon(<span class="string">&#x27;./pokeman&#x27;</span>, <span class="number">224</span>, <span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">x,y = <span class="built_in">next</span>(<span class="built_in">iter</span>(db))</span><br><span class="line"><span class="built_in">print</span>(x.shape,y.shape)</span><br></pre></td></tr></table></figure>
<pre><code>&#123;&#39;.ipynb_checkpoints&#39;: 0, &#39;bulbasaur&#39;: 1, &#39;charmander&#39;: 2, &#39;mewtwo&#39;: 3, &#39;pikachu&#39;: 4, &#39;squirtle&#39;: 5&#125;
written into csv file:  ./pokeman\image.csv
torch.Size([3, 224, 224]) torch.Size([])
</code></pre><h3 id="æ•°æ®é›†åŠ è½½ï¼šDataLoader"><a href="#æ•°æ®é›†åŠ è½½ï¼šDataLoader" class="headerlink" title="æ•°æ®é›†åŠ è½½ï¼šDataLoader"></a>æ•°æ®é›†åŠ è½½ï¼šDataLoader</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  visdom</span><br><span class="line"><span class="keyword">import</span>  torchvision</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">db = Pokemon(<span class="string">&#x27;./pokeman&#x27;</span>, <span class="number">224</span>, <span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">x,y = <span class="built_in">next</span>(<span class="built_in">iter</span>(db))</span><br><span class="line"><span class="built_in">print</span>(x.shape,y.shape)</span><br><span class="line">loader = DataLoader(db,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ç½‘ç»œåˆ›å»º"><a href="#ç½‘ç»œåˆ›å»º" class="headerlink" title="ç½‘ç»œåˆ›å»º"></a>ç½‘ç»œåˆ›å»º</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Resnet.py</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span>  torch <span class="keyword">import</span>  nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResBlk</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    resnet block</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,ch_in,ch_out,stride=<span class="number">1</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param ch_in:[b,ch,h,w]</span></span><br><span class="line"><span class="string">        :param ch_out:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(ResBlk, self).__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(ch_in,ch_out,kernel_size=<span class="number">3</span>,stride=stride,padding=<span class="number">1</span>)</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(ch_out)</span><br><span class="line">        self.conv2 = nn.Conv2d(ch_out,ch_out,kernel_size=<span class="number">3</span>,stride=<span class="number">1</span>,padding=<span class="number">1</span>)</span><br><span class="line">        self.bn2 = nn.BatchNorm2d(ch_out)</span><br><span class="line"></span><br><span class="line">        self.extra = nn.Sequential()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ch_out!=ch_in:</span><br><span class="line">            self.extra = nn.Sequential(</span><br><span class="line">                nn.Conv2d(ch_in,ch_out,kernel_size=<span class="number">1</span>,stride=stride),</span><br><span class="line">                nn.BatchNorm2d(ch_out)</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        out =  F.relu(self.bn1(self.conv1(x)))</span><br><span class="line">        out = self.bn2(self.conv2(out))</span><br><span class="line"></span><br><span class="line">        <span class="comment">##short cut</span></span><br><span class="line">        <span class="comment">#extra module:[b,ch_in,h,w]=&gt;[b,ch_out,h,w]</span></span><br><span class="line">        <span class="comment">#element-wise add</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        out = self.extra(x) +out</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResNet18</span>(nn.Module):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,num_class</span>):</span><br><span class="line">        <span class="built_in">super</span>(ResNet18, self).__init__()</span><br><span class="line">        self.conv1 = nn.Sequential(</span><br><span class="line">            nn.Conv2d(<span class="number">3</span>,<span class="number">16</span>,kernel_size=<span class="number">3</span>,stride=<span class="number">3</span>,padding=<span class="number">0</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">16</span>)</span><br><span class="line">        )</span><br><span class="line">        <span class="comment">#followed 4 blocks</span></span><br><span class="line">        <span class="comment">#[b,16,h,w]=&gt;[b,32,h,w]</span></span><br><span class="line">        self.blk1 =ResBlk(<span class="number">16</span>,<span class="number">32</span>,stride=<span class="number">3</span>)</span><br><span class="line">        <span class="comment"># [b,32,h,w]=&gt;[b,64,h,w]</span></span><br><span class="line">        self.blk2 = ResBlk(<span class="number">32</span>,<span class="number">64</span>,stride=<span class="number">3</span>)</span><br><span class="line">        <span class="comment">#[b,64,h,w]=&gt;[b,128,h,w]</span></span><br><span class="line">        self.blk3 = ResBlk(<span class="number">64</span>,<span class="number">128</span>,stride=<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># [b,128,h,w]=&gt;[b,256,h,w]</span></span><br><span class="line">        self.blk4 = ResBlk(<span class="number">128</span>,<span class="number">256</span>,stride=<span class="number">2</span>)</span><br><span class="line">        self.flatten = nn.Flatten()</span><br><span class="line">        self.outlayer = nn.Linear(<span class="number">256</span>*<span class="number">3</span>*<span class="number">3</span>,num_class)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param x:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        x = F.relu(self.conv1(x))</span><br><span class="line">        <span class="comment">#[b,64,h,w]=&gt;[b,1024,h,w]</span></span><br><span class="line">        x = self.blk1(x)</span><br><span class="line">        x = self.blk2(x)</span><br><span class="line">        x = self.blk3(x)</span><br><span class="line">        x = self.blk4(x)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;after conv:&quot;</span>,x.shape)</span><br><span class="line">        <span class="comment"># x = F.adaptive_max_pool2d(x,[1,1])</span></span><br><span class="line">        <span class="comment"># print(&quot;after pool,&quot;,x.shape)</span></span><br><span class="line">        x = self.flatten(x)</span><br><span class="line">        x = self.outlayer(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    blk = ResBlk(<span class="number">64</span>,<span class="number">128</span>)</span><br><span class="line">    tmp = torch.rand(<span class="number">2</span>,<span class="number">64</span>,<span class="number">224</span>,<span class="number">224</span>)</span><br><span class="line">    out = blk(tmp)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;block&#x27;</span>,out.shape)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    x  = torch.rand(<span class="number">2</span>,<span class="number">3</span>,<span class="number">224</span>,<span class="number">224</span>)</span><br><span class="line">    model = ResNet18(<span class="number">5</span>)</span><br><span class="line">    out = model(x)</span><br><span class="line">    <span class="built_in">print</span>(out.shape)</span><br><span class="line"></span><br><span class="line">    p = <span class="built_in">sum</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span>  p:p.numel(),model.parameters()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;parameters size:&#x27;</span>,p)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Train-and-test"><a href="#Train-and-test" class="headerlink" title="Train and test"></a>Train and test</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    train(train_db)</span><br><span class="line">    <span class="keyword">if</span> epoch%<span class="number">10</span>==<span class="number">0</span>:</span><br><span class="line">        val_acc = evaluate(val_db)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> val_loss <span class="keyword">is</span> the best:</span><br><span class="line">            save_ckpt()</span><br><span class="line">        <span class="keyword">if</span> out_of_patience():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">load_ckpt()<span class="comment"># checkpoint model</span></span><br><span class="line">test_acc = evaluate(test_db)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#train_scratch.py</span></span><br><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> optim,nn</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pokeman <span class="keyword">import</span> Pokemon</span><br><span class="line"><span class="keyword">from</span> Resnet <span class="keyword">import</span> ResNet18</span><br><span class="line"></span><br><span class="line">batchsz = <span class="number">32</span></span><br><span class="line">lr = <span class="number">1e-2</span></span><br><span class="line">epochs = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span>)</span><br><span class="line">torch.manual_seed(<span class="number">1234</span>)<span class="comment">##éšæœºç§å­</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">val_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;val&#x27;</span>)</span><br><span class="line">test_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">train_loader = DataLoader(train_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">4</span>)</span><br><span class="line">val_loader = DataLoader(val_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">2</span>)</span><br><span class="line">test_loader = DataLoader(test_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evaluate</span>(<span class="params">model,loader</span>):</span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    total = <span class="built_in">len</span>(loader.dataset)</span><br><span class="line">    <span class="keyword">for</span> x,y <span class="keyword">in</span> loader:</span><br><span class="line">        x,y = x.to(device),y.to(device)</span><br><span class="line">        <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">            logits = model(x)</span><br><span class="line">            pred = logits.argmax(dim=<span class="number">1</span>)</span><br><span class="line">        correct += torch.eq(pred,y).<span class="built_in">sum</span>().<span class="built_in">float</span>().item()</span><br><span class="line">    <span class="keyword">return</span> correct/total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    model = ResNet18(<span class="number">5</span>).to(device)</span><br><span class="line">    optimizer = optim.Adam(model.parameters(),lr=lr)</span><br><span class="line">    criteon = nn.CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line">    best_acc,best_epoch=<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    global_step=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="keyword">for</span> step,(img,label) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># x:[b,3,224,224], y:[5]</span></span><br><span class="line">            img,label = img.to(device),label.to(device)</span><br><span class="line"></span><br><span class="line">            logits = model(img)</span><br><span class="line">            loss = criteon(logits,label)</span><br><span class="line"></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            loss.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">          </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> epoch%<span class="number">1</span> ==<span class="number">0</span>:</span><br><span class="line">            val_acc = evaluate(model,val_loader)</span><br><span class="line">            <span class="keyword">if</span> val_acc&gt;best_acc:</span><br><span class="line">                best_epoch = epoch</span><br><span class="line">                best_acc = val_acc</span><br><span class="line"></span><br><span class="line">                torch.save(model.state_dict(),<span class="string">&#x27;best.mdl&#x27;</span>)</span><br><span class="line">            viz.line([val_acc], [epoch], win=<span class="string">&#x27;val_acc&#x27;</span>, update=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;best acc:&#x27;</span>,best_acc,<span class="string">&#x27;best epoch&#x27;</span>,best_epoch)</span><br><span class="line"></span><br><span class="line">    model.load_state_dict(torch.load(<span class="string">&#x27;best.mdl&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;loaded from checkpoint!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    test_acc = evaluate(model,test_loader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test acc&#x27;</span>,test_acc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>best acc: 0.8583690987124464 best epoch 5</p>
<p>test acc 0.8497854077253219</p>
<h1 id="optional-è¿ç§»å­¦ä¹ "><a href="#optional-è¿ç§»å­¦ä¹ " class="headerlink" title="optional: è¿ç§»å­¦ä¹ "></a>optional: è¿ç§»å­¦ä¹ </h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  torch</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> optim,nn</span><br><span class="line"><span class="keyword">import</span>  visdom</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pokeman <span class="keyword">import</span> Pokemon</span><br><span class="line"><span class="keyword">from</span> torchvision.models <span class="keyword">import</span> resnet18 <span class="comment">##ä»ç½‘ç»œè·å–æ¨¡å‹</span></span><br><span class="line"></span><br><span class="line">batchsz = <span class="number">32</span></span><br><span class="line">lr = <span class="number">1e-2</span></span><br><span class="line">epochs = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span>)</span><br><span class="line">torch.manual_seed(<span class="number">1234</span>)<span class="comment">##éšæœºç§å­</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">val_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;val&#x27;</span>)</span><br><span class="line">test_db = Pokemon(<span class="string">&#x27;pokeman&#x27;</span>,<span class="number">224</span>,mode=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">train_loader = DataLoader(train_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">4</span>)</span><br><span class="line">val_loader = DataLoader(val_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">2</span>)</span><br><span class="line">test_loader = DataLoader(test_db,batch_size=batchsz,shuffle=<span class="literal">True</span>,num_workers=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">viz = visdom.Visdom()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evaluate</span>(<span class="params">model,loader</span>):</span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    total = <span class="built_in">len</span>(loader.dataset)</span><br><span class="line">    <span class="keyword">for</span> x,y <span class="keyword">in</span> loader:</span><br><span class="line">        x,y = x.to(device),y.to(device)</span><br><span class="line">        <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">            logits = model(x)</span><br><span class="line">            pred = logits.argmax(dim=<span class="number">1</span>)</span><br><span class="line">        correct = torch.eq(pred,y).<span class="built_in">sum</span>().<span class="built_in">float</span>().item()</span><br><span class="line">    <span class="keyword">return</span> correct/total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># model = ResNet18(5).to(device)</span></span><br><span class="line">    <span class="comment">#-----------------------------------------------------------------------------------</span></span><br><span class="line">    trained_model = resnet18(pretrained=<span class="literal">True</span>)</span><br><span class="line">                <span class="comment">#*ç”¨äºè¿­ä»£å–å‡ºlistä¸­çš„å†…å®¹</span></span><br><span class="line">    model = nn.Sequential(*<span class="built_in">list</span>(trained_model.children())[:-<span class="number">1</span>],<span class="comment">#[b,512,1,1]</span></span><br><span class="line">                          nn.Flatten(),<span class="comment">#[b,512,1,1]=&gt;[b,512]</span></span><br><span class="line">                          nn.Linear(<span class="number">512</span>,<span class="number">5</span>)</span><br><span class="line">                          ).to(device)</span><br><span class="line">    <span class="comment"># x = torch.rand(2,3,224,224)</span></span><br><span class="line">    <span class="comment"># print(model(x).shape)</span></span><br><span class="line">    <span class="comment">#---------------------------------------------------------------------------------------</span></span><br><span class="line">    optimizer = optim.Adam(model.parameters(),lr=lr)</span><br><span class="line">    criteon = nn.CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line">    best_acc,best_epoch=<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    viz.line([<span class="number">0</span>],[-<span class="number">1</span>],win=<span class="string">&#x27;loss&#x27;</span>,opts=<span class="built_in">dict</span>(title=<span class="string">&#x27;loss&#x27;</span>))</span><br><span class="line">    viz.line([<span class="number">0</span>],[-<span class="number">1</span>],win=<span class="string">&#x27;val_acc&#x27;</span>,opts=<span class="built_in">dict</span>(title=<span class="string">&#x27;val_acc&#x27;</span>))</span><br><span class="line">    global_step=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="keyword">for</span> step,(img,label) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># x:[b,3,224,224], y:[5]</span></span><br><span class="line">            img,label = img.to(device),label.to(device)</span><br><span class="line"></span><br><span class="line">            logits = model(img)</span><br><span class="line">            loss = criteon(logits,label)</span><br><span class="line"></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            loss.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">            viz.line([loss.item()], [global_step], win=<span class="string">&#x27;loss&#x27;</span>, update=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line">            global_step+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> epoch%<span class="number">1</span> ==<span class="number">0</span>:</span><br><span class="line">            val_acc = evaluate(model,val_loader)</span><br><span class="line">            <span class="keyword">if</span> val_acc&gt;best_acc:</span><br><span class="line">                best_epoch = epoch</span><br><span class="line">                best_acc = val_acc</span><br><span class="line"></span><br><span class="line">                torch.save(model.state_dict(),<span class="string">&#x27;best.mdl&#x27;</span>)</span><br><span class="line">            viz.line([val_acc], [epochs], win=<span class="string">&#x27;val_acc&#x27;</span>, update=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;best acc:&#x27;</span>,best_acc,<span class="string">&#x27;best epoch&#x27;</span>,best_epoch)</span><br><span class="line"></span><br><span class="line">    model.load_state_dict(torch.load(<span class="string">&#x27;best.mdl&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;loaded from checkpoint!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    test_acc = evaluate(model,test_loader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test acc&#x27;</span>,test_acc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>best acc: 0.8412017167381974 best epoch 8</p>
<p>test acc 0.8025751072961373</p>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€pytorch learningã€‘(ä¸€)è‡ªå®šä¹‰æ•°æ®é›†é¢„å¤„ç†å’ŒåŠ è½½</title>
    <url>/posts/a0ca199b/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="é€šç”¨å®ç°"><a href="#é€šç”¨å®ç°" class="headerlink" title="é€šç”¨å®ç°"></a>é€šç”¨å®ç°</h1><p>å…³é”®åº“ï¼šDatasetå’Œ DataLoader</p>
<p><code>from torch.utils.data import  Dataset,DataLoader</code></p>
<p>ä»£ç ä½¿ç”¨æ•°æ®é›†ï¼š<a href="https://github.com/Xandra298/Pytorchlearning/tree/master/pokeman">å®å¯æ¢¦</a></p>
<span id="more"></span>
<p>è¯¥æ•°æ®é›†ç›®å½•æ ¼å¼ä¸ºï¼š</p>
<p> root dir:</p>
<ul>
<li>dir1(name is the class)<ul>
<li>pic1</li>
<li>pic2</li>
<li>â€¦</li>
</ul>
</li>
<li>dir2(name is the class)<ul>
<li>â€¦</li>
</ul>
</li>
</ul>
<h2 id="Dataset"><a href="#Dataset" class="headerlink" title="Dataset"></a>Dataset</h2><p>ç»§æ‰¿Datasetç±»çš„å®ç°</p>
<p>éœ€è¦é‡è½½æ–¹æ³•ï¼š</p>
<ul>
<li>__len__:è¿”å›æ•°æ®é›†é•¿åº¦ï¼ˆæ•°æ®æ•°é‡ï¼‰</li>
<li>__get_item__ï¼šè·å–æ•°æ®é›†çš„item</li>
</ul>
<p>å…³é”®æ€è·¯ï¼šå…·ä½“è§ä»£ç åŠä»£ç æ³¨é‡Š</p>
<p>è‡ªå®šä¹‰æ–¹æ³•load_csv:</p>
<ol>
<li>éå†ç›®å½•ï¼Œå°†image_path-labelå­˜å‚¨åˆ°csvæ–‡ä»¶ä¸­ï¼š</li>
</ol>
<ul>
<li>ç”¨<code>glob.glob</code>è·å–å…·ä½“è·¯å¾„çš„æ•°æ®è·¯å¾„</li>
<li><code>csv.writer(f)</code>å°†image_path,labelå†™å…¥csvæ–‡ä»¶</li>
</ul>
<ol>
<li>è¯»å–csvæ–‡ä»¶ï¼Œè·å¾—image_path-label</li>
</ol>
<ul>
<li>reader = <code>csv.reader(f)</code>ï¼Œfor row in reader:â€¦</li>
</ul>
<p>lenæ–¹æ³•ï¼š</p>
<ul>
<li>è¿”å›æ•°æ®é›†é•¿åº¦</li>
</ul>
<p>get_itemæ–¹æ³•ï¼š</p>
<ul>
<li><p>ä¼ å…¥index,ä»æˆ‘ä»¬å…¨å±€çš„åˆ—è¡¨ä¸­è·å¾—å¯¹åº”çš„æ•°æ®</p>
</li>
<li><p>é€šè¿‡è¯»å–csvæ–‡ä»¶ï¼Œä¼ å…¥index, å¯ä»¥è·å¾—å¯¹åº”çš„image_path - labelå¯¹ã€‚</p>
<p>ç›®æ ‡ï¼šè½½å…¥image_pathï¼Œå¤„ç†å›¾ç‰‡ï¼Œè¿”å›ç¬¦åˆè¦æ±‚çš„å›¾ç‰‡æ•°æ®å’Œlabelå¯¹</p>
</li>
<li><p>å¤„ç†ä»è·¯å¾„ä¸Šè¯»å–çš„æ•°æ®ï¼Œè¿”å›æŒ‡å®šæ ¼å¼ã€‚å¦‚ä½¿ç”¨<code>torchvision.transform</code>ï¼Œæœ€åå¤„ç†å®Œçš„æ ¼å¼æ˜¯tensor</p>
</li>
<li><p>è¿”å›æ•°æ®å’Œlabelå¯¹</p>
</li>
</ul>
<p>å…³äºmodeï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­éœ€è¦è®­ç»ƒé›†æˆ–è€…æµ‹è¯•é›†è¿™æ ·å­ï¼Œè¿”å›åˆ‡åˆ†åçš„æ•°æ®é›†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> os,glob</span><br><span class="line"><span class="keyword">import</span> random,csv</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset,DataLoader</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pokemen</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,root,resize,mode</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param root: root dir of dataset</span></span><br><span class="line"><span class="string">                    root dir:</span></span><br><span class="line"><span class="string">                        - dir1(name is the class)</span></span><br><span class="line"><span class="string">                            - pic1</span></span><br><span class="line"><span class="string">                            - pic2</span></span><br><span class="line"><span class="string">                            - ...</span></span><br><span class="line"><span class="string">                        - dir2(name is the class)</span></span><br><span class="line"><span class="string">                        - ...</span></span><br><span class="line"><span class="string">        :param resize:</span></span><br><span class="line"><span class="string">        :param mode: train\test\val</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">super</span>(Pokemen, self).__init__()</span><br><span class="line">        self.root = root</span><br><span class="line">        self.resize = resize</span><br><span class="line"></span><br><span class="line">        self.name2label = &#123;&#125;<span class="comment">#  save the dict &#123;name:int&#125; </span></span><br><span class="line">        <span class="comment">#list the dir name under the root dir</span></span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> <span class="built_in">sorted</span>(os.listdir(os.path.join(root))): <span class="comment"># sorted to ensure every time to be the same</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(os.path.join(root,name)):</span><br><span class="line">                <span class="comment"># not a dir</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># get the name:int following the order</span></span><br><span class="line">            self.name2label[name] = <span class="built_in">len</span>(self.name2label.keys())</span><br><span class="line">        <span class="built_in">print</span>(self.name2label)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># read from csv: image_path-labelï¼›</span></span><br><span class="line">        <span class="comment"># function load_csvï¼šsave the image_path-label to csv and then read from csv</span></span><br><span class="line">        self.images,self.labels = self.load_csv(<span class="string">&quot;image.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#split dataset</span></span><br><span class="line">        <span class="keyword">if</span> mode == <span class="string">&#x27;train&#x27;</span>: <span class="comment">#60%</span></span><br><span class="line">            self.images = self.images[:<span class="built_in">int</span>(<span class="number">0.6</span>*<span class="built_in">len</span>(self.images))]</span><br><span class="line">            self.labels = self.labels[:<span class="built_in">int</span>(<span class="number">0.6</span>*<span class="built_in">len</span>(self.labels))]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;val&#x27;</span>: <span class="comment">#20%</span></span><br><span class="line">            self.images = self.images[<span class="built_in">int</span>(<span class="number">0.6</span> * <span class="built_in">len</span>(self.images)):<span class="built_in">int</span>(<span class="number">0.8</span>*<span class="built_in">len</span>(self.images))]</span><br><span class="line">            self.labels = self.labels[<span class="built_in">int</span>(<span class="number">0.6</span> * <span class="built_in">len</span>(self.labels)):<span class="built_in">int</span>(<span class="number">0.8</span>*<span class="built_in">len</span>(self.labels))]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">            self.images = self.images[<span class="built_in">int</span>(<span class="number">0.8</span> * <span class="built_in">len</span>(self.images)):]</span><br><span class="line">            self.labels = self.labels[<span class="built_in">int</span>(<span class="number">0.8</span> * <span class="built_in">len</span>(self.labels)):]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_csv</span>(<span class="params">self,filename</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        save image_path-label to csv(if csv exits,just read from it) ï¼Œand then read from it</span></span><br><span class="line"><span class="string">        :param filename: filepath of the csv to save and read</span></span><br><span class="line"><span class="string">        :return: images,labels==&gt; images_path,labels</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        savepath = os.path.join(self.root,filename)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(savepath):</span><br><span class="line">            images = []</span><br><span class="line">            <span class="keyword">for</span> name <span class="keyword">in</span> self.name2label.keys():</span><br><span class="line">                <span class="comment">#grop the pic, save to list</span></span><br><span class="line">                images += glob.glob(os.path.join(self.root,name,<span class="string">&#x27;*.png&#x27;</span>))</span><br><span class="line">                images += glob.glob(os.path.join(self.root, name, <span class="string">&#x27;*.jpg&#x27;</span>))</span><br><span class="line">                images += glob.glob(os.path.join(self.root, name, <span class="string">&#x27;*.gif&#x27;</span>))</span><br><span class="line">            <span class="comment">#print(images)</span></span><br><span class="line">            <span class="comment">#&#x27;./pokeman/squirtle\\00000073.png&#x27;</span></span><br><span class="line">            random.shuffle(images) <span class="comment">#shuffle</span></span><br><span class="line">            <span class="comment">#write into csv</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(savepath,mode=<span class="string">&#x27;w&#x27;</span>,newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                writer = csv.writer(f)</span><br><span class="line">                <span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">                    name = img.split(os.sep)[-<span class="number">2</span>]</span><br><span class="line">                    label = self.name2label[name]</span><br><span class="line">                    writer.writerow([img,label])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;written into csv file:&#x27;</span>,savepath)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#read from csv</span></span><br><span class="line">        images,labels = [],[]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(savepath) <span class="keyword">as</span> f:</span><br><span class="line">            reader = csv.reader(f)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">                img,label = row</span><br><span class="line">                label = <span class="built_in">int</span>(label)</span><br><span class="line">                images.append(img)</span><br><span class="line">                labels.append(label)</span><br><span class="line">        <span class="keyword">assert</span>  <span class="built_in">len</span>(images) == <span class="built_in">len</span>(labels)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  images,labels</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        :return: len of dataset</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.images)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param item: range in [0,len(images)]</span></span><br><span class="line"><span class="string">        :return: self.images,self.labels</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        img,label = self.images[item],self.labels[item]</span><br><span class="line"></span><br><span class="line">        tf = transforms.Compose(</span><br><span class="line">            [<span class="keyword">lambda</span> x:Image.<span class="built_in">open</span>(x).convert(<span class="string">&#x27;RGB&#x27;</span>), <span class="comment"># open image and convert to RGB</span></span><br><span class="line">             transforms.Resize((<span class="built_in">int</span>(self.resize*<span class="number">1.25</span>),<span class="built_in">int</span>(self.resize*<span class="number">1.25</span>))), <span class="comment"># resize</span></span><br><span class="line">             transforms.RandomRotation(<span class="number">15</span>), <span class="comment"># rotate</span></span><br><span class="line">             transforms.CenterCrop(self.resize), <span class="comment">#center crop</span></span><br><span class="line">             transforms.ToTensor(),</span><br><span class="line">             transforms.Normalize(mean=[<span class="number">0.485</span>,<span class="number">0.456</span>,<span class="number">0.406</span>],std=[<span class="number">0.229</span>,<span class="number">0.224</span>,<span class="number">0.225</span>]),<span class="comment">#values computed from ImageNetï¼Œwe could use it in other dataset</span></span><br><span class="line"></span><br><span class="line">             ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        img = tf(img)</span><br><span class="line">        label = torch.tensor(label)</span><br><span class="line">        <span class="keyword">return</span> img,label</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">denormalize</span>(<span class="params">self,x_hat</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        x_hat = (x - mean)/std</span></span><br><span class="line"><span class="string">        x = x_hat * std + mean</span></span><br><span class="line"><span class="string">        :param x_hat: shape[3,self.resize,self.resize]</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        mean = [<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>]</span><br><span class="line">        std = [<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>]</span><br><span class="line">        mean = torch.tensor(mean).unsqueeze(<span class="number">1</span>).unsqueeze(<span class="number">1</span>)</span><br><span class="line">        std = torch.tensor(std).unsqueeze(<span class="number">1</span>).unsqueeze(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        x = x_hat*std+mean</span><br><span class="line">        <span class="keyword">return</span>  x</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># dataset</span></span><br><span class="line">    db_train = Pokemen(root=<span class="string">&#x27;pokeman&#x27;</span>,resize=<span class="number">224</span>,mode=<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">    <span class="comment"># dataloader</span></span><br><span class="line">    dl_train = DataLoader(dataset=db_train,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line">    x,y = <span class="built_in">next</span>(<span class="built_in">iter</span>(dl_train))</span><br><span class="line">    <span class="built_in">print</span>(x.shape,y.shape)</span><br></pre></td></tr></table></figure>
<pre><code>&#123;&#39;.ipynb_checkpoints&#39;: 0, &#39;bulbasaur&#39;: 1, &#39;charmander&#39;: 2, &#39;mewtwo&#39;: 3, &#39;pikachu&#39;: 4, &#39;squirtle&#39;: 5&#125;
written into csv file: pokeman\image.csv
torch.Size([32, 3, 224, 224]) torch.Size([32])
</code></pre><h2 id="DataLoader"><a href="#DataLoader" class="headerlink" title="DataLoader"></a>DataLoader</h2><p>ä¼ å…¥æ•°æ®é›†ï¼Œå¤„ç†ä¸ºbatchã€‚ä¸»è¦å‚æ•°ï¼šbatch_size</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dl_train = DataLoader(dataset=db_train,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>å…¶ä»–å¸¸ç”¨å‚æ•°ï¼š</p>
<ul>
<li>num_workers ( int, optional): how many subprocesses to use for data loading. <code>0</code> means that the data will be loaded in the main process. (default: <code>0</code>)</li>
<li>drop_last (bool, optional): set to <code>True</code> to drop the last incomplete batch, if the dataset size is not divisible by the batch size. If <code>False</code> and  the size of dataset is not divisible by the batch size, then the last batch will be smaller. (default: <code>False</code>)</li>
</ul>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://pytorch.org/docs/stable/data.html?highlight=dataloader#torch.utils.data.DataLoader">torch.utils.data â€” PyTorch 1.13 documentation</a></p>
<p>dl_trainè¿”å›çš„å‚æ•°å¯¹åº”dataset get_itemçš„return å‚æ•°</p>
<ul>
<li><p><code>x,y = next(iter(dataset))</code></p>
</li>
<li><p><code>X,Y = next(iter(dataloader))</code></p>
</li>
</ul>
<p>X.shape == (batchsize,x.shape)</p>
<p><strong>è¿›è¡Œè®­ç»ƒæ—¶çš„ä¸€èˆ¬æ¨¡å¼ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> idx,(x,label) <span class="keyword">in</span> <span class="built_in">enumerate</span>(dl_train):</span><br><span class="line">	x,label = x.to(device),y.to(device)</span><br><span class="line">	pred = model(x)</span><br><span class="line">	loss = lossFunction(pred,label)</span><br><span class="line">	optimizer.zero_grad()</span><br><span class="line">	loss.backward()</span><br><span class="line">	loss.step()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ç‰¹æ®Šä¾¿æ·æ–¹å¼æ•°æ®é›†åŠ è½½"><a href="#ç‰¹æ®Šä¾¿æ·æ–¹å¼æ•°æ®é›†åŠ è½½" class="headerlink" title="ç‰¹æ®Šä¾¿æ·æ–¹å¼æ•°æ®é›†åŠ è½½"></a>ç‰¹æ®Šä¾¿æ·æ–¹å¼æ•°æ®é›†åŠ è½½</h1><p>ä½¿ç”¨å‡½æ•°<code>datasets.ImageFolder</code> </p>
<p>ä½¿ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå°†æ•°æ®é›†åˆ†æ–‡ä»¶å¤¹å­˜å‚¨ï¼Œæ–‡ä»¶å¤¹åç§°ä¸ºå¯¹åº”çš„label</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tf  = transforms.Compose([</span><br><span class="line">    transforms.Resize((<span class="number">128</span>,<span class="number">128</span>)),</span><br><span class="line">    transforms.ToTensor()</span><br><span class="line">])</span><br><span class="line"><span class="comment">##é€‚ç”¨äºå°†æ•°æ®é›†åˆ†æ–‡ä»¶å¤¹å­˜å‚¨ï¼Œæ–‡ä»¶å¤¹åç§°ä¸ºå¯¹åº”çš„label</span></span><br><span class="line">db = torchvision.datasets.ImageFolder(root=<span class="string">&#x27;./pokeman/&#x27;</span>,transform=tf)</span><br><span class="line">loader = DataLoader(db,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(db.class_to_idx)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>pytorchlearning</title>
    <url>/posts/643f7c73/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="pytorch-å­¦ä¹ è®°å½•"><a href="#pytorch-å­¦ä¹ è®°å½•" class="headerlink" title="pytorch å­¦ä¹ è®°å½•"></a>pytorch å­¦ä¹ è®°å½•</h1><span id="more"></span>
<p>è§†é¢‘å­¦ä¹ ç¬”è®°githubå­˜å‚¨ä»“åº“ï¼šï¼ˆ@ljhï¼‰</p>
<p><a href="https://github.com/Xandra298/Pytorchlearning">Xandra298/Pytorchlearning (github.com)</a></p>
<ul>
<li><p>torchåŸºç¡€æ“ä½œ</p>
<p><a href="https://github.com/Xandra298/Pytorchlearning/blob/all/3.pytorchåŸºç¡€æ“ä½œ.ipynb">Pytorchlearning/3.pytorchåŸºç¡€æ“ä½œ.ipynb at all Â· Xandra298/Pytorchlearning (github.com)</a></p>
</li>
<li><p>è‡ªå®šä¹‰æ•°æ®é›†é¢„å¤„ç†ä¸åŠ è½½</p>
<p><a href="https://xandra298.github.io/posts/a0ca199b/">ã€pytorch learningã€‘(ä¸€)è‡ªå®šä¹‰æ•°æ®é›†é¢„å¤„ç†å’ŒåŠ è½½</a></p>
</li>
<li><p>å®Œæ•´æ¨¡å‹æ­å»ºã€è®­ç»ƒã€æµ‹è¯•</p>
<p><a href="https://xandra298.github.io/posts/13fc6476/">ã€pytorch-learningã€‘(äºŒ) æ¨¡å‹æ­å»º-è®­ç»ƒ-æµ‹è¯• </a></p>
</li>
<li><p>å¯è§†åŒ–</p>
<p><a href="https://xandra298.github.io/posts/f19419c5/">ã€pytorch-learningã€‘(ä¸‰) å¯è§†åŒ– </a></p>
</li>
<li><p>ã€ç†è®ºã€‘éšæœºæ¢¯åº¦ä¸‹é™</p>
<p>åŒ…æ‹¬æŸå¤±å‡½æ•°ç­‰:  <a href="https://github.com/Xandra298/Pytorchlearning/blob/all/4.éšæœºæ¢¯åº¦ä¸‹é™.ipynb">ç¬”è®°</a></p>
</li>
<li><p>è¿‡æ‹ŸåˆåŠä¼˜åŒ–trick</p>
<p><a href="https://github.com/Xandra298/Pytorchlearning/blob/all/7. è¿‡æ‹ŸåˆåŠä¼˜åŒ–trick.ipynb">Pytorchlearning/è¿‡æ‹ŸåˆåŠä¼˜åŒ–trick</a></p>
</li>
<li><p>å·ç§¯ç¥ç»ç½‘ç»œ: <a href="https://github.com/Xandra298/Pytorchlearning/blob/all/8.å·ç§¯ç¥ç»ç½‘ç»œ.ipynb">ç¬”è®°</a></p>
</li>
<li><p>å¾ªç¯ç¥ç»ç½‘ç»œ: <a href="https://github.com/Xandra298/Pytorchlearning/blob/all/9.å¾ªç¯ç¥ç»ç½‘ç»œ.ipynb">ç¬”è®°</a></p>
</li>
<li><p>è‡ªç¼–ç å™¨: <a href="https://github.com/Xandra298/Pytorchlearning/blob/master/10.è‡ªç¼–ç å™¨.ipynb">ç¬”è®°</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>é‚»æ¥çŸ©é˜µè¡¨ç¤ºæˆPyGéœ€è¦çš„edge_indexå¹¶è¿›è¡Œå¸¦è¾¹æƒçš„ç½‘ç»œæ„å»º</title>
    <url>/posts/35a1541/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="é‚»æ¥çŸ©é˜µ-to-pygéœ€è¦çš„edge-indexæ ¼å¼"><a href="#é‚»æ¥çŸ©é˜µ-to-pygéœ€è¦çš„edge-indexæ ¼å¼" class="headerlink" title="é‚»æ¥çŸ©é˜µ to pygéœ€è¦çš„edge_indexæ ¼å¼"></a>é‚»æ¥çŸ©é˜µ to pygéœ€è¦çš„edge_indexæ ¼å¼</h1><span id="more"></span>
<h2 id="scipy"><a href="#scipy" class="headerlink" title="scipy"></a>scipy</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">A = torch.rand([<span class="number">10</span>,<span class="number">10</span>]) <span class="comment"># 10*10çš„é‚»æ¥çŸ©é˜µAï¼Œå¸¦æœ‰æƒå€¼ï¼Œè€Œé0/1</span></span><br><span class="line">A</span><br></pre></td></tr></table></figure>
<pre><code>tensor([[0.8253, 0.2458, 0.9340, 0.4631, 0.5114, 0.3248, 0.8528, 0.6354, 0.2988,
         0.1087],
        [0.0190, 0.5693, 0.4843, 0.9588, 0.6011, 0.5755, 0.4621, 0.7694, 0.0637,
         0.9790],
        [0.6978, 0.9686, 0.9701, 0.2234, 0.5633, 0.9978, 0.9766, 0.3365, 0.3512,
         0.2396],
        [0.3582, 0.9965, 0.7739, 0.5641, 0.7275, 0.3078, 0.1826, 0.5449, 0.6566,
         0.1949],
        [0.8194, 0.7996, 0.9177, 0.3419, 0.5239, 0.7048, 0.4503, 0.0758, 0.2244,
         0.0659],
        [0.6131, 0.3546, 0.0789, 0.2735, 0.0781, 0.8000, 0.0587, 0.6644, 0.2678,
         0.6351],
        [0.7244, 0.0463, 0.9280, 0.6456, 0.6837, 0.0763, 0.0759, 0.0440, 0.1849,
         0.8942],
        [0.3589, 0.6925, 0.2334, 0.3476, 0.6695, 0.1048, 0.1470, 0.5548, 0.4736,
         0.6934],
        [0.0356, 0.8016, 0.6176, 0.2867, 0.1340, 0.7196, 0.0562, 0.5548, 0.7376,
         0.2841],
        [0.9301, 0.1725, 0.4012, 0.3893, 0.8366, 0.1587, 0.3342, 0.7945, 0.8123,
         0.8724]])
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.sparse <span class="keyword">as</span> sp</span><br><span class="line">adj  = sp.coo_matrix(A) <span class="comment">#è½¬æ¢æˆcoo_matrixçŸ©é˜µ</span></span><br><span class="line">values = adj.data</span><br><span class="line">values,adj.row,adj.col</span><br></pre></td></tr></table></figure>
<pre><code>(array([0.825252  , 0.24581629, 0.9340454 , 0.4631123 , 0.51142365,
        0.32479858, 0.85282457, 0.63537604, 0.29877287, 0.10873711,
        0.01895636, 0.5693259 , 0.48427123, 0.9587981 , 0.6010562 ,
        0.57548887, 0.46208388, 0.7693816 , 0.06371653, 0.97895676,
        0.6978117 , 0.9685761 , 0.97011906, 0.22341514, 0.56326205,
        0.9978037 , 0.97661865, 0.33654213, 0.35123014, 0.23959029,
        0.358207  , 0.99651885, 0.7739324 , 0.5641022 , 0.72754997,
        0.3077591 , 0.18257308, 0.5449101 , 0.65663534, 0.1949212 ,
        0.8193548 , 0.79964596, 0.9176568 , 0.34189552, 0.5239384 ,
        0.70477635, 0.4503097 , 0.07584941, 0.22442049, 0.06589556,
        0.6130815 , 0.35458   , 0.07890564, 0.27350843, 0.07805085,
        0.79995   , 0.05868119, 0.66441715, 0.267847  , 0.6351336 ,
        0.72437716, 0.04632962, 0.92803836, 0.645646  , 0.6836786 ,
        0.07632524, 0.07594979, 0.04397732, 0.18492383, 0.89419115,
        0.3588807 , 0.6925135 , 0.23337674, 0.34763372, 0.66951907,
        0.10478634, 0.14702266, 0.55476344, 0.47362745, 0.69343317,
        0.03562325, 0.80160064, 0.6175768 , 0.2867241 , 0.13401723,
        0.719559  , 0.05618161, 0.55481714, 0.7375902 , 0.28414857,
        0.9300911 , 0.17248052, 0.4012187 , 0.38931435, 0.83664143,
        0.15867668, 0.3341686 , 0.7945494 , 0.81226593, 0.8724434 ],
       dtype=float32),
 array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4,
        4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9], dtype=int32),
 array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1,
        2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3,
        4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5,
        6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7,
        8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=int32))
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">indices = np.vstack((adj.row,adj.col)) <span class="comment"># æˆ‘ä»¬éœ€è¦çš„cooå½¢å¼çš„edge_index</span></span><br><span class="line">edge_index = torch.LongTensor(indices)<span class="comment">#PyGéœ€è¦çš„edge_index</span></span><br><span class="line">edge_index,edge_index.shape</span><br></pre></td></tr></table></figure>
<pre><code>(tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2,
          2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,
          4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
          7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9,
          9, 9, 9, 9],
         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3,
          4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7,
          8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1,
          2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5,
          6, 7, 8, 9]]),
 torch.Size([2, 100]))
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edge_attr = adj.data <span class="comment">#è¾¹æƒå€¼</span></span><br><span class="line">edge_attr = torch.FloatTensor(edge_attr)<span class="comment">#to float tensor</span></span><br><span class="line">edge_attr,edge_attr.shape</span><br></pre></td></tr></table></figure>
<pre><code>(tensor([0.8253, 0.2458, 0.9340, 0.4631, 0.5114, 0.3248, 0.8528, 0.6354, 0.2988,
         0.1087, 0.0190, 0.5693, 0.4843, 0.9588, 0.6011, 0.5755, 0.4621, 0.7694,
         0.0637, 0.9790, 0.6978, 0.9686, 0.9701, 0.2234, 0.5633, 0.9978, 0.9766,
         0.3365, 0.3512, 0.2396, 0.3582, 0.9965, 0.7739, 0.5641, 0.7275, 0.3078,
         0.1826, 0.5449, 0.6566, 0.1949, 0.8194, 0.7996, 0.9177, 0.3419, 0.5239,
         0.7048, 0.4503, 0.0758, 0.2244, 0.0659, 0.6131, 0.3546, 0.0789, 0.2735,
         0.0781, 0.8000, 0.0587, 0.6644, 0.2678, 0.6351, 0.7244, 0.0463, 0.9280,
         0.6456, 0.6837, 0.0763, 0.0759, 0.0440, 0.1849, 0.8942, 0.3589, 0.6925,
         0.2334, 0.3476, 0.6695, 0.1048, 0.1470, 0.5548, 0.4736, 0.6934, 0.0356,
         0.8016, 0.6176, 0.2867, 0.1340, 0.7196, 0.0562, 0.5548, 0.7376, 0.2841,
         0.9301, 0.1725, 0.4012, 0.3893, 0.8366, 0.1587, 0.3342, 0.7945, 0.8123,
         0.8724]),
 torch.Size([100]))
</code></pre><h2 id="torch"><a href="#torch" class="headerlink" title="torch**"></a>torch<em>**</em></h2><p>ä½¿ç”¨å‰é¢çš„æ–¹æ³•ï¼Œå½“ä¼ å…¥cudaçš„è¾“å…¥ç„¶åè¿›è¡Œè½¬æ¢æ—¶ï¼Œå‰é¢çš„æ–¹æ³•åªèƒ½åœ¨cpuä¸Šæ‰§è¡Œï¼Œå› ä¸ºcudaä¸æ”¯æŒnumpy(),éœ€è¦è¿›è¡Œcpuå’Œcudaçš„è½¬æ¢ã€‚ï¼ˆä¸€ç›´ä»¥ä¸ºæ˜¯å› ä¸ºæ•°æ®ä¼ è¾“ç­‰æ–¹é¢å¯èƒ½çš„å½±å“å¯¼è‡´æˆ‘çš„é€Ÿåº¦å˜æ…¢ï¼Œä½†æ˜¯ä¼¼ä¹å½±å“æ›´å¤§çš„æ˜¯å› ä¸ºåç»­æ¨¡å‹åŠ è½½éæˆbatch)ï¼‰</p>
<p>torchçš„æ–¹æ³•ä¸éœ€è¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">A = torch.rand([<span class="number">10</span>,<span class="number">10</span>]) <span class="comment"># 10*10çš„é‚»æ¥çŸ©é˜µAï¼Œå¸¦æœ‰æƒå€¼ï¼Œè€Œé0/1</span></span><br><span class="line">A</span><br></pre></td></tr></table></figure>
<pre><code>tensor([[0.8176, 0.2545, 0.6473, 0.2937, 0.9869, 0.0929, 0.6526, 0.6831, 0.0242,
         0.3227],
        [0.8430, 0.0125, 0.0166, 0.2306, 0.6767, 0.7800, 0.3947, 0.5706, 0.1307,
         0.3265],
        [0.8983, 0.5701, 0.0590, 0.0370, 0.1142, 0.9176, 0.0413, 0.7737, 0.8839,
         0.9673],
        [0.2120, 0.0877, 0.8496, 0.2748, 0.2316, 0.1640, 0.2160, 0.1306, 0.4602,
         0.9815],
        [0.8076, 0.4725, 0.8042, 0.3854, 0.4384, 0.9577, 0.5992, 0.5335, 0.9595,
         0.1808],
        [0.3166, 0.5219, 0.1348, 0.2726, 0.6527, 0.7875, 0.2952, 0.6067, 0.5722,
         0.0738],
        [0.2799, 0.3344, 0.2588, 0.3888, 0.6586, 0.3389, 0.3849, 0.0184, 0.8913,
         0.5702],
        [0.5489, 0.5952, 0.3463, 0.6634, 0.1480, 0.4949, 0.3449, 0.6737, 0.5059,
         0.1255],
        [0.3011, 0.6796, 0.9407, 0.1118, 0.2194, 0.9374, 0.2392, 0.1681, 0.4226,
         0.9818],
        [0.7948, 0.4114, 0.2621, 0.5588, 0.2609, 0.7126, 0.6315, 0.7893, 0.2553,
         0.4072]])
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">adj = A.to_sparse()</span><br><span class="line">adj, adj.indices(),adj.values()</span><br></pre></td></tr></table></figure>
<pre><code>(tensor(indices=tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                         3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5,
                         5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7,
                         7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9,
                         9, 9, 9, 9, 9],
                        [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                         9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7,
                         8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6,
                         7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5,
                         6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4,
                         5, 6, 7, 8, 9]]),
        values=tensor([0.8176, 0.2545, 0.6473, 0.2937, 0.9869, 0.0929, 0.6526,
                       0.6831, 0.0242, 0.3227, 0.8430, 0.0125, 0.0166, 0.2306,
                       0.6767, 0.7800, 0.3947, 0.5706, 0.1307, 0.3265, 0.8983,
                       0.5701, 0.0590, 0.0370, 0.1142, 0.9176, 0.0413, 0.7737,
                       0.8839, 0.9673, 0.2120, 0.0877, 0.8496, 0.2748, 0.2316,
                       0.1640, 0.2160, 0.1306, 0.4602, 0.9815, 0.8076, 0.4725,
                       0.8042, 0.3854, 0.4384, 0.9577, 0.5992, 0.5335, 0.9595,
                       0.1808, 0.3166, 0.5219, 0.1348, 0.2726, 0.6527, 0.7875,
                       0.2952, 0.6067, 0.5722, 0.0738, 0.2799, 0.3344, 0.2588,
                       0.3888, 0.6586, 0.3389, 0.3849, 0.0184, 0.8913, 0.5702,
                       0.5489, 0.5952, 0.3463, 0.6634, 0.1480, 0.4949, 0.3449,
                       0.6737, 0.5059, 0.1255, 0.3011, 0.6796, 0.9407, 0.1118,
                       0.2194, 0.9374, 0.2392, 0.1681, 0.4226, 0.9818, 0.7948,
                       0.4114, 0.2621, 0.5588, 0.2609, 0.7126, 0.6315, 0.7893,
                       0.2553, 0.4072]),
        size=(10, 10), nnz=100, layout=torch.sparse_coo),
 tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2,
          2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,
          4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
          7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9,
          9, 9, 9, 9],
         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3,
          4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7,
          8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1,
          2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5,
          6, 7, 8, 9]]),
 tensor([0.8176, 0.2545, 0.6473, 0.2937, 0.9869, 0.0929, 0.6526, 0.6831, 0.0242,
         0.3227, 0.8430, 0.0125, 0.0166, 0.2306, 0.6767, 0.7800, 0.3947, 0.5706,
         0.1307, 0.3265, 0.8983, 0.5701, 0.0590, 0.0370, 0.1142, 0.9176, 0.0413,
         0.7737, 0.8839, 0.9673, 0.2120, 0.0877, 0.8496, 0.2748, 0.2316, 0.1640,
         0.2160, 0.1306, 0.4602, 0.9815, 0.8076, 0.4725, 0.8042, 0.3854, 0.4384,
         0.9577, 0.5992, 0.5335, 0.9595, 0.1808, 0.3166, 0.5219, 0.1348, 0.2726,
         0.6527, 0.7875, 0.2952, 0.6067, 0.5722, 0.0738, 0.2799, 0.3344, 0.2588,
         0.3888, 0.6586, 0.3389, 0.3849, 0.0184, 0.8913, 0.5702, 0.5489, 0.5952,
         0.3463, 0.6634, 0.1480, 0.4949, 0.3449, 0.6737, 0.5059, 0.1255, 0.3011,
         0.6796, 0.9407, 0.1118, 0.2194, 0.9374, 0.2392, 0.1681, 0.4226, 0.9818,
         0.7948, 0.4114, 0.2621, 0.5588, 0.2609, 0.7126, 0.6315, 0.7893, 0.2553,
         0.4072]))
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">indices = adj.indices() <span class="comment"># æˆ‘ä»¬éœ€è¦çš„cooå½¢å¼çš„edge_index</span></span><br><span class="line">edge_index = indices<span class="comment">#PyGéœ€è¦çš„edge_index</span></span><br><span class="line">edge_index,edge_index.shape</span><br></pre></td></tr></table></figure>
<pre><code>(tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2,
          2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,
          4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
          7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9,
          9, 9, 9, 9],
         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3,
          4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7,
          8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1,
          2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5,
          6, 7, 8, 9]]),
 torch.Size([2, 100]))
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edge_attr = adj.values()</span><br><span class="line">edge_attr,edge_attr.shape</span><br></pre></td></tr></table></figure>
<pre><code>(tensor([0.8176, 0.2545, 0.6473, 0.2937, 0.9869, 0.0929, 0.6526, 0.6831, 0.0242,
         0.3227, 0.8430, 0.0125, 0.0166, 0.2306, 0.6767, 0.7800, 0.3947, 0.5706,
         0.1307, 0.3265, 0.8983, 0.5701, 0.0590, 0.0370, 0.1142, 0.9176, 0.0413,
         0.7737, 0.8839, 0.9673, 0.2120, 0.0877, 0.8496, 0.2748, 0.2316, 0.1640,
         0.2160, 0.1306, 0.4602, 0.9815, 0.8076, 0.4725, 0.8042, 0.3854, 0.4384,
         0.9577, 0.5992, 0.5335, 0.9595, 0.1808, 0.3166, 0.5219, 0.1348, 0.2726,
         0.6527, 0.7875, 0.2952, 0.6067, 0.5722, 0.0738, 0.2799, 0.3344, 0.2588,
         0.3888, 0.6586, 0.3389, 0.3849, 0.0184, 0.8913, 0.5702, 0.5489, 0.5952,
         0.3463, 0.6634, 0.1480, 0.4949, 0.3449, 0.6737, 0.5059, 0.1255, 0.3011,
         0.6796, 0.9407, 0.1118, 0.2194, 0.9374, 0.2392, 0.1681, 0.4226, 0.9818,
         0.7948, 0.4114, 0.2621, 0.5588, 0.2609, 0.7126, 0.6315, 0.7893, 0.2553,
         0.4072]),
 torch.Size([100]))
</code></pre><h1 id="edge-index-to-é‚»æ¥çŸ©é˜µ"><a href="#edge-index-to-é‚»æ¥çŸ©é˜µ" class="headerlink" title="edge_index to é‚»æ¥çŸ©é˜µ"></a>edge_index to é‚»æ¥çŸ©é˜µ</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.sparse <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> sparse_coo_tensor</span><br><span class="line">adj = sparse_coo_tensor(edge_index,edge_attr,[<span class="number">10</span>,<span class="number">10</span>])</span><br><span class="line">adj.to_dense()</span><br></pre></td></tr></table></figure>
<pre><code>tensor([[4.5977e-01, 6.6455e-01, 4.3946e-01, 3.8642e-01, 1.2331e-01, 2.9945e-01,
         2.5433e-01, 9.7476e-01, 4.5961e-04, 5.9594e-02],
        [2.2455e-01, 9.7698e-01, 8.7531e-01, 2.8142e-01, 7.0980e-01, 6.2595e-01,
         2.3625e-01, 5.7737e-01, 4.4227e-01, 6.5420e-01],
        [5.4512e-01, 2.4614e-01, 6.9270e-01, 6.8005e-01, 1.3384e-01, 5.9974e-01,
         9.2275e-01, 3.6578e-01, 3.5667e-01, 5.8081e-01],
        [9.6142e-02, 8.5471e-01, 5.9899e-02, 3.0163e-01, 2.9641e-01, 2.8706e-01,
         4.8757e-01, 8.8466e-01, 3.4357e-01, 9.9034e-01],
        [4.5909e-01, 7.2475e-01, 2.4294e-01, 7.3560e-01, 3.2247e-01, 7.6749e-01,
         3.6008e-01, 3.0816e-01, 7.4665e-01, 6.7713e-01],
        [6.6836e-01, 8.9111e-01, 8.0428e-01, 7.9984e-01, 6.5296e-01, 8.1743e-01,
         8.8702e-01, 3.6678e-01, 4.2774e-01, 2.3170e-02],
        [8.1350e-01, 1.6834e-01, 7.7933e-02, 3.8021e-01, 9.7750e-01, 5.6143e-01,
         7.9341e-01, 3.7514e-01, 9.3114e-01, 5.6821e-01],
        [8.4002e-01, 9.2273e-01, 5.6649e-01, 7.5386e-01, 9.1587e-01, 3.9596e-02,
         8.9435e-01, 5.6476e-01, 2.3289e-01, 1.9653e-01],
        [2.1682e-01, 2.8950e-01, 7.5310e-01, 6.7648e-01, 5.1057e-02, 1.6519e-01,
         5.8807e-01, 9.4542e-02, 6.3111e-01, 2.9049e-01],
        [5.7742e-02, 3.1503e-01, 5.6936e-01, 2.2748e-01, 4.8668e-01, 6.4949e-01,
         6.1752e-01, 3.9269e-01, 2.7897e-01, 5.5806e-01]])
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">adj = sp.coo_matrix((edge_attr,(edge_index[<span class="number">0</span>],edge_index[<span class="number">1</span>])),shape=[<span class="number">10</span>,<span class="number">10</span>])</span><br><span class="line">adj.toarray()</span><br></pre></td></tr></table></figure>
<pre><code>array([[4.5977378e-01, 6.6455245e-01, 4.3945801e-01, 3.8642406e-01,
        1.2331247e-01, 2.9944807e-01, 2.5433010e-01, 9.7475851e-01,
        4.5961142e-04, 5.9593856e-02],
       [2.2454953e-01, 9.7697508e-01, 8.7531334e-01, 2.8141612e-01,
        7.0980257e-01, 6.2595367e-01, 2.3624879e-01, 5.7737088e-01,
        4.4226754e-01, 6.5420014e-01],
       [5.4512197e-01, 2.4613553e-01, 6.9269532e-01, 6.8004644e-01,
        1.3383734e-01, 5.9973723e-01, 9.2274553e-01, 3.6578351e-01,
        3.5666680e-01, 5.8080733e-01],
       [9.6142113e-02, 8.5471165e-01, 5.9899449e-02, 3.0162632e-01,
        2.9641372e-01, 2.8705674e-01, 4.8757398e-01, 8.8466209e-01,
        3.4356719e-01, 9.9034435e-01],
       [4.5909441e-01, 7.2474545e-01, 2.4293584e-01, 7.3560286e-01,
        3.2246715e-01, 7.6749289e-01, 3.6007798e-01, 3.0815858e-01,
        7.4665487e-01, 6.7713338e-01],
       [6.6836429e-01, 8.9111018e-01, 8.0427557e-01, 7.9984426e-01,
        6.5295666e-01, 8.1743485e-01, 8.8702154e-01, 3.6678237e-01,
        4.2774427e-01, 2.3170471e-02],
       [8.1350172e-01, 1.6834372e-01, 7.7932715e-02, 3.8021082e-01,
        9.7749555e-01, 5.6143039e-01, 7.9341477e-01, 3.7514049e-01,
        9.3114382e-01, 5.6820768e-01],
       [8.4002483e-01, 9.2273450e-01, 5.6649190e-01, 7.5385606e-01,
        9.1587120e-01, 3.9596200e-02, 8.9435184e-01, 5.6475997e-01,
        2.3288828e-01, 1.9652534e-01],
       [2.1682233e-01, 2.8950059e-01, 7.5310403e-01, 6.7648250e-01,
        5.1056564e-02, 1.6518539e-01, 5.8806950e-01, 9.4541669e-02,
        6.3110876e-01, 2.9048622e-01],
       [5.7742238e-02, 3.1502587e-01, 5.6935811e-01, 2.2748303e-01,
        4.8667991e-01, 6.4949030e-01, 6.1752105e-01, 3.9268762e-01,
        2.7897447e-01, 5.5806071e-01]], dtype=float32)
</code></pre><h1 id="æ„å»ºè‡ªå®šä¹‰è¾¹æƒé‡çš„GNN"><a href="#æ„å»ºè‡ªå®šä¹‰è¾¹æƒé‡çš„GNN" class="headerlink" title="æ„å»ºè‡ªå®šä¹‰è¾¹æƒé‡çš„GNN"></a>æ„å»ºè‡ªå®šä¹‰è¾¹æƒé‡çš„GNN</h1><p>èƒ¡ä¹±å®šå€¼çš„<br>ä»£ç ä¿®æ”¹è‡ªï¼š<a href="https://zhuanlan.zhihu.com/p/426907570">https://zhuanlan.zhihu.com/p/426907570</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GATConv</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(torch.nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Net, self).__init__()</span><br><span class="line">        self.conv1 = GCNConv(data.num_features, <span class="number">16</span>, cached=<span class="literal">True</span>,</span><br><span class="line">                             normalize=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#         self.conv1 = GATConv(data.num_features, 16)</span></span><br><span class="line">        <span class="comment">#self.conv2 = GCNConv(16, data.num_classes, cached=True,</span></span><br><span class="line">        self.conv2 = GCNConv(<span class="number">16</span>, <span class="number">2</span>, cached=<span class="literal">True</span>,</span><br><span class="line">                            normalize=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#         self.conv2 = GATConv(16, 2)</span></span><br><span class="line">        <span class="comment"># self.conv1 = ChebConv(data.num_features, 16, K=2)</span></span><br><span class="line">        <span class="comment"># self.conv2 = ChebConv(16, data.num_features, K=2)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self</span>):</span><br><span class="line">        x, edge_index, edge_weight = data.x, data.edge_index, data.edge_attr</span><br><span class="line">        x = F.relu(self.conv1(x, edge_index, edge_weight))</span><br><span class="line">        x = F.dropout(x, training=self.training)</span><br><span class="line">        x = self.conv2(x, edge_index, edge_weight)</span><br><span class="line">        <span class="keyword">return</span> F.log_softmax(x, dim=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GCNConv, ChebConv  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> torch_geometric.data <span class="keyword">import</span> data <span class="keyword">as</span> D</span><br><span class="line"><span class="keyword">from</span> torch_geometric.data <span class="keyword">import</span> dataset</span><br><span class="line"></span><br><span class="line">x = torch.tensor([[<span class="number">1</span>],[<span class="number">2</span>],[<span class="number">3</span>],[<span class="number">4</span>],[<span class="number">5</span>],[<span class="number">6</span>],[<span class="number">7</span>],[<span class="number">8</span>],[<span class="number">9</span>],[<span class="number">10</span>]], dtype=torch.<span class="built_in">float</span>)   <span class="comment"># N x emb(in)</span></span><br><span class="line"><span class="built_in">print</span>(x.shape)</span><br><span class="line">x = torch.ones(<span class="number">10</span>,dtype=torch.<span class="built_in">float</span>).unsqueeze(-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(x.shape)</span></span><br><span class="line">y = torch.randint(<span class="number">0</span>,<span class="number">2</span>,[<span class="number">10</span>])</span><br><span class="line">train_mask = torch.tensor([<span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>], dtype=torch.<span class="built_in">bool</span>)</span><br><span class="line">val_mask=train_mask</span><br><span class="line">test_mask=train_mask</span><br><span class="line">data=D.Data()</span><br><span class="line">data.x,data.y,data.edge_index,data.edge_attr,data.train_mask,data.val_mask,data.test_mask \</span><br><span class="line">    = x,y,edge_index,edge_attr,train_mask,val_mask,test_mask</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([10, 1])
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">model, data = Net().to(device), data.to(device)</span><br><span class="line">optimizer = torch.optim.Adam([</span><br><span class="line">    <span class="built_in">dict</span>(params=model.conv1.parameters(), weight_decay=<span class="number">5e-4</span>),</span><br><span class="line">    <span class="built_in">dict</span>(params=model.conv2.parameters(), weight_decay=<span class="number">0</span>)</span><br><span class="line">], lr=<span class="number">0.01</span>)  <span class="comment"># Only perform weight-decay on first convolution.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>():</span><br><span class="line">    model.train()</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    F.nll_loss(model()[data.train_mask], data.y[data.train_mask]).backward()</span><br><span class="line">    <span class="comment">#F.nll_loss(model()[data], data.y).backward() #ä¸è¡Œï¼</span></span><br><span class="line">    optimizer.step()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@torch.no_grad()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    logits, accs = model(), []</span><br><span class="line">    <span class="keyword">for</span> _, mask <span class="keyword">in</span> data(<span class="string">&#x27;train_mask&#x27;</span>, <span class="string">&#x27;val_mask&#x27;</span>, <span class="string">&#x27;test_mask&#x27;</span>):</span><br><span class="line">        pred = logits[mask].<span class="built_in">max</span>(<span class="number">1</span>)[<span class="number">1</span>]</span><br><span class="line">        acc = pred.eq(data.y[mask]).<span class="built_in">sum</span>().item() / mask.<span class="built_in">sum</span>().item()</span><br><span class="line">        accs.append(acc)</span><br><span class="line">    <span class="keyword">return</span> accs</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">best_val_acc = test_acc = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    train()</span><br><span class="line">    train_acc, val_acc, tmp_test_acc = test()</span><br><span class="line">    <span class="keyword">if</span> val_acc &gt; best_val_acc:</span><br><span class="line">        best_val_acc = val_acc</span><br><span class="line">        test_acc = tmp_test_acc</span><br><span class="line">    log = <span class="string">&#x27;Epoch: &#123;:03d&#125;, Train: &#123;:.4f&#125;, Val: &#123;:.4f&#125;, Test: &#123;:.4f&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(log.<span class="built_in">format</span>(epoch, train_acc, best_val_acc, test_acc))</span><br></pre></td></tr></table></figure>
<pre><code>Epoch: 001, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 002, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 003, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 004, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 005, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 006, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 007, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 008, Train: 0.5000, Val: 0.5000, Test: 0.5000
Epoch: 009, Train: 0.5000, Val: 0.5000, Test: 0.5000
</code></pre><h1 id="æ‰¹é‡"><a href="#æ‰¹é‡" class="headerlink" title="æ‰¹é‡"></a>æ‰¹é‡</h1><h2 id="å•ç‹¬ä¼ å…¥ï¼Œstackç»“æœ"><a href="#å•ç‹¬ä¼ å…¥ï¼Œstackç»“æœ" class="headerlink" title="å•ç‹¬ä¼ å…¥ï¼Œstackç»“æœ"></a>å•ç‹¬ä¼ å…¥ï¼Œstackç»“æœ</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(torch.nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Net, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.layer = GATConv(in_channels=<span class="number">16</span>, out_channels=<span class="number">16</span>)</span><br><span class="line">        self.layer2 = GATConv(in_channels=<span class="number">16</span>, out_channels=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x,edg_index</span>):</span><br><span class="line">        output = torch.stack([self.layer(graph, edge_index=edge_indexi) <span class="keyword">for</span> graph,edge_indexi <span class="keyword">in</span> <span class="built_in">zip</span>(x,edg_index)], dim=<span class="number">0</span>)</span><br><span class="line">        output = torch.stack([self.layer2(graph, edge_index=edge_indexi) <span class="keyword">for</span> graph,edge_indexi <span class="keyword">in</span> <span class="built_in">zip</span>(output,edg_index)], dim=<span class="number">0</span>)</span><br><span class="line">        <span class="comment">#output = torch.sigmoid(output)</span></span><br><span class="line">        <span class="comment">#print(output.shape)</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GATConv</span><br><span class="line">x = torch.randn((<span class="number">8</span>, <span class="number">207</span>, <span class="number">16</span>))</span><br><span class="line">y = torch.rand([<span class="number">8</span>,<span class="number">207</span>,<span class="number">1</span>]).<span class="built_in">float</span>()</span><br><span class="line">edge_index = torch.randint(high=<span class="number">206</span>, size=(<span class="number">2</span>, <span class="number">1200</span>))</span><br><span class="line"><span class="comment">#print(edge_index.shape)</span></span><br><span class="line"></span><br><span class="line">edge_index = edge_index.repeat(<span class="number">8</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(edge_index.shape)</span></span><br><span class="line">model = Net()</span><br><span class="line">optimizer = torch.optim.Adam(params=model.parameters(),lr=<span class="number">0.01</span>)  <span class="comment"># Only perform weight-decay on first convolution.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model.train()</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">s = time.time()</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    out = model(x,edge_index)</span><br><span class="line">    <span class="comment">#print(out.shape)</span></span><br><span class="line">    <span class="comment">#print(y.shape)</span></span><br><span class="line">    loss = F.mse_loss(out, y)</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(loss.item())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;time:&quot;</span>,time.time()-s)</span><br></pre></td></tr></table></figure>
<pre><code>0.7729121446609497
0.41821303963661194
0.384408563375473
time: 0.09303927421569824
</code></pre><h2 id="Batch-Data"><a href="#Batch-Data" class="headerlink" title="Batch+Data"></a>Batch+Data</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GATConv</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(torch.nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Net, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.layer = GATConv(in_channels=<span class="number">16</span>, out_channels=<span class="number">16</span>)</span><br><span class="line">        self.layer2 = GATConv(in_channels=<span class="number">16</span>,out_channels=<span class="number">1</span>)</span><br><span class="line">        self.dropout = nn.Dropout(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x,edge_index</span>):</span><br><span class="line"><span class="comment">#         print(&quot;input:&quot;,x.shape)</span></span><br><span class="line">        data_list = [Data(x=x_, edge_index=edge_indexi) <span class="keyword">for</span> x_ , edge_indexi <span class="keyword">in</span> <span class="built_in">zip</span>(x,edge_index)] </span><br><span class="line">        </span><br><span class="line">        batch = Batch.from_data_list(data_list)</span><br><span class="line">        output = self.layer(batch.x, edge_index=batch.edge_index)</span><br><span class="line"><span class="comment">#         print(&quot;output:&quot;,output.shape)</span></span><br><span class="line">        output = self.dropout(output)</span><br><span class="line">        data_list = [Data(x=x_, edge_index=edge_indexi) <span class="keyword">for</span> x_ , edge_indexi <span class="keyword">in</span> <span class="built_in">zip</span>(torch.split(output,x.shape[<span class="number">1</span>]),edge_index)] </span><br><span class="line">        batch = Batch.from_data_list(data_list)</span><br><span class="line">        output = self.layer2(batch.x,batch.edge_index)</span><br><span class="line">        output = self.dropout(output)</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.data <span class="keyword">import</span> Data,Batch</span><br><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GATConv</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">x = torch.randn((<span class="number">8</span>, <span class="number">207</span>, <span class="number">16</span>))</span><br><span class="line">y = torch.rand([<span class="number">8</span>,<span class="number">207</span>,<span class="number">1</span>]).<span class="built_in">float</span>()</span><br><span class="line"></span><br><span class="line">edge_index = torch.randint(high=<span class="number">206</span>, size=(<span class="number">2</span>, <span class="number">1200</span>))</span><br><span class="line"><span class="built_in">print</span>(edge_index.shape)</span><br><span class="line"></span><br><span class="line">edge_index = edge_index.repeat(<span class="number">8</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(edge_index.shape)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = Net()</span><br><span class="line">optimizer = torch.optim.Adam(params=model.parameters(),lr=<span class="number">0.01</span>)  <span class="comment"># Only perform weight-decay on first convolution.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model.train()</span><br><span class="line">s = time.time()</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    result = model(x,edge_index)</span><br><span class="line"><span class="comment">#     print(result.shape)</span></span><br><span class="line"><span class="comment">#     print(&quot;output of model&quot;,result.shape)</span></span><br><span class="line"><span class="comment">#     print(y.shape)</span></span><br><span class="line">    result = torch.stack(torch.split(result,x.shape[<span class="number">1</span>]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;reshape the output:&quot;</span>,result.shape)</span><br><span class="line">    loss = F.mse_loss(result, y)</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(loss.item())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;time:&quot;</span>,time.time()-s)</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([2, 1200])
torch.Size([8, 2, 1200])
reshape the output: torch.Size([8, 207, 1])
2.3954498767852783
reshape the output: torch.Size([8, 207, 1])
1.1830278635025024
reshape the output: torch.Size([8, 207, 1])
0.9167585372924805
time: 0.05799269676208496
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.data <span class="keyword">import</span> Data,Batch</span><br><span class="line"><span class="keyword">from</span> torch_geometric.nn <span class="keyword">import</span> GATConv</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line">x = torch.randn((<span class="number">8</span>, <span class="number">207</span>, <span class="number">16</span>))</span><br><span class="line">y = torch.rand([<span class="number">8</span>,<span class="number">207</span>,<span class="number">1</span>]).<span class="built_in">float</span>()</span><br><span class="line"></span><br><span class="line">edge_index = torch.randint(high=<span class="number">206</span>, size=(<span class="number">2</span>, <span class="number">1200</span>))</span><br><span class="line"><span class="built_in">print</span>(edge_index.shape)</span><br><span class="line"></span><br><span class="line">edge_index = edge_index.repeat(<span class="number">8</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(edge_index.shape)</span><br><span class="line"></span><br><span class="line">data_list = [Data(x=x_, edge_index=edge_indexi) <span class="keyword">for</span> x_ , edge_indexi <span class="keyword">in</span> <span class="built_in">zip</span>(x,edge_index)] </span><br><span class="line">batch = Batch.from_data_list(data_list)</span><br><span class="line">layer = GATConv(in_channels=<span class="number">16</span>, out_channels=<span class="number">2</span>)</span><br><span class="line">result = layer(batch.x, edge_index=batch.edge_index)</span><br><span class="line"><span class="built_in">print</span>(result.shape)</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([2, 1200])
torch.Size([8, 2, 1200])
torch.Size([1656, 2])
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = torch.rand([<span class="number">2</span>, <span class="number">2</span>, <span class="number">40000</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    <span class="built_in">print</span>(i.shape)</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([2, 40000])
torch.Size([2, 40000])
</code></pre><h1 id="æ‰¹é‡é‚»æ¥çŸ©é˜µè½¬æ¢"><a href="#æ‰¹é‡é‚»æ¥çŸ©é˜µè½¬æ¢" class="headerlink" title="æ‰¹é‡é‚»æ¥çŸ©é˜µè½¬æ¢"></a>æ‰¹é‡é‚»æ¥çŸ©é˜µè½¬æ¢</h1><h2 id="è½¬æ¢å®ç°"><a href="#è½¬æ¢å®ç°" class="headerlink" title="è½¬æ¢å®ç°"></a>è½¬æ¢å®ç°</h2><h3 id="è½¬æ¢å®Œstack"><a href="#è½¬æ¢å®Œstack" class="headerlink" title="è½¬æ¢å®Œstack"></a>è½¬æ¢å®Œstack</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">adj2coo</span>(<span class="params">self,Ab</span>):</span><br><span class="line">        <span class="keyword">import</span> scipy.sparse <span class="keyword">as</span> sp</span><br><span class="line">        <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">        adj = sp.coo_matrix(Ab)  <span class="comment"># è½¬æ¢æˆcoo_matrixçŸ©é˜µ</span></span><br><span class="line">        edge_attr = adj.data  <span class="comment"># è¾¹æƒå€¼</span></span><br><span class="line">        indices = np.vstack((adj.row, adj.col))  <span class="comment"># æˆ‘ä»¬éœ€è¦çš„cooå½¢å¼çš„edge_index</span></span><br><span class="line">        edge_index = torch.LongTensor(indices)  <span class="comment"># PyGéœ€è¦çš„edge_index</span></span><br><span class="line"></span><br><span class="line">        edge_attr = torch.FloatTensor(edge_attr)  <span class="comment"># to float tensor</span></span><br><span class="line">        <span class="built_in">print</span>(edge_index.shape,edge_attr.shape)</span><br><span class="line">        <span class="keyword">return</span> edge_index,edge_attr</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edg_indexH, edge_attrH = torch.stack([self.adj2coo(i)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> scoadj], dim=<span class="number">0</span>), torch.stack(</span><br><span class="line">            [self.adj2coo(i)[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> adj], dim=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€æ¬¡æ€§è§£å†³"><a href="#ä¸€æ¬¡æ€§è§£å†³" class="headerlink" title="ä¸€æ¬¡æ€§è§£å†³"></a>ä¸€æ¬¡æ€§è§£å†³</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">adj2edge_index</span>(<span class="params">self,A</span>):</span><br><span class="line">       <span class="keyword">import</span> scipy.sparse <span class="keyword">as</span> sp</span><br><span class="line">       <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">       edg_indexAll = torch.zeros(<span class="number">0</span>,dtype=torch.int64)</span><br><span class="line">       edg_attrAll = torch.zeros(<span class="number">0</span>,dtype=torch.float32)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span> b <span class="keyword">in</span> A:</span><br><span class="line">           adj = sp.coo_matrix(b)  <span class="comment"># è½¬æ¢æˆcoo_matrixçŸ©é˜µ</span></span><br><span class="line">           edge_attr = adj.data  <span class="comment"># è¾¹æƒå€¼</span></span><br><span class="line">           indices = np.vstack((adj.row, adj.col))  <span class="comment"># æˆ‘ä»¬éœ€è¦çš„cooå½¢å¼çš„edge_index</span></span><br><span class="line">           edge_index = torch.LongTensor(indices)  <span class="comment"># PyGéœ€è¦çš„edge_index</span></span><br><span class="line"></span><br><span class="line">           edge_attr = torch.FloatTensor(edge_attr)  <span class="comment"># to float tensor</span></span><br><span class="line">           edg_indexAll = torch.cat((edg_indexAll, edge_index))</span><br><span class="line">           edg_attrAll = torch.cat((edg_attrAll, edge_attr))</span><br><span class="line"></span><br><span class="line">       <span class="comment">#print(&quot;edg&quot;,edg_indexAll.view(A.shape[0],2,-1).shape)</span></span><br><span class="line">       <span class="comment">#print(edg_attrAll.view(A.shape[0],-1).shape)</span></span><br><span class="line">       <span class="keyword">return</span> edg_indexAll.view(A.shape[<span class="number">0</span>],<span class="number">2</span>,-<span class="number">1</span>),edg_attrAll.view(A.shape[<span class="number">0</span>],-<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="åº”ç”¨åˆ°æ¨¡å‹"><a href="#åº”ç”¨åˆ°æ¨¡å‹" class="headerlink" title="åº”ç”¨åˆ°æ¨¡å‹"></a>åº”ç”¨åˆ°æ¨¡å‹</h2><h3 id="æ¨¡å‹ä¸­ä¼ å‚"><a href="#æ¨¡å‹ä¸­ä¼ å‚" class="headerlink" title="æ¨¡å‹ä¸­ä¼ å‚"></a>æ¨¡å‹ä¸­ä¼ å‚</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x3 = self.relu(</span><br><span class="line">            torch.stack(</span><br><span class="line">                [self.gc6(graph, edge_index=self.adj2coo(edge)[<span class="number">0</span>], edge_attr=self.adj2coo(edge)[<span class="number">1</span>]) <span class="keyword">for</span> graph, edge <span class="keyword">in</span></span><br><span class="line">                 <span class="built_in">zip</span>(x3_h,A)],</span><br><span class="line">                dim=<span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<h3 id="Batch-Data-1"><a href="#Batch-Data-1" class="headerlink" title="Batch+Data"></a>Batch+Data</h3><p><strong>æ•ˆç‡æ›´é«˜ï¼Œå¦‚ä¸€ä¸ªepochå‰é¢æ˜¯280s,åé¢æ˜¯90s</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch_geometric.data <span class="keyword">import</span> Data,Batch</span><br><span class="line">data_list = [Data(x = x_,edge_ index=self.adj2coo(edge)[<span class="number">0</span>] ,edge_attr=self.adj2coo(edge)[<span class="number">1</span>]) <span class="keyword">for</span></span><br><span class="line">x_ ,edge <span class="keyword">in</span> <span class="built_in">zip</span>(x, A) ]</span><br><span class="line">batchH = Batch.from_data_list(data_listata_list)</span><br><span class="line">x1_h = self. relu(self. gc1(batchH.xï¼Œ edge_index=batchH. edge_indexedge_attr=batchH.edge_attr ))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å›¾ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>GNN</tag>
        <tag>PyG</tag>
      </tags>
  </entry>
  <entry>
    <title>Learning Multimodal Violence Detection under Weak Supervision</title>
    <url>/posts/undefined/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="Not-only-look-but-also-listen-Learning-multimodal-violence-detection-under-weak-supervision"><a href="#Not-only-look-but-also-listen-Learning-multimodal-violence-detection-under-weak-supervision" class="headerlink" title="Not only look, but also listen: Learning multimodal violence detection under weak supervision"></a>Not only look, but also listen: Learning multimodal violence detection under weak supervision</h1><p><a href="https://arxiv.org/pdf/2007.04687.pdf">paper</a> ï¼Œ<a href="https://roc-ng.github.io/XD-Violence/">code and dataset</a></p>
<p>æš´åŠ›è§†é¢‘æ£€æµ‹æ–¹å‘è®ºæ–‡</p>
<blockquote>
<p> ğŸ’¡ We introduce a HL-Net to simultaneously capture <strong>long-range relations</strong> and<br><strong>local distance relations</strong>, of which these two relations are based on similarity prior and proximity prior, respectively</p>
<p>ä¸‰ä¸ªå¹¶è¡Œçš„branchæ•æ‰è§†é¢‘ç‰‡æ®µå’Œé›†æˆçš„ç‰¹å¾ä¹‹é—´çš„ä¸åŒè”ç³»:</p>
<ul>
<li>holistic branch captures long-range dependencies using similarity prior,</li>
<li>localized branch captures local positional relation using proximity prior,</li>
<li>score branch dynamically captures the closeness of predicted score.</li>
</ul>
</blockquote>
<span id="more"></span>
<p>ç›¸å…³å·¥ä½œï¼Œå…¶ä¸­attentionéƒ¨åˆ†å¯ä»¥åé¢çœ‹ä¸‹ï¼›</p>
<p>ä¸€äº›å·¥ä½œå°†å›¾ç¥ç»ç½‘ç»œ(GCNs)[20,39]åœ¨å›¾ä¸Šå»ºç«‹ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»æ¨¡å‹ï¼Œå¹¶å­¦ä¹ è®¡ç®—æœºè§†è§‰çš„å¼ºå¤§è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼ŒGCNè¢«ç”¨äºæ—¶é—´æ€§åŠ¨ä½œå®šä½[50]ã€è§†é¢‘åˆ†ç±»[37,41]ã€å¼‚å¸¸æ£€æµ‹[51]ã€‚åŸºäºéª¨æ¶çš„åŠ¨ä½œè¯†åˆ«[33,45]ï¼Œç‚¹äº‘è¯­ä¹‰åˆ†å‰²[21]ï¼Œå›¾åƒè¯´æ˜[46]ç­‰ç­‰ã€‚é™¤äº†GCNï¼Œæ—¶é—´å…³ç³»ç½‘ç»œ[52]ï¼Œæ—¨åœ¨å­¦ä¹ å’Œæ¨ç†è§†é¢‘å¸§ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œè¢«æå‡ºæ¥ç”¨äºè§£å†³è§†é¢‘åˆ†ç±»ã€‚æœ€è¿‘ï¼Œè‡ªæˆ‘æ³¨æ„ç½‘ç»œ[40,47,5,18]å·²è¢«æˆåŠŸåº”ç”¨äºè§†è§‰é—®é¢˜ã€‚æ³¨æ„åŠ›æ“ä½œå¯ä»¥é€šè¿‡èšåˆä¸€ç»„å…ƒç´ çš„ä¿¡æ¯æ¥å½±å“å•ä¸ªå…ƒç´ ï¼Œå…¶ä¸­èšåˆçš„æƒé‡æ˜¯è‡ªåŠ¨å­¦ä¹ çš„ã€‚</p>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><h2 id="æ€»ä½“æ¡†æ¶å›¾"><a href="#æ€»ä½“æ¡†æ¶å›¾" class="headerlink" title="æ€»ä½“æ¡†æ¶å›¾"></a>æ€»ä½“æ¡†æ¶å›¾</h2><p><img src="/posts/undefined/Untitled.png" alt></p>
<ul>
<li><p>ç‰¹å¾æå–ï¼šusing the sliding window mechanism æå– è§†é¢‘ç‰¹å¾å’Œå£°éŸ³ç‰¹å¾ï¼Œåˆå¹¶æˆèåˆç‰¹å¾ï¼ˆèåˆéƒ¨åˆ†ä¸äºˆå…³æ³¨ã€‚æ»‘åŠ¨çª—å£æœºåˆ¶å¾…çœ‹ï¼‰</p>
<blockquote>
<p>Visual features: utilize two mainstream networks-C3D and I3D networks. we extract fc6 features from C3D that is pretrained on the Sports-1M dataset, and extract global_pool features from I3D pre-trained on Kinetics-200 dataset.</p>
</blockquote>
</li>
</ul>
<h2 id="Holistic-and-Localized-Networks"><a href="#Holistic-and-Localized-Networks" class="headerlink" title="Holistic and Localized Networks"></a>Holistic and Localized Networks</h2><h3 id="Holistic-ç‰¹å¾ç›¸ä¼¼æ€§"><a href="#Holistic-ç‰¹å¾ç›¸ä¼¼æ€§" class="headerlink" title="Holistic - ç‰¹å¾ç›¸ä¼¼æ€§"></a><strong>Holistic - ç‰¹å¾ç›¸ä¼¼æ€§</strong></h3><hr>
<p>é€šç”¨çš„å›¾å·ç§¯è¡¨ç¤ºå¯ä»¥çœ‹ä¸ºï¼š</p>
<script type="math/tex; mode=display">
X_l+1 = Update(Aggregate(X_l,W_l^{agg},W_l^{update}))</script><ul>
<li><strong>GCNèŒƒå¼ï¼š</strong><script type="math/tex; mode=display">
X^H_{l+1} = Dropout(ReLU(A^HX^H_lW^H_l))</script></li>
</ul>
<p>æ³¨ï¼š$X^H_0 = X^S_0 = X^L_0 = X^F$</p>
<p><strong>ç‰¹å¾ç›¸ä¼¼æ€§çš„é‚»æ¥çŸ©é˜µè¡¨ç¤º:</strong></p>
<script type="math/tex; mode=display">
A^H_{ij} = g(f(x_i,x_j))</script><p>$A^H_{ij}$è¡¡é‡ç¬¬iä¸ªå’Œç¬¬jä¸ªç‰¹å¾çš„ç‰¹å¾ç›¸ä¼¼æ€§ï¼›gæ˜¯å½’ä¸€åŒ–å‡½æ•°ï¼Œfå‡½æ•°è®¡ç®—ä¸€å¯¹ç‰¹å¾çš„ç›¸ä¼¼æ€§ï¼›é™„å½•éƒ¨åˆ†è¿˜è®¨è®ºäº†ä¸€ä¸‹å…¶ä»–ç‰ˆæœ¬çš„ã€‚æœ¬æ–‡å®šä¹‰å¦‚ä¸‹</p>
<ul>
<li>f å®šä¹‰ä¸ºï¼š</li>
</ul>
<script type="math/tex; mode=display">
f(x_i,x_j) = \frac{x_i^Tx_j}{||x_i||_{2} \\ . \\ ||x_j||_2}</script><ul>
<li>thresholdingæ“ä½œï¼ˆ$\tau$æ˜¯threshodï¼Œfå°†ç›¸ä¼¼æ€§é™åˆ¶åœ¨ï¼ˆ0,1]ä¹‹é—´ï¼‰ï¼š</li>
</ul>
<script type="math/tex; mode=display">
f(x_i,x_j) = \begin{cases} f(x_i,x_j)  & f(x_i,x_j) > \tau \\ 0 & f(x_i,x_j)\leq \tau\end{cases}</script><ul>
<li><p>ä½¿ç”¨softmaxä½œä¸ºå½’ä¸€åŒ–å‡½æ•°gï¼Œä½¿å¾—Açš„æ¯ä¸€è¡Œçš„å’Œéƒ½ä¸º1ã€‚</p>
<script type="math/tex; mode=display">
A^H_{ij} = \frac{exp(A^H_{ij})}{\sum ^{T'}_{k=1} exp(A^H_{ij})}</script></li>
</ul>
<h3 id="localized-branch-proximity-prior-å’Œæ—¶é—´ä¸€è‡´æ€§ç±»ä¼¼ï¼‰"><a href="#localized-branch-proximity-prior-å’Œæ—¶é—´ä¸€è‡´æ€§ç±»ä¼¼ï¼‰" class="headerlink" title="localized branch -proximity prior (å’Œæ—¶é—´ä¸€è‡´æ€§ç±»ä¼¼ï¼‰"></a><strong>localized branch -proximity prior (å’Œæ—¶é—´ä¸€è‡´æ€§ç±»ä¼¼ï¼‰</strong></h3><hr>
<script type="math/tex; mode=display">
A^L_{ij} = exp(\frac{-|i-j|^r}{\sigma })</script><h2 id="Online-detection-amp-score-branch"><a href="#Online-detection-amp-score-branch" class="headerlink" title="Online detection &amp; score branch"></a>Online detection &amp; score branch</h2><p>æ­£å¦‚æˆ‘ä»¬æåˆ°çš„ï¼Œæš´åŠ›æ£€æµ‹ç³»ç»Ÿä¸ä»…é€‚ç”¨äºç¦»çº¿æ£€æµ‹ï¼ˆäº’è”ç½‘å½•åƒæœºï¼‰ï¼Œä¹Ÿé€‚ç”¨äºåœ¨çº¿æ£€æµ‹ï¼ˆç›‘æ§ç³»ç»Ÿï¼‰ã€‚ç„¶è€Œï¼Œ<strong>ä¸Šè¿°HL-Net</strong>çš„åœ¨çº¿æ£€æµ‹å—åˆ°äº†ä¸€ä¸ªä¸»è¦éšœç¢çš„é˜»ç¢ï¼š<strong>HL-Netéœ€è¦æ•´ä¸ªè§†é¢‘æ¥è·å¾—é•¿è·ç¦»çš„ä¾èµ–å…³ç³»</strong>ã€‚ä¸ºäº†è·³å‡ºè¿™ä¸ªå›°å¢ƒï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªHLCè¿‘ä¼¼å™¨ï¼ŒåªæŠŠä»¥å‰çš„è§†é¢‘ç‰‡æ®µä½œä¸ºè¾“å…¥ï¼Œåœ¨HL-Netçš„æŒ‡å¯¼ä¸‹äº§ç”Ÿç²¾ç¡®çš„é¢„æµ‹ã€‚ä¸¤ä¸ªå †å çš„FCå±‚å’ŒReLUä»¥åŠä¸€ä¸ªä¸€ç»´å› æœå·ç§¯å±‚æ„æˆäº†HLCè¿‘ä¼¼å™¨ã€‚ä¸€ç»´å› æœå·ç§¯å±‚çš„æ ¸å¤§å°ä¸º5ï¼Œè·¨åº¦ä¸º1ï¼Œåœ¨æ—¶é—´ä¸Šæ»‘åŠ¨å·ç§¯æ»¤æ³¢å™¨ã€‚ä¸€ç»´å› æœå·ç§¯å±‚ä¹Ÿå……å½“åˆ†ç±»å™¨ï¼Œå…¶è¾“å‡ºæ˜¯å½¢çŠ¶ä¸º Tâ€™ çš„æš´åŠ›æ¿€æ´»è¡¨ç¤ºä¸º$C^S$ã€‚æ›´å¦™çš„æ˜¯ï¼Œè¿™ä¸ªæ“ä½œå¼•å…¥äº†ä¸€ä¸ªé¢å¤–çš„åˆ†æ”¯ï¼Œåä¸º<strong>åŠ¨æ€å¾—åˆ†åˆ†æ”¯(dynamic score branch)</strong>ï¼Œä»¥æ‰©å±•HL-Netï¼Œå®ƒå–å†³äº$C^S$ã€‚</p>
<h3 id="score-branch"><a href="#score-branch" class="headerlink" title="score branch"></a>score branch</h3><p>ç”¨äºonline detection, è§£å†³éœ€è¦å°†æ•´ä¸ªè§†é¢‘ä½œä¸ºè¾“å…¥ï¼ˆä»¥è·å¾—é•¿è·ç¦»ä¾èµ–ï¼‰çš„é—®é¢˜ã€‚</p>
<p>è¯¥åˆ†æ”¯çš„ä¸»è¦ä½œç”¨æ˜¯å°†ä¸€ä¸ªä½ç½®çš„å“åº”è®¡ç®—ä¸ºæ‰€æœ‰ä½ç½®ç‰¹å¾çš„åŠ æƒå’Œï¼Œå…¶ä¸­æƒé‡å–å†³äºåˆ†æ•°çš„æ¥è¿‘ç¨‹åº¦ã€‚ä¸æ•´ä½“å’Œå±€éƒ¨åˆ†æ”¯çš„å…³ç³»çŸ©é˜µä¸åŒï¼Œåˆ†æ•°åˆ†æ”¯çš„å…³ç³»çŸ©é˜µåœ¨æ¯æ¬¡è¿­ä»£ä¸­éƒ½ä¼šæ›´æ–°ï¼Œå¹¶ä¸”å–å†³äºé¢„æµ‹çš„åˆ†æ•°è€Œä¸æ˜¯å…ˆéªŒã€‚ä»å½¢å¼ä¸Šçœ‹ï¼Œåˆ†æ•°åˆ†æ”¯çš„å…³ç³»çŸ©é˜µè®¾è®¡å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
A^S_{ij} = \rho(1 - |s(C^S_i) - s(C^S_j)|)</script><p>sæ˜¯ sigmoid, å‡½æ•°Ïç”¨äºåŠ å¼ºï¼ˆå’Œå‰Šå¼±ï¼‰å¾—åˆ†æ¥è¿‘åº¦å¤§äºï¼ˆå’Œå°äºï¼‰0.5çš„é…å¯¹å…³ç³»ï¼Œsoftmaxä¹Ÿç”¨äºå½’ä¸€åŒ–ã€‚</p>
<script type="math/tex; mode=display">
\rho (x) = \frac{1}{1+exp(-\frac{x-0.5}{0.1})}</script><h2 id="training-based-on-MIL"><a href="#training-based-on-MIL" class="headerlink" title="training based on MIL"></a>training based on MIL</h2><script type="math/tex; mode=display">
C^P = (X^H||X^L||X^S)W</script><p>æ‰€æœ‰è¾“å‡º($C^P å’Œ C^S$)åœ¨æ—¶é—´ç»´åº¦ä¸Šçš„K-maxå–å¹³å‡ä½œä¸ºè¾“å‡ºï¼Œä»¥å¾—åˆ°$y^P$ å’Œ$y^S$ã€‚Kå®šä¹‰ä¸ºTâ€˜ é™¤ä»¥qåŠ ä¸€åå‘ä¸‹å–æ•´ã€‚</p>
<p>è¡¥å……ï¼š top-kç­–ç•¥ï¼ˆWeakly-supervised video anomaly detection with robust temporal feature magnitude learningï¼‰</p>
<ul>
<li>lossç»“åˆä¸‰ä¸ªbranch</li>
</ul>
<blockquote>
<p>The instances corresponding to the K-max activation in the positive bag is most likely to be true positive instances (violence). The instances corresponding to the K-max activation in the negative bag is hard instances. We expect these two types of instances to be as far as possible.</p>
</blockquote>
<p>L_BCEï¼ˆbinary crossentropy) å’ŒL_BCE2åˆ†åˆ«å¯¹åº”ä¸º$y^p å’Œ y^s$ ä¸ ground truth yä¹‹é—´çš„lossã€‚L_DISTILLä¸ºçŸ¥è¯†è’¸é¦æŸå¤±ã€‚</p>
<script type="math/tex; mode=display">
L_{TOTAL}  = L_{BCE} + L_{BCE2} +\lambda L_{DISTILL}</script><script type="math/tex; mode=display">
L_{DISTILL} = \sum \limits^N_{j=1} (- \sum \limits_i s(C^P_i) log (s(C_i^S)))</script><h2 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h2><p>æ–¹æ³•æ”¯æŒçº¿ä¸Šå’Œç¦»çº¿çš„æ£€æµ‹ã€‚sigmoidå‡½æ•°ä½œä¸º$C^P$å’Œ$C^S$çš„æ¿€æ´»å‡½æ•°ï¼Œå¹¶æœ€åç”Ÿæˆåœ¨[0,1]ä¹‹é—´çš„æš´åŠ›ç½®ä¿¡å¾—åˆ†ã€‚æ³¨ï¼šåœ¨çº¿ä¸Šé¢„æµ‹ä¸­ï¼Œåªæœ‰HLCè¿‘ä¼¼å™¨å·¥ä½œï¼ŒHL-NETå¯ä»¥ç§»é™¤ã€‚</p>
<h1 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h1><h2 id="è¯„ä¼°æ ‡å‡†"><a href="#è¯„ä¼°æ ‡å‡†" class="headerlink" title="è¯„ä¼°æ ‡å‡†"></a>è¯„ä¼°æ ‡å‡†</h2><p>we utilize the frame-level <strong>precision-recall curve</strong> (PRC) and corresponding area under the curve <strong>(average precision, AP)</strong> [30] rather than receiver operating characteristic curve (ROC) and corresponding area under the curve (AUC) [44,43]<br><strong>since AUC usually shows an optimistic result when dealing with class-imbalanced data, and PRC and AP focus on positive samples (violence)</strong></p>
<ul>
<li>Precision and Recall (PRæ›²çº¿)ï¼šç”¨äºç¨€æœ‰äº‹ä»¶æ£€æµ‹ï¼Œå¦‚ç›®æ ‡æ£€æµ‹ã€ä¿¡æ¯æ£€ç´¢ã€æ¨èç³»ç»Ÿã€‚è´Ÿæ ·æœ¬å¾ˆå¤šçš„æ—¶å€™ï¼Œ??? = FPâ„(FP+TNï¼‰å¾ˆå°ï¼Œæ¯”è¾ƒTPRå’ŒFPRæ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼ˆROCï¼‰</li>
</ul>
<h2 id="æ€§èƒ½è¡¨ç°"><a href="#æ€§èƒ½è¡¨ç°" class="headerlink" title="æ€§èƒ½è¡¨ç°"></a>æ€§èƒ½è¡¨ç°</h2><p><img src="/posts/undefined/Untitled 1.png" alt></p>
<p>ä¼˜äºå½“å‰æœ€å…ˆè¿›çš„æ–¹æ³•ï¼ˆ20å¹´çš„æ–‡ç« ï¼‰</p>
<p>æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œåœ¨æˆ‘ä»¬çš„æš´åŠ›æ£€æµ‹ä»»åŠ¡ä¸­ï¼ŒC3Dæ¯”I3Då·®äº†å¾ˆå¤§ä¸€æˆªã€‚</p>
<h2 id="æ¶ˆèå®éªŒ"><a href="#æ¶ˆèå®éªŒ" class="headerlink" title="æ¶ˆèå®éªŒ"></a>æ¶ˆèå®éªŒ</h2><ul>
<li>äº”ç§æ¨¡æ€APå¯¹æ¯”</li>
</ul>
<p><img src="/posts/undefined/Untitled 2.png" alt="Untitled"></p>
<p>ï¼ˆè¯¥æ–‡è¯æ˜å£°éŸ³å’Œè§†è§‰çš„èåˆæ£€æµ‹æ•ˆæœæ›´å¥½ï¼Œä¸”è§†è§‰æ¨¡æ€çš„ä½œç”¨ä¼˜äºå£°éŸ³ï¼‰</p>
<ul>
<li><p>ä¸‰ä¸ªåˆ†æ”¯çš„å¯¹æ¯”ï¼ˆholistic, localized and score branchesï¼‰</p>
<ul>
<li>ä¸‰ä¸ªåˆ†æ”¯å•ç‹¬çš„æƒ…å†µè¡¨ç°ç›¸ä¼¼</li>
<li>ç§»é™¤ä»»ä½•ä¸€ä¸ªåˆ†æ”¯éƒ½ä¼šä½¿å¾—è¡¨ç°å˜å·®</li>
<li>HL-NETåœ¨è¿™ä¸‰ä¸ªåˆ†æ”¯ä¸€èµ·ä½œç”¨çš„æ—¶å€™è¡¨ç°æœ€å¥½ï¼Œå› æ­¤è¯æ˜ä¸‰ä¸ªåˆ†æ”¯éƒ½ä¸å¯æ›¿ä»£ã€‚</li>
</ul>
<p><img src="/posts/undefined/Untitled 3.png" alt></p>
</li>
<li><p>online vs offline</p>
<p><img src="/posts/undefined/Untitled 4.png" alt></p>
</li>
</ul>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h3 id="å…‰æµ"><a href="#å…‰æµ" class="headerlink" title="å…‰æµ"></a>å…‰æµ</h3><blockquote>
<p>å…‰æµï¼ˆoptical flowï¼‰æ˜¯ç©ºé—´è¿åŠ¨ç‰©ä½“åœ¨è§‚å¯Ÿæˆåƒå¹³é¢ä¸Šçš„åƒç´ è¿åŠ¨çš„ç¬æ—¶é€Ÿåº¦ã€‚<br>å…‰æµæ³•æ˜¯åˆ©ç”¨å›¾åƒåºåˆ—ä¸­åƒç´ åœ¨æ—¶é—´åŸŸä¸Šçš„å˜åŒ–ä»¥åŠç›¸é‚»å¸§ä¹‹é—´çš„ç›¸å…³æ€§æ¥æ‰¾åˆ°ä¸Šä¸€å¸§è·Ÿå½“å‰å¸§ä¹‹é—´å­˜åœ¨çš„å¯¹åº”å…³ç³»ï¼Œä»è€Œè®¡ç®—å‡ºç›¸é‚»å¸§ä¹‹é—´ç‰©ä½“çš„è¿åŠ¨ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ã€‚<br>é€šå¸¸å°†äºŒç»´å›¾åƒå¹³é¢ç‰¹å®šåæ ‡ç‚¹ä¸Šçš„ç°åº¦ç¬æ—¶å˜åŒ–ç‡å®šä¹‰ä¸ºå…‰æµçŸ¢é‡ã€‚</p>
</blockquote>
<p>ä½œè€…åœ¨ã€ŠOn the Integration of Optical Flow and Action Recognitionã€‹è¿™ç¯‡æ–‡ç« [1]ä¸­æ·±å…¥è®¨è®ºäº†å…‰æµä¸è¡Œä¸ºè¯†åˆ«çš„ç»“åˆï¼Œå¹¶é€šè¿‡å®éªŒè§‚å¯Ÿåˆ°å¦‚ä¸‹ç»“è®ºï¼š<br>ï¼ˆ1ï¼‰å…‰æµå¯¹äºè¡Œä¸ºè¯†åˆ«æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒçš„å¤–è§‚ä¸å˜æ€§ï¼›<br>ï¼ˆ2ï¼‰å…‰æµæ³•é‡‡ç”¨æœ€å°åŒ–ç«¯ç‚¹è¯¯å·®ï¼ˆEPEï¼Œend-point-errorï¼‰æ¥ä¼˜åŒ–ï¼Œä½†æ˜¯å½“å‰EPEæ–¹æ³•ä¸åŠ¨ä½œè¯†åˆ«æ€§èƒ½æ²¡æœ‰å¾ˆå¥½çš„ç›¸å…³æ€§ï¼›<br>ï¼ˆ3ï¼‰å¯¹äºæµ‹è¯•è¿‡çš„å…‰æµæ–¹æ³•ï¼Œåœ¨è¾¹ç•Œä¸Šå’Œå°ä½ç§»ä¸Šçš„ç²¾åº¦ä¸åŠ¨ä½œè¯†åˆ«æ€§èƒ½æœ€ç›¸å…³ï¼›<br>ï¼ˆ4ï¼‰é‡‡ç”¨æœ€å°åŒ–åˆ†ç±»è¯¯å·®ï¼ˆè€ŒéEPEï¼‰æ¥è®­ç»ƒå…‰æµå¯ä»¥æé«˜è¯†åˆ«æ€§èƒ½ï¼›<br>ï¼ˆ5ï¼‰ç”¨äºè¡Œä¸ºè¯†åˆ«ä»»åŠ¡çš„å…‰æµä¸åŒäºä¼ ç»Ÿçš„å…‰æµï¼Œç‰¹åˆ«æ˜¯åœ¨äººä½“å†…éƒ¨å’Œèº«ä½“è¾¹ç•Œå¤„ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/zhang_can/article/details/80259946">https://blog.csdn.net/zhang_can/article/details/80259946</a></p>
]]></content>
      <categories>
        <category>è®ºæ–‡é˜…è¯»</category>
      </categories>
      <tags>
        <tag>å¼±ç›‘ç£å­¦ä¹ </tag>
        <tag>æš´åŠ›è§†é¢‘æ£€æµ‹</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€æ¬¡æ­å»ºhexoåšå®¢</title>
    <url>/posts/83682157/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="hexo-deploy-åˆ°githubå¤±è´¥"><a href="#hexo-deploy-åˆ°githubå¤±è´¥" class="headerlink" title="hexo deploy åˆ°githubå¤±è´¥"></a>hexo deploy åˆ°githubå¤±è´¥</h2><p>ä½¿ç”¨deployä¹‹åè¦æ±‚è¾“å…¥è´¦æˆ·å’Œå¯†ç ï¼Œå¯†ç æ­£ç¡®ä½†æ˜¯æ˜¾ç¤ºéªŒè¯å¤±è´¥ã€‚</p>
<span id="more"></span>
<ul>
<li><p>å¤±è´¥åŸå› ï¼š</p>
<p>github 21å¹´å–æ¶ˆäº†å¯†ç éªŒè¯</p>
<p><img src="/posts/83682157/image-20221117162546351.png" alt></p>
</li>
</ul>
<ul>
<li><p>è§£å†³æ–¹å¼</p>
<p>åœ¨_config.ymlçš„deployä¸­ï¼Œrepoå¯¹åº”çš„å¡«å†™ä¸ºgithubä»“åº“çš„sshåœ°å€ï¼Œå¯ä»¥é¿å…è¿›è¡Œå¯†ç éªŒè¯ï¼ˆå‰æï¼šgité…ç½®å®Œæˆï¼Œgithubä¸Šæœ‰è®¾ç½®å…¬é’¥ï¼‰</p>
</li>
</ul>
<h2 id="å®Œæˆçš„é…ç½®"><a href="#å®Œæˆçš„é…ç½®" class="headerlink" title="å®Œæˆçš„é…ç½®"></a>å®Œæˆçš„é…ç½®</h2><ul>
<li><p>ä½¿ç”¨hexoä¸»é¢˜</p>
<p><a href="https://github.com/probberechts/hexo-theme-cactus">hexo-theme-cactus</a></p>
<ul>
<li><a href="https://github.com/theme-next/hexo-theme-next">theme-next/hexo-theme-next: Elegant and powerful theme for Hexo. (github.com)</a></li>
</ul>
</li>
<li><p>ä¸»é¢˜é…ç½® tags å’Œ categories</p>
</li>
<li><p>é…ç½®baidu_analytics</p>
</li>
<li><p>comment</p>
<ul>
<li>ä½¿ç”¨utterancesè®¾ç½®comment</li>
<li>æ¥å¿…åŠ›</li>
</ul>
</li>
<li><p>ä¸è’œå­ç»Ÿè®¡</p>
</li>
<li><p>ä½¿ç”¨ä¸»é¢˜çš„search</p>
<ul>
<li>ä¸æˆåŠŸ-&gt;è§£å†³ï¼šå‘ç°æ˜¯npm installçš„æ—¶å€™æ²¡æœ‰åœ¨åšå®¢æ ¹ç›®å½•å¯¼è‡´çš„é—®é¢˜</li>
</ul>
</li>
<li><p>è§£å†³å›¾ç‰‡è·¯å¾„é—®é¢˜</p>
<ul>
<li><p>sources/imagesç›®å½•ä¸‹å­˜å¼•å›¾ç‰‡</p>
</li>
<li><p>setupé‚£ç¯‡postä½¿ç”¨post_asset_folder: trueçš„æ–¹å¼ï¼ˆéœ€è¦å®‰è£…hexoæ’ä»¶ï¼‰ï¼Œå°†èµ„æºæ”¾åœ¨å¯¹åº”ç›®å½•ä¸‹</p>
<ul>
<li><p>æœ¬åœ°æˆåŠŸä½†æ˜¯æœåŠ¡å™¨æ˜¾ç¤ºæ— æ•ˆï¼Œé‡æ–°å®‰è£…æ’ä»¶æˆåŠŸï¼š</p>
<p><code>npm install https://github.com/7ym0n/hexo-asset-image --save</code></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>hexo new postå¤±è´¥</p>
<ul>
<li>ä½¿ç”¨ hexo new â€˜[post]â€™ â€œpostnameâ€</li>
</ul>
</li>
<li><p>æ•°å­¦å…¬å¼æ¸²æŸ“</p>
<ul>
<li><a href="https://blog.csdn.net/qq_38496329/article/details/104065659">https://blog.csdn.net/qq_38496329/article/details/104065659</a></li>
<li>æ³¨æ„åœ¨æ–‡ç« ä¸­front éƒ¨åˆ†è®¾ç½®mathjax: true</li>
</ul>
</li>
</ul>
<h3 id="éŸ³ä¹"><a href="#éŸ³ä¹" class="headerlink" title="éŸ³ä¹"></a>éŸ³ä¹</h3><ul>
<li><strong>è·å–ç½‘æ˜“äº‘å¤–é“¾çš„iframeä»£ç </strong></li>
</ul>
<p>æ‰“å¼€ç½‘æ˜“äº‘<a href="https://music.163.com/">å®˜ç½‘</a>ï¼Œé€‰æ‹©å–œæ¬¢çš„æ­Œå•æˆ–è€…æ­Œæ›²ï¼Œå¯ä»¥è‡ªå·±åˆ›å»ºæ­Œå•ã€‚</p>
<p>é™åˆ¶ï¼šæœ‰äº›æ­Œæ›²æœ‰ç‰ˆæƒä¿æŠ¤ï¼Œæ— æ³•ç”Ÿæˆå¤–é“¾</p>
<p><img src="/posts/83682157/image-20221125133318434.png" alt style="zoom:50%;"></p>
<p><img src="/posts/83682157/image-20221125133225148.png" alt style="zoom: 50%;"></p>
<p>[åšå®¢æ ¹ç›®å½•]\themes\next\layout_macro\sidebar.swigï¼Œåœ¨classä¸ºsiderbar-innerçš„divå†…æ·»åŠ iframe</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% macro render(display_toc) %&#125;</span><br><span class="line">  &lt;div class=&quot;toggle sidebar-toggle&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;toggle-line toggle-line-first&quot;&gt;&lt;/span&gt;</span><br><span class="line">    &lt;span class=&quot;toggle-line toggle-line-middle&quot;&gt;&lt;/span&gt;</span><br><span class="line">    &lt;span class=&quot;toggle-line toggle-line-last&quot;&gt;&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;aside class=&quot;sidebar&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;sidebar-inner&quot;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="å›¾æ ‡"><a href="#å›¾æ ‡" class="headerlink" title="å›¾æ ‡"></a>å›¾æ ‡</h3><p>ã€nextä¸»é¢˜ä¸‹ã€‘</p>
<ul>
<li>å…è´¹å›¾æ ‡ä¸‹è½½ç½‘ç«™ï¼š</li>
</ul>
<p><a href="https://icons8.com/">https://icons8.com/</a></p>
<p><a href="https://findicons.com/icon/558960/cursor">Cursor icon PNG, ICO or ICNS | Free vector icons (findicons.com)</a></p>
<ul>
<li>ç«™ç‚¹å›¾æ ‡</li>
</ul>
<p>nextä¸»é¢˜é»˜è®¤æ˜¯é»‘è‰²çš„N</p>
<p>ä¿®æ”¹ï¼š nextä¸»é¢˜çš„é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸€é¡¹é…ç½® faviconï¼Œå°†é…ç½®ä¸‹çš„å›¾ç‰‡ç›®å½•æ›´æ”¹ä¸ºæƒ³æ¢çš„å›¾ç‰‡å³å¯</p>
<ul>
<li><p>é¼ æ ‡çƒŸèŠ±ç‰¹æ•ˆ</p>
<p><a href="https://siriusq.top/Nextå‡çº§-Macè¿ç§».html#é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ">Next å‡çº§ + Mac è¿ç§» | Sirius (siriusq.top)</a></p>
</li>
</ul>
<p>â€‹                æ³¨æ„å°†ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å°†body-end.swigå¯¹åº”çš„éƒ¨åˆ†ç§»é™¤æ³¨é‡Š</p>
<ul>
<li><p>é¼ æ ‡æ ·å¼ä¿®æ”¹</p>
<p>hexo\source_data\styles.stylä¸­æ·»åŠ </p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// é¼ æ ‡æ ·å¼</span><br><span class="line">  * &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&quot;image url&quot;</span>),auto<span class="meta">!important</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&quot;image url&quot;</span>),auto<span class="meta">!important</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­custom_file_path: style: source/_data/styles.stylç§»é™¤æ³¨é‡Š</p>
</li>
</ul>
]]></content>
      <categories>
        <category>hexoé…ç½®</category>
      </categories>
  </entry>
  <entry>
    <title>hexo Hello World</title>
    <url>/posts/1e44dbaf/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>hexoé…ç½®</category>
      </categories>
  </entry>
</search>
